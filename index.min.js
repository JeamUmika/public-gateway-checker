(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.IpfsPublicGatewayChecker = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var IpfsPublicGatewayChecker=(()=>{var Or=Object.create;var Pi=Object.defineProperty;var xr=Object.getOwnPropertyDescriptor;var Tr=Object.getOwnPropertyNames;var Nr=Object.getPrototypeOf,Dr=Object.prototype.hasOwnProperty;var Br=(e,t,n)=>t in e?Pi(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var In=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Lr=(e,t,n,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of Tr(t))!Dr.call(e,r)&&r!==n&&Pi(e,r,{get:()=>t[r],enumerable:!(a=xr(t,r))||a.enumerable});return e};var ri=(e,t,n)=>(n=e!=null?Or(Nr(e)):{},Lr(t||!e||!e.__esModule?Pi(n,"default",{value:e,enumerable:!0}):n,e));var Mi=(e,t,n)=>(Br(e,typeof t!="symbol"?t+"":t,n),n);var si=In((Wt,zi)=>{(function(e){"use strict";function t(n){var a=n&&n.Promise||e.Promise,r=n&&n.XMLHttpRequest||e.XMLHttpRequest;return function(){var p=Object.create(e,{fetch:{value:void 0,writable:!0}});return function(v,c){typeof Wt=="object"&&typeof zi<"u"?c(Wt):typeof define=="function"&&define.amd?define(["exports"],c):c(v.WHATWGFetch={})}(this,function(v){"use strict";var c=typeof p<"u"&&p||typeof self<"u"&&self||typeof c<"u"&&c,b={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};function D(d){return d&&DataView.prototype.isPrototypeOf(d)}if(b.arrayBuffer)var w=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],N=ArrayBuffer.isView||function(d){return d&&w.indexOf(Object.prototype.toString.call(d))>-1};function L(d){if(typeof d!="string"&&(d=String(d)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(d)||d==="")throw new TypeError("Invalid character in header field name");return d.toLowerCase()}function F(d){return typeof d!="string"&&(d=String(d)),d}function S(d){var E={next:function(){var z=d.shift();return{done:z===void 0,value:z}}};return b.iterable&&(E[Symbol.iterator]=function(){return E}),E}function A(d){this.map={},d instanceof A?d.forEach(function(E,z){this.append(z,E)},this):Array.isArray(d)?d.forEach(function(E){this.append(E[0],E[1])},this):d&&Object.getOwnPropertyNames(d).forEach(function(E){this.append(E,d[E])},this)}A.prototype.append=function(d,E){d=L(d),E=F(E);var z=this.map[d];this.map[d]=z?z+", "+E:E},A.prototype.delete=function(d){delete this.map[L(d)]},A.prototype.get=function(d){return d=L(d),this.has(d)?this.map[d]:null},A.prototype.has=function(d){return this.map.hasOwnProperty(L(d))},A.prototype.set=function(d,E){this.map[L(d)]=F(E)},A.prototype.forEach=function(d,E){for(var z in this.map)this.map.hasOwnProperty(z)&&d.call(E,this.map[z],z,this)},A.prototype.keys=function(){var d=[];return this.forEach(function(E,z){d.push(z)}),S(d)},A.prototype.values=function(){var d=[];return this.forEach(function(E){d.push(E)}),S(d)},A.prototype.entries=function(){var d=[];return this.forEach(function(E,z){d.push([z,E])}),S(d)},b.iterable&&(A.prototype[Symbol.iterator]=A.prototype.entries);function G(d){if(d.bodyUsed)return a.reject(new TypeError("Already read"));d.bodyUsed=!0}function W(d){return new a(function(E,z){d.onload=function(){E(d.result)},d.onerror=function(){z(d.error)}})}function B(d){var E=new FileReader,z=W(E);return E.readAsArrayBuffer(d),z}function Q(d){var E=new FileReader,z=W(E);return E.readAsText(d),z}function $(d){for(var E=new Uint8Array(d),z=new Array(E.length),Z=0;Z<E.length;Z++)z[Z]=String.fromCharCode(E[Z]);return z.join("")}function ne(d){if(d.slice)return d.slice(0);var E=new Uint8Array(d.byteLength);return E.set(new Uint8Array(d)),E.buffer}function re(){return this.bodyUsed=!1,this._initBody=function(d){this.bodyUsed=this.bodyUsed,this._bodyInit=d,d?typeof d=="string"?this._bodyText=d:b.blob&&Blob.prototype.isPrototypeOf(d)?this._bodyBlob=d:b.formData&&FormData.prototype.isPrototypeOf(d)?this._bodyFormData=d:b.searchParams&&URLSearchParams.prototype.isPrototypeOf(d)?this._bodyText=d.toString():b.arrayBuffer&&b.blob&&D(d)?(this._bodyArrayBuffer=ne(d.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):b.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(d)||N(d))?this._bodyArrayBuffer=ne(d):this._bodyText=d=Object.prototype.toString.call(d):this._bodyText="",this.headers.get("content-type")||(typeof d=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):b.searchParams&&URLSearchParams.prototype.isPrototypeOf(d)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},b.blob&&(this.blob=function(){var d=G(this);if(d)return d;if(this._bodyBlob)return a.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return a.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return a.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var d=G(this);return d||(ArrayBuffer.isView(this._bodyArrayBuffer)?a.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):a.resolve(this._bodyArrayBuffer))}else return this.blob().then(B)}),this.text=function(){var d=G(this);if(d)return d;if(this._bodyBlob)return Q(this._bodyBlob);if(this._bodyArrayBuffer)return a.resolve($(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return a.resolve(this._bodyText)},b.formData&&(this.formData=function(){return this.text().then(Ge)}),this.json=function(){return this.text().then(JSON.parse)},this}var Re=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function x(d){var E=d.toUpperCase();return Re.indexOf(E)>-1?E:d}function q(d,E){if(!(this instanceof q))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');E=E||{};var z=E.body;if(d instanceof q){if(d.bodyUsed)throw new TypeError("Already read");this.url=d.url,this.credentials=d.credentials,E.headers||(this.headers=new A(d.headers)),this.method=d.method,this.mode=d.mode,this.signal=d.signal,!z&&d._bodyInit!=null&&(z=d._bodyInit,d.bodyUsed=!0)}else this.url=String(d);if(this.credentials=E.credentials||this.credentials||"same-origin",(E.headers||!this.headers)&&(this.headers=new A(E.headers)),this.method=x(E.method||this.method||"GET"),this.mode=E.mode||this.mode||null,this.signal=E.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&z)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(z),(this.method==="GET"||this.method==="HEAD")&&(E.cache==="no-store"||E.cache==="no-cache")){var Z=/([?&])_=[^&]*/;if(Z.test(this.url))this.url=this.url.replace(Z,"$1_="+new Date().getTime());else{var te=/\?/;this.url+=(te.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}q.prototype.clone=function(){return new q(this,{body:this._bodyInit})};function Ge(d){var E=new FormData;return d.trim().split("&").forEach(function(z){if(z){var Z=z.split("="),te=Z.shift().replace(/\+/g," "),K=Z.join("=").replace(/\+/g," ");E.append(decodeURIComponent(te),decodeURIComponent(K))}}),E}function ie(d){var E=new A,z=d.replace(/\r?\n[\t ]+/g," ");return z.split("\r").map(function(Z){return Z.indexOf(`
`)===0?Z.substr(1,Z.length):Z}).forEach(function(Z){var te=Z.split(":"),K=te.shift().trim();if(K){var he=te.join(":").trim();E.append(K,he)}}),E}re.call(q.prototype);function ae(d,E){if(!(this instanceof ae))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');E||(E={}),this.type="default",this.status=E.status===void 0?200:E.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in E?E.statusText:"",this.headers=new A(E.headers),this.url=E.url||"",this._initBody(d)}re.call(ae.prototype),ae.prototype.clone=function(){return new ae(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new A(this.headers),url:this.url})},ae.error=function(){var d=new ae(null,{status:0,statusText:""});return d.type="error",d};var Pe=[301,302,303,307,308];ae.redirect=function(d,E){if(Pe.indexOf(E)===-1)throw new RangeError("Invalid status code");return new ae(null,{status:E,headers:{location:d}})},v.DOMException=c.DOMException;try{new v.DOMException}catch{v.DOMException=function(E,z){this.message=E,this.name=z;var Z=Error(E);this.stack=Z.stack},v.DOMException.prototype=Object.create(Error.prototype),v.DOMException.prototype.constructor=v.DOMException}function Le(d,E){return new a(function(z,Z){var te=new q(d,E);if(te.signal&&te.signal.aborted)return Z(new v.DOMException("Aborted","AbortError"));var K=new r;function he(){K.abort()}K.onload=function(){var be={status:K.status,statusText:K.statusText,headers:ie(K.getAllResponseHeaders()||"")};be.url="responseURL"in K?K.responseURL:be.headers.get("X-Request-URL");var it="response"in K?K.response:K.responseText;setTimeout(function(){z(new ae(it,be))},0)},K.onerror=function(){setTimeout(function(){Z(new TypeError("Network request failed"))},0)},K.ontimeout=function(){setTimeout(function(){Z(new TypeError("Network request failed"))},0)},K.onabort=function(){setTimeout(function(){Z(new v.DOMException("Aborted","AbortError"))},0)};function _e(be){try{return be===""&&c.location.href?c.location.href:be}catch{return be}}K.open(te.method,_e(te.url),!0),te.credentials==="include"?K.withCredentials=!0:te.credentials==="omit"&&(K.withCredentials=!1),"responseType"in K&&(b.blob?K.responseType="blob":b.arrayBuffer&&te.headers.get("Content-Type")&&te.headers.get("Content-Type").indexOf("application/octet-stream")!==-1&&(K.responseType="arraybuffer")),E&&typeof E.headers=="object"&&!(E.headers instanceof A)?Object.getOwnPropertyNames(E.headers).forEach(function(be){K.setRequestHeader(be,F(E.headers[be]))}):te.headers.forEach(function(be,it){K.setRequestHeader(it,be)}),te.signal&&(te.signal.addEventListener("abort",he),K.onreadystatechange=function(){K.readyState===4&&te.signal.removeEventListener("abort",he)}),K.send(typeof te._bodyInit>"u"?null:te._bodyInit)})}Le.polyfill=!0,c.fetch||(c.fetch=Le,c.Headers=A,c.Request=q,c.Response=ae),v.Headers=A,v.Request=q,v.Response=ae,v.fetch=Le,Object.defineProperty(v,"__esModule",{value:!0})}),{fetch:p.fetch,Headers:p.Headers,Request:p.Request,Response:p.Response,DOMException:p.DOMException}}()}typeof define=="function"&&define.amd?define(function(){return t}):typeof Wt=="object"?zi.exports=t:e.fetchPonyfill=t})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof globalThis<"u"?globalThis:Wt)});var lr=In((cr,xi)=>{(function(e,t){typeof define=="function"&&define.amd?define([],function(){return t(e.Countly)}):typeof xi=="object"&&xi.exports?xi.exports=t(e.Countly):e.Countly=t(e.Countly)})(typeof window<"u"?window:cr,function(e){if(typeof window>"u")return;e=e||{};var t={SESSIONS:"sessions",EVENTS:"events",VIEWS:"views",SCROLLS:"scrolls",CLICKS:"clicks",FORMS:"forms",CRASHES:"crashes",ATTRIBUTION:"attribution",USERS:"users",STAR_RATING:"star-rating",LOCATION:"location",APM:"apm",FEEDBACK:"feedback",REMOTE_CONFIG:"remote-config"};e.features=[t.SESSIONS,t.EVENTS,t.VIEWS,t.SCROLLS,t.CLICKS,t.FORMS,t.CRASHES,t.ATTRIBUTION,t.USERS,t.STAR_RATING,t.LOCATION,t.APM,t.FEEDBACK,t.REMOTE_CONFIG];var n={NPS:"[CLY]_nps",SURVEY:"[CLY]_survey",STAR_RATING:"[CLY]_star_rating",VIEW:"[CLY]_view",ORIENTATION:"[CLY]_orientation",ACTION:"[CLY]_action"},a=Object.values(n),r={ERROR:"[ERROR] ",WARNING:"[WARNING] ",INFO:"[INFO] ",DEBUG:"[DEBUG] ",VERBOSE:"[VERBOSE] "},p={DEVELOPER_SUPPLIED:0,SDK_GENERATED:1,TEMPORARY_ID:2,URL_PROVIDED:3},v={BEAT_INTERVAL:500,QUEUE_SIZE:1e3,FAIL_TIMEOUT_AMOUNT:60,INACTIVITY_TIME:20,SESSION_UPDATE:60,MAX_EVENT_BATCH:100,SESSION_COOKIE_TIMEOUT:30,MAX_KEY_LENGTH:128,MAX_VALUE_SIZE:256,MAX_SEGMENTATION_VALUES:100,MAX_BREADCRUMB_COUNT:100,MAX_STACKTRACE_LINES_PER_THREAD:30,MAX_STACKTRACE_LINE_LENGTH:200};e.q=e.q||[],e.onload=e.onload||[];var c="23.2.2",b="javascript_native_web",D=/^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,w=function(m){var h=this,J=!e.i,X=!1,we="/i",Oe="/o/sdk",Ue=B("interval",m,v.BEAT_INTERVAL),Ne=B("queue_size",m,v.QUEUE_SIZE),de=[],Ie=[],Te={},ze=[],$e={},He=B("ignore_referrers",m,[]),Nt=null,nt=!0,xe,_t=0,We=null,Fe=0,vt=0,i=0,s=B("fail_timeout",m,v.FAIL_TIMEOUT_AMOUNT),f=B("inactivity_time",m,v.INACTIVITY_TIME),g=0,k=B("session_update",m,v.SESSION_UPDATE),T=B("max_events",m,v.MAX_EVENT_BATCH),M=B("max_logs",m,null),fe=B("use_session_cookie",m,!0),Se=B("session_cookie_timeout",m,v.SESSION_COOKIE_TIMEOUT),ge=!0,pe=!1,oe=B("offline_mode",m,!1),ft={},bt=!0,dn=A(),Et=!0,Dt=null,Ee=p.SDK_GENERATED,$t=!1,Vt=0,Ni=!1,ht=null,jt=null;try{localStorage.setItem("cly_testLocal",!0),localStorage.removeItem("cly_testLocal")}catch(o){l(r.ERROR,"Local storage test failed, Halting local storage support: "+o),Et=!1}for(var ke={},Di=0;Di<e.features.length;Di++)ke[e.features[Di]]={};this.initialize=function(){if(this.serialize=B("serialize",m,e.serialize),this.deserialize=B("deserialize",m,e.deserialize),this.getViewName=B("getViewName",m,e.getViewName),this.getViewUrl=B("getViewUrl",m,e.getViewUrl),this.getSearchQuery=B("getSearchQuery",m,e.getSearchQuery),this.DeviceIdType=e.DeviceIdType,this.namespace=B("namespace",m,""),this.clearStoredId=B("clear_stored_id",m,!1),this.app_key=B("app_key",m,null),this.onload=B("onload",m,[]),this.utm=B("utm",m,{source:!0,medium:!0,campaign:!0,term:!0,content:!0}),this.ignore_prefetch=B("ignore_prefetch",m,!0),this.rcAutoOptinAb=B("rc_automatic_optin_for_ab",m,!0),this.useExplicitRcApi=B("use_explicit_rc_api",m,!1),this.debug=B("debug",m,!1),this.test_mode=B("test_mode",m,!1),this.test_mode_eq=B("test_mode_eq",m,!1),this.metrics=B("metrics",m,{}),this.headers=B("headers",m,{}),this.url=ne(B("url",m,"")),this.app_version=B("app_version",m,"0.0"),this.country_code=B("country_code",m,null),this.city=B("city",m,null),this.ip_address=B("ip_address",m,null),this.ignore_bots=B("ignore_bots",m,!0),this.force_post=B("force_post",m,!1),this.remote_config=B("remote_config",m,!1),this.ignore_visitor=B("ignore_visitor",m,!1),this.require_consent=B("require_consent",m,!1),this.track_domains=B("track_domains",m,!0),this.storage=B("storage",m,"default"),this.enableOrientationTracking=B("enable_orientation_tracking",m,!0),this.maxKeyLength=B("max_key_length",m,v.MAX_KEY_LENGTH),this.maxValueSize=B("max_value_size",m,v.MAX_VALUE_SIZE),this.maxSegmentationValues=B("max_segmentation_values",m,v.MAX_SEGMENTATION_VALUES),this.maxBreadcrumbCount=B("max_breadcrumb_count",m,null),this.maxStackTraceLinesPerThread=B("max_stack_trace_lines_per_thread",m,v.MAX_STACKTRACE_LINES_PER_THREAD),this.maxStackTraceLineLength=B("max_stack_trace_line_length",m,v.MAX_STACKTRACE_LINE_LENGTH),this.heatmapWhitelist=B("heatmap_whitelist",m,[]),M&&!this.maxBreadcrumbCount?(this.maxBreadcrumbCount=M,l(r.WARNING,"initialize, 'maxCrashLogs' is deprecated. Use 'maxBreadcrumbCount' instead!")):!M&&!this.maxBreadcrumbCount&&(this.maxBreadcrumbCount=100),this.storage==="cookie"&&(Et=!1),!this.rcAutoOptinAb&&!this.useExplicitRcApi&&(l(r.WARNING,"initialize, Auto opting is disabled, switching to explicit RC API"),this.useExplicitRcApi=!0),Array.isArray(He)||(He=[]),this.url===""&&(l(r.ERROR,"initialize, Please provide server URL"),this.ignore_visitor=!0),le("cly_ignore")&&(this.ignore_visitor=!0),Ir(),de=le("cly_queue")||[],Ie=le("cly_event")||[],Te=le("cly_remote_configs")||{},this.clearStoredId&&(le("cly_id")&&!j&&(this.device_id=le("cly_id"),l(r.DEBUG,"initialize, temporarily using the previous device ID to flush existing events"),Ee=le("cly_id_type"),Ee||(l(r.DEBUG,"initialize, No device ID type info from the previous session, falling back to DEVELOPER_SUPPLIED, for event flushing"),Ee=p.DEVELOPER_SUPPLIED),Bt(),this.device_id=void 0,Ee=p.SDK_GENERATED),l(r.INFO,"initialize, Clearing the device ID storage"),localStorage.removeItem(this.app_key+"/cly_id"),localStorage.removeItem(this.app_key+"/cly_id_type"),localStorage.removeItem(this.app_key+"/cly_session")),mn(),window.name&&window.name.indexOf("cly:")===0)try{this.passed_data=JSON.parse(window.name.replace("cly:",""))}catch(ye){l(r.ERROR,"initialize, Could not parse name: "+window.name+", error: "+ye)}else if(location.hash&&location.hash.indexOf("#cly:")===0)try{this.passed_data=JSON.parse(location.hash.replace("#cly:",""))}catch(ye){l(r.ERROR,"initialize, Could not parse hash: "+location.hash+", error: "+ye)}if((this.passed_data&&this.passed_data.app_key&&this.passed_data.app_key===this.app_key||this.passed_data&&!this.passed_data.app_key&&J)&&this.passed_data.token&&this.passed_data.purpose){this.passed_data.token!==le("cly_old_token")&&(kn(this.passed_data.token),se("cly_old_token",this.passed_data.token));var o=[];Array.isArray(this.heatmapWhitelist)?(this.heatmapWhitelist.push(this.url),o=this.heatmapWhitelist.map(function(ye){return ne(ye)})):o=[this.url],o.includes(this.passed_data.url)&&this.passed_data.purpose==="heatmap"&&(this.ignore_visitor=!0,it(),_e(this.passed_data.url+"/views/heatmap.js",zt))}if(this.ignore_visitor){l(r.WARNING,"initialize, ignore_visitor:["+this.ignore_visitor+"], this user will not be tracked");return}l(r.DEBUG,"initialize, app_key:["+this.app_key+"], url:["+this.url+"]"),l(r.DEBUG,"initialize, device_id:["+B("device_id",m,void 0)+"]"),l(r.DEBUG,"initialize, require_consent is enabled:["+this.require_consent+"]");try{l(r.DEBUG,"initialize, metric override:["+JSON.stringify(this.metrics)+"]"),l(r.DEBUG,"initialize, header override:["+JSON.stringify(this.headers)+"]"),l(r.DEBUG,"initialize, number of onload callbacks provided:["+this.onload.length+"]"),l(r.DEBUG,"initialize, utm tags:["+JSON.stringify(this.utm)+"]"),He&&l(r.DEBUG,"initialize, referrers to ignore :["+JSON.stringify(He)+"]")}catch{l(r.ERROR,"initialize, Could not stringify some config object values")}l(r.DEBUG,"initialize, app_version:["+this.app_version+"]"),l(r.DEBUG,"initialize, provided location info; country_code:["+this.country_code+"], city:["+this.city+"], ip_address:["+this.ip_address+"]"),this.namespace!==""&&l(r.DEBUG,"initialize, namespace given:["+this.namespace+"]"),this.clearStoredId&&l(r.DEBUG,"initialize, clearStoredId flag set to:["+this.clearStoredId+"]"),this.ignore_prefetch&&l(r.DEBUG,"initialize, ignoring pre-fetching and pre-rendering from counting as real website visits :["+this.ignore_prefetch+"]"),this.test_mode&&l(r.WARNING,"initialize, test_mode:["+this.test_mode+"], request queue won't be processed"),this.test_mode_eq&&l(r.WARNING,"initialize, test_mode_eq:["+this.test_mode_eq+"], event queue won't be processed"),this.heatmapWhitelist&&l(r.DEBUG,"initialize, heatmap whitelist:["+JSON.stringify(this.heatmapWhitelist)+"], these domains will be whitelisted"),this.storage!=="default"&&l(r.DEBUG,"initialize, storage is set to:["+this.storage+"]"),this.ignore_bots&&l(r.DEBUG,"initialize, ignore traffic from bots :["+this.ignore_bots+"]"),this.force_post&&l(r.DEBUG,"initialize, forced post method for all requests:["+this.force_post+"]"),this.remote_config&&l(r.DEBUG,"initialize, remote_config callback provided:["+!!this.remote_config+"]"),typeof this.rcAutoOptinAb=="boolean"&&l(r.DEBUG,"initialize, automatic RC optin is enabled:["+this.rcAutoOptinAb+"]"),this.useExplicitRcApi||l(r.WARNING,"initialize, will use legacy RC API. Consider enabling new API during init with use_explicit_rc_api flag"),this.track_domains&&l(r.DEBUG,"initialize, tracking domain info:["+this.track_domains+"]"),this.enableOrientationTracking&&l(r.DEBUG,"initialize, enableOrientationTracking:["+this.enableOrientationTracking+"]"),fe||l(r.WARNING,"initialize, use_session_cookie is enabled:["+fe+"]"),oe&&l(r.DEBUG,"initialize, offline_mode:["+oe+"], user info won't be send to the servers"),oe&&l(r.DEBUG,"initialize, stored remote configs:["+JSON.stringify(Te)+"]"),l(r.DEBUG,"initialize, 'getViewName' callback override provided:["+(this.getViewName!==e.getViewName)+"]"),l(r.DEBUG,"initialize, 'getSearchQuery' callback override provided:["+(this.getSearchQuery!==e.getSearchQuery)+"]"),this.maxKeyLength!==v.MAX_KEY_LENGTH&&l(r.DEBUG,"initialize, maxKeyLength set to:["+this.maxKeyLength+"] characters"),this.maxValueSize!==v.MAX_VALUE_SIZE&&l(r.DEBUG,"initialize, maxValueSize set to:["+this.maxValueSize+"] characters"),this.maxSegmentationValues!==v.MAX_SEGMENTATION_VALUES&&l(r.DEBUG,"initialize, maxSegmentationValues set to:["+this.maxSegmentationValues+"] key/value pairs"),this.maxBreadcrumbCount!==v.MAX_BREADCRUMB_COUNT&&l(r.DEBUG,"initialize, maxBreadcrumbCount for custom logs set to:["+this.maxBreadcrumbCount+"] entries"),this.maxStackTraceLinesPerThread!==v.MAX_STACKTRACE_LINES_PER_THREAD&&l(r.DEBUG,"initialize, maxStackTraceLinesPerThread set to:["+this.maxStackTraceLinesPerThread+"] lines"),this.maxStackTraceLineLength!==v.MAX_STACKTRACE_LINE_LENGTH&&l(r.DEBUG,"initialize, maxStackTraceLineLength set to:["+this.maxStackTraceLineLength+"] characters"),Ue!==v.BEAT_INTERVAL&&l(r.DEBUG,"initialize, interval for heartbeats set to:["+Ue+"] milliseconds"),Ne!==v.QUEUE_SIZE&&l(r.DEBUG,"initialize, queue_size set to:["+Ne+"] items max"),s!==v.FAIL_TIMEOUT_AMOUNT&&l(r.DEBUG,"initialize, fail_timeout set to:["+s+"] seconds of wait time after a failed connection to server"),f!==v.INACTIVITY_TIME&&l(r.DEBUG,"initialize, inactivity_time set to:["+f+"] minutes to consider a user as inactive after no observable action"),k!==v.SESSION_UPDATE&&l(r.DEBUG,"initialize, session_update set to:["+k+"] seconds to check if extending a session is needed while the user is active"),T!==v.MAX_EVENT_BATCH&&l(r.DEBUG,"initialize, max_events set to:["+T+"] events to send in one batch"),M&&l(r.WARNING,"initialize, max_logs set to:["+M+"] breadcrumbs to store for crash logs max, deprecated "),Se!==v.SESSION_COOKIE_TIMEOUT&&l(r.DEBUG,"initialize, session_cookie_timeout set to:["+Se+"] minutes to expire a cookies session"),l(r.INFO,"initialize, Countly initialized");var u=null,y=h.getSearchQuery(),I=!1,P={};if(y)for(var O=y.substring(1).split("&"),U=0;U<O.length;U++){var R=O[U].split("=");R[0]==="cly_id"?se("cly_cmp_id",R[1]):R[0]==="cly_uid"?se("cly_cmp_uid",R[1]):R[0]==="cly_device_id"?u=R[1]:(R[0]+"").indexOf("utm_")===0&&this.utm[R[0].replace("utm_","")]&&(P[R[0].replace("utm_","")]=R[1],I=!0)}var j=le("cly_id")==="[CLY]_temp_id",H=B("device_id",m,void 0);if(le("cly_id")&&!j?(this.device_id=le("cly_id"),l(r.INFO,"initialize, Set the stored device ID"),Ee=le("cly_id_type"),Ee||(l(r.INFO,"initialize, No device ID type info from the previous session, falling back to DEVELOPER_SUPPLIED"),Ee=p.DEVELOPER_SUPPLIED)):u!==null?(l(r.INFO,"initialize, Device ID set by URL"),this.device_id=u,Ee=p.URL_PROVIDED):H?(l(r.INFO,"initialize, Device ID set by developer"),this.device_id=H,m&&Object.keys(m).length?m.device_id!==void 0&&(Ee=p.DEVELOPER_SUPPLIED):e.device_id!==void 0&&(Ee=p.DEVELOPER_SUPPLIED)):oe||j?(this.device_id="[CLY]_temp_id",Ee=p.TEMPORARY_ID,oe&&j?l(r.INFO,"initialize, Temp ID set, continuing offline mode from previous app session"):oe&&!j?l(r.INFO,"initialize, Temp ID set, entering offline mode"):(oe=!0,l(r.INFO,"initialize, Temp ID set, enabling offline mode"))):(l(r.INFO,"initialize, Generating the device ID"),this.device_id=B("device_id",m,Ui()),m&&Object.keys(m).length?m.device_id!==void 0&&(Ee=p.DEVELOPER_SUPPLIED):e.device_id!==void 0&&(Ee=p.DEVELOPER_SUPPLIED)),se("cly_id",this.device_id),se("cly_id_type",Ee),I){for(var ee in this.utm)P[ee]?this.userData.set("utm_"+ee,P[ee]):this.userData.unset("utm_"+ee);this.userData.save()}yn(),setTimeout(function(){ti(),h.remote_config&&h.fetch_remote_config(h.remote_config)},1),document.documentElement.setAttribute("data-countly-useragent",Pe())},this.halt=function(){l(r.WARNING,"halt, Resetting Countly"),e.i=void 0,J=!e.i,X=!1,we="/i",Oe="/o/sdk",Ue=500,Ne=1e3,de=[],Ie=[],Te={},ze=[],$e={},He=[],Nt=null,nt=!0,_t=0,We=null,Fe=0,vt=0,i=0,s=60,f=20,g=0,k=60,T=100,M=null,fe=!0,Se=30,ge=!0,pe=!1,oe=!1,ft={},bt=!0,dn=A(),Et=!0,Dt=null,Ee=p.SDK_GENERATED,$t=!1,Vt=0,Ni=!1,ht=null,jt=null;try{localStorage.setItem("cly_testLocal",!0),localStorage.removeItem("cly_testLocal")}catch{l(r.ERROR,"halt, Local storage test failed, will fallback to cookies"),Et=!1}e.features=[t.SESSIONS,t.EVENTS,t.VIEWS,t.SCROLLS,t.CLICKS,t.FORMS,t.CRASHES,t.ATTRIBUTION,t.USERS,t.STAR_RATING,t.LOCATION,t.APM,t.FEEDBACK,t.REMOTE_CONFIG],ke={};for(var o=0;o<e.features.length;o++)ke[e.features[o]]={};h.app_key=void 0,h.device_id=void 0,h.onload=void 0,h.utm=void 0,h.ignore_prefetch=void 0,h.debug=void 0,h.test_mode=void 0,h.test_mode_eq=void 0,h.metrics=void 0,h.headers=void 0,h.url=void 0,h.app_version=void 0,h.country_code=void 0,h.city=void 0,h.ip_address=void 0,h.ignore_bots=void 0,h.force_post=void 0,h.rcAutoOptinAb=void 0,h.useExplicitRcApi=void 0,h.remote_config=void 0,h.ignore_visitor=void 0,h.require_consent=void 0,h.track_domains=void 0,h.storage=void 0,h.enableOrientationTracking=void 0,h.maxKeyLength=void 0,h.maxValueSize=void 0,h.maxSegmentationValues=void 0,h.maxBreadcrumbCount=void 0,h.maxStackTraceLinesPerThread=void 0,h.maxStackTraceLineLength=void 0},this.group_features=function(o){if(l(r.INFO,"group_features, Grouping features"),o)for(var u in o)ke[u]?l(r.WARNING,"group_features, Feature name ["+u+"] is already reserved"):typeof o[u]=="string"?ke[u]={features:[o[u]]}:o[u]&&Array.isArray(o[u])&&o[u].length?ke[u]={features:o[u]}:l(r.ERROR,"group_features, Incorrect feature list for ["+u+"] value: ["+o[u]+"]");else l(r.ERROR,"group_features, Incorrect features:["+o+"]")},this.check_consent=function(o){return l(r.INFO,"check_consent, Checking if consent is given for specific feature:["+o+"]"),this.require_consent?ke[o]?!!(ke[o]&&ke[o].optin):(l(r.ERROR,"check_consent, No feature available for ["+o+"]"),!1):(l(r.INFO,"check_consent, require_consent is off, no consent is necessary"),!0)},this.get_device_id_type=function(){l(r.INFO,"check_device_id_type, Retrieving the current device id type.["+Ee+"]");var o;switch(Ee){case p.SDK_GENERATED:o=h.DeviceIdType.SDK_GENERATED;break;case p.URL_PROVIDED:case p.DEVELOPER_SUPPLIED:o=h.DeviceIdType.DEVELOPER_SUPPLIED;break;case p.TEMPORARY_ID:o=h.DeviceIdType.TEMPORARY_ID;break;default:o=-1;break}return o},this.get_device_id=function(){return l(r.INFO,"get_device_id, Retrieving the device id: ["+this.device_id+"]"),this.device_id},this.check_any_consent=function(){if(l(r.INFO,"check_any_consent, Checking if any consent is given"),!this.require_consent)return l(r.INFO,"check_any_consent, require_consent is off, no consent is necessary"),!0;for(var o in ke)if(ke[o]&&ke[o].optin)return!0;return l(r.INFO,"check_any_consent, No consents given"),!1},this.add_consent=function(o){if(l(r.INFO,"add_consent, Adding consent for ["+o+"]"),Array.isArray(o))for(var u=0;u<o.length;u++)this.add_consent(o[u]);else ke[o]?ke[o].features?(ke[o].optin=!0,this.add_consent(ke[o].features)):ke[o].optin!==!0&&(ke[o].optin=!0,pn(),setTimeout(function(){o===t.SESSIONS&&ft.begin_session?(h.begin_session.apply(h,ft.begin_session),ft.begin_session=null):o===t.VIEWS&&ft.track_pageview&&(We=null,h.track_pageview.apply(h,ft.track_pageview),ft.track_pageview=null)},1)):l(r.ERROR,"add_consent, No feature available for ["+o+"]")},this.remove_consent=function(o){l(r.INFO,"remove_consent, Removing consent for ["+o+"]"),this.remove_consent_internal(o,!0)},this.remove_consent_internal=function(o,u){if(u=u||!1,Array.isArray(o))for(var y=0;y<o.length;y++)this.remove_consent_internal(o[y],u);else ke[o]?ke[o].features?this.remove_consent_internal(ke[o].features,u):(ke[o].optin=!1,u&&ke[o].optin!==!1&&pn()):l(r.WARNING,"remove_consent, No feature available for ["+o+"]")};var Zt,pn=function(){Zt&&(clearTimeout(Zt),Zt=null),Zt=setTimeout(function(){for(var o={},u=0;u<e.features.length;u++)ke[e.features[u]].optin===!0?o[e.features[u]]=!0:o[e.features[u]]=!1;Me({consent:JSON.stringify(o)}),l(r.DEBUG,"Consent update request has been sent to the queue.")},1e3)};this.enable_offline_mode=function(){l(r.INFO,"enable_offline_mode, Enabling offline mode"),this.remove_consent_internal(e.features,!1),oe=!0,this.device_id="[CLY]_temp_id",h.device_id=this.device_id,Ee=p.TEMPORARY_ID},this.disable_offline_mode=function(o){if(!oe){l(r.WARNING,"disable_offline_mode, Countly was not in offline mode.");return}l(r.INFO,"disable_offline_mode, Disabling offline mode"),oe=!1,o&&this.device_id!==o?(this.device_id=o,h.device_id=this.device_id,Ee=p.DEVELOPER_SUPPLIED,se("cly_id",this.device_id),se("cly_id_type",p.DEVELOPER_SUPPLIED),l(r.INFO,"disable_offline_mode, Changing id to: "+this.device_id)):(this.device_id=Ui(),this.device_id==="[CLY]_temp_id"&&(this.device_id=F()),h.device_id=this.device_id,this.device_id!==le("cly_id")&&(se("cly_id",this.device_id),se("cly_id_type",p.SDK_GENERATED)));var u=!1;if(de.length>0)for(var y=0;y<de.length;y++)de[y].device_id==="[CLY]_temp_id"&&(de[y].device_id=this.device_id,u=!0);u&&se("cly_queue",de,!0)},this.begin_session=function(o,u){if(l(r.INFO,"begin_session, Starting the session. There was an ongoing session: ["+X+"]"),o&&l(r.INFO,"begin_session, Heartbeats are disabled"),u&&l(r.INFO,"begin_session, Session starts irrespective of session cookie"),this.check_consent(t.SESSIONS)){if(!X){this.enableOrientationTracking&&(this.report_orientation(),ie(window,"resize",function(){h.report_orientation()})),xe=A(),X=!0,nt=!o;var y=le("cly_session");if(l(r.VERBOSE,"begin_session, Session state, forced: ["+u+"], useSessionCookie: ["+fe+"], seconds to expire: ["+(y-xe)+"], expired: ["+(parseInt(y)<=A())+"] "),u||!fe||!y||parseInt(y)<=A()){l(r.INFO,"begin_session, Session started"),Dt===null&&(Dt=!0);var I={};I.begin_session=1,I.metrics=JSON.stringify(ii()),Me(I)}se("cly_session",A()+Se*60)}}else ft.begin_session=arguments},this.session_duration=function(o){l(r.INFO,"session_duration, Reporting session duration"),this.check_consent(t.SESSIONS)&&X&&(l(r.INFO,"session_duration, Session extended: ",o),Me({session_duration:o}),wn())},this.end_session=function(o,u){l(r.INFO,"end_session, Ending the current session. There was an on going session:["+X+"]"),this.check_consent(t.SESSIONS)&&X&&(o=o||A()-xe,Li(),!fe||u?(l(r.INFO,"end_session, Session ended"),Me({end_session:1,session_duration:o})):this.session_duration(o),X=!1)},this.change_id=function(o,u){if(l(r.INFO,"change_id, Changing the ID"),u&&l(r.INFO,"change_id, Will merge the IDs"),!o||typeof o!="string"||o.length===0){l(r.ERROR,"change_id, The provided ID: ["+o+"] is not a valid ID");return}if(oe){l(r.WARNING,"change_id, Offline mode was on, initiating disabling sequence instead."),this.disable_offline_mode(o);return}if(this.device_id!==o){u||(Bt(),this.end_session(null,!0),$e={},this.remove_consent_internal(e.features,!1));var y=this.device_id;this.device_id=o,h.device_id=this.device_id,Ee=p.DEVELOPER_SUPPLIED,se("cly_id",this.device_id),se("cly_id_type",p.DEVELOPER_SUPPLIED),l(r.INFO,"change_id, Changing ID from:["+y+"] to ["+o+"]"),u?Me({old_device_id:y}):this.begin_session(!nt,!0),this.remote_config&&(Te={},se("cly_remote_configs",Te),this.fetch_remote_config(this.remote_config))}},this.add_event=function(o){l(r.INFO,"add_event, Adding event: ",o);var u=!1;switch(o.key){case n.NPS:u=this.check_consent(t.FEEDBACK);break;case n.SURVEY:u=this.check_consent(t.FEEDBACK);break;case n.STAR_RATING:u=this.check_consent(t.STAR_RATING);break;case n.VIEW:u=this.check_consent(t.VIEWS);break;case n.ORIENTATION:u=this.check_consent(t.USERS);break;case n.ACTION:u=this.check_consent(t.CLICKS)||this.check_consent(t.SCROLLS);break;default:u=this.check_consent(t.EVENTS)}u&&Xe(o)};function Xe(o,u){if(h.ignore_visitor){l(r.ERROR,"Adding event failed. Possible bot or user opt out");return}if(!o.key){l(r.ERROR,"Adding event failed. Event must have a key property");return}o.count||(o.count=1),a.includes(o.key)||(o.key=q(o.key,h.maxKeyLength,"add_cly_event",l)),o.segmentation=x(o.segmentation,h.maxKeyLength,h.maxValueSize,h.maxSegmentationValues,"add_cly_event",l);var y=["key","count","sum","dur","segmentation"],I=re(o,y);I.timestamp=W();var P=new Date;I.hour=P.getHours(),I.dow=P.getDay(),I.id=u||L(),I.key===n.VIEW?I.pvid=jt||"":I.cvid=ht||"",Ie.push(I),se("cly_event",Ie),l(r.INFO," With event ID: ["+I.id+"], successfully adding the last event:",I)}this.start_event=function(o){if(!o||typeof o!="string"){l(r.WARNING,"start_event, you have to provide a valid string key instead of: ["+o+"]");return}if(l(r.INFO,"start_event, Starting timed event with key: ["+o+"]"),o=q(o,h.maxKeyLength,"start_event",l),$e[o]){l(r.WARNING,"start_event, Timed event with key: ["+o+"] already started");return}$e[o]=A()},this.cancel_event=function(o){return!o||typeof o!="string"?(l(r.WARNING,"cancel_event, you have to provide a valid string key instead of: ["+o+"]"),!1):(l(r.INFO,"cancel_event, Canceling timed event with key: ["+o+"]"),o=q(o,h.maxKeyLength,"cancel_event",l),$e[o]?(delete $e[o],l(r.INFO,"cancel_event, Timed event with key: ["+o+"] is canceled"),!0):(l(r.WARNING,"cancel_event, Timed event with key: ["+o+"] was not found"),!1))},this.end_event=function(o){if(!o){l(r.WARNING,"end_event, you have to provide a valid string key or event object instead of: ["+o+"]");return}if(l(r.INFO,"end_event, Ending timed event"),typeof o=="string"&&(o=q(o,h.maxKeyLength,"end_event",l),o={key:o}),!o.key){l(r.ERROR,"end_event, Timed event must have a key property");return}if(!$e[o.key]){l(r.ERROR,"end_event, Timed event with key: ["+o.key+"] was not started");return}o.dur=A()-$e[o.key],this.add_event(o),delete $e[o.key]},this.report_orientation=function(o){l(r.INFO,"report_orientation, Reporting orientation"),this.check_consent(t.USERS)&&Xe({key:n.ORIENTATION,segmentation:{mode:o||K()}})},this.report_conversion=function(o,u){l(r.WARNING,"report_conversion, Deprecated function call! Use 'recordDirectAttribution' in place of this call. Call will be redirected now!"),this.recordDirectAttribution(o,u)},this.recordDirectAttribution=function(o,u){l(r.INFO,"recordDirectAttribution, Recording the attribution for campaign ID: ["+o+"] and the user ID: ["+u+"]"),this.check_consent(t.ATTRIBUTION)&&(o=o||le("cly_cmp_id")||"cly_organic",u=u||le("cly_cmp_uid"),Me(u?{campaign_id:o,campaign_user:u}:{campaign_id:o}))},this.user_details=function(o){if(l(r.INFO,"user_details, Trying to add user details: ",o),this.check_consent(t.USERS)){Bt(),l(r.INFO,"user_details, flushed the event queue"),o.name=q(o.name,h.maxValueSize,"user_details",l),o.username=q(o.username,h.maxValueSize,"user_details",l),o.email=q(o.email,h.maxValueSize,"user_details",l),o.organization=q(o.organization,h.maxValueSize,"user_details",l),o.phone=q(o.phone,h.maxValueSize,"user_details",l),o.picture=q(o.picture,4096,"user_details",l),o.gender=q(o.gender,h.maxValueSize,"user_details",l),o.byear=q(o.byear,h.maxValueSize,"user_details",l),o.custom=x(o.custom,h.maxKeyLength,h.maxValueSize,h.maxSegmentationValues,"user_details",l);var u=["name","username","email","organization","phone","picture","gender","byear","custom"];Me({user_details:JSON.stringify(re(o,u))})}};var rt={},ct=function(o,u,y){h.check_consent(t.USERS)&&(rt[o]||(rt[o]={}),y==="$push"||y==="$pull"||y==="$addToSet"?(rt[o][y]||(rt[o][y]=[]),rt[o][y].push(u)):rt[o][y]=u)};this.userData={set:function(o,u){l(r.INFO,"set, Setting user's custom property value: ["+u+"] under the key: ["+o+"]"),o=q(o,h.maxKeyLength,"userData set",l),u=q(u,h.maxValueSize,"userData set",l),rt[o]=u},unset:function(o){l(r.INFO,"unset, Resetting user's custom property with key: ["+o+"] "),rt[o]=""},set_once:function(o,u){l(r.INFO,"set_once, Setting user's unique custom property value: ["+u+"] under the key: ["+o+"] "),o=q(o,h.maxKeyLength,"userData set_once",l),u=q(u,h.maxValueSize,"userData set_once",l),ct(o,u,"$setOnce")},increment:function(o){l(r.INFO,"increment, Increasing user's custom property value under the key: ["+o+"] by one"),o=q(o,h.maxKeyLength,"userData increment",l),ct(o,1,"$inc")},increment_by:function(o,u){l(r.INFO,"increment_by, Increasing user's custom property value under the key: ["+o+"] by: ["+u+"]"),o=q(o,h.maxKeyLength,"userData increment_by",l),u=q(u,h.maxValueSize,"userData increment_by",l),ct(o,u,"$inc")},multiply:function(o,u){l(r.INFO,"multiply, Multiplying user's custom property value under the key: ["+o+"] by: ["+u+"]"),o=q(o,h.maxKeyLength,"userData multiply",l),u=q(u,h.maxValueSize,"userData multiply",l),ct(o,u,"$mul")},max:function(o,u){l(r.INFO,"max, Saving user's maximum custom property value compared to the value: ["+u+"] under the key: ["+o+"]"),o=q(o,h.maxKeyLength,"userData max",l),u=q(u,h.maxValueSize,"userData max",l),ct(o,u,"$max")},min:function(o,u){l(r.INFO,"min, Saving user's minimum custom property value compared to the value: ["+u+"] under the key: ["+o+"]"),o=q(o,h.maxKeyLength,"userData min",l),u=q(u,h.maxValueSize,"userData min",l),ct(o,u,"$min")},push:function(o,u){l(r.INFO,"push, Pushing a value: ["+u+"] under the key: ["+o+"] to user's custom property array"),o=q(o,h.maxKeyLength,"userData push",l),u=q(u,h.maxValueSize,"userData push",l),ct(o,u,"$push")},push_unique:function(o,u){l(r.INFO,"push_unique, Pushing a unique value: ["+u+"] under the key: ["+o+"] to user's custom property array"),o=q(o,h.maxKeyLength,"userData push_unique",l),u=q(u,h.maxValueSize,"userData push_unique",l),ct(o,u,"$addToSet")},pull:function(o,u){l(r.INFO,"pull, Removing the value: ["+u+"] under the key: ["+o+"] from user's custom property array"),ct(o,u,"$pull")},save:function(){l(r.INFO,"save, Saving changes to user's custom property"),h.check_consent(t.USERS)&&(Bt(),l(r.INFO,"user_details, flushed the event queue"),Me({user_details:JSON.stringify({custom:rt})})),rt={}}},this.report_trace=function(o){if(l(r.INFO,"report_trace, Reporting performance trace"),this.check_consent(t.APM)){for(var u=["type","name","stz","etz","apm_metrics","apm_attr"],y=0;y<u.length;y++)if(u[y]!=="apm_attr"&&typeof o[u[y]]>"u"){l(r.WARNING,"report_trace, APM trace don't have the property: "+u[y]);return}o.name=q(o.name,h.maxKeyLength,"report_trace",l),o.app_metrics=x(o.app_metrics,h.maxKeyLength,h.maxValueSize,h.maxSegmentationValues,"report_trace",l);var I=re(o,u);I.timestamp=o.stz;var P=new Date;I.hour=P.getHours(),I.dow=P.getDay(),Me({apm:JSON.stringify(I)}),l(r.INFO,"report_trace, Successfully adding APM trace: ",I)}},this.track_errors=function(o){l(r.INFO,"track_errors, Started tracking errors"),e.i[this.app_key].tracking_crashes=!0,window.cly_crashes||(window.cly_crashes=!0,Nt=o,window.onerror=function u(y,I,P,O,U){if(U!=null)Q(U,!1);else{O=O||window.event&&window.event.errorCharacter;var R="";typeof y<"u"&&(R+=y+`
`),typeof I<"u"&&(R+="at "+I),typeof P<"u"&&(R+=":"+P),typeof O<"u"&&(R+=":"+O),R+=`
`;try{for(var j=[],H=u.caller;H;)j.push(H.name),H=H.caller;R+=j.join(`
`)}catch(ee){l(r.ERROR,"track_errors, Call stack generation experienced a problem: "+ee)}Q(R,!1)}},window.addEventListener("unhandledrejection",function(u){Q(new Error("Unhandled rejection (reason: "+(u.reason&&u.reason.stack?u.reason.stack:u.reason)+")."),!0)}))},this.log_error=function(o,u){l(r.INFO,"log_error, Logging errors"),this.recordError(o,!0,u)},this.add_log=function(o){if(l(r.INFO,"add_log, Adding a new log of breadcrumbs: [ "+o+" ]"),this.check_consent(t.CRASHES)){for(o=q(o,h.maxValueSize,"add_log",l);ze.length>=h.maxBreadcrumbCount;)ze.shift(),l(r.WARNING,"add_log, Reached maximum crashLogs size. Will erase the oldest one.");ze.push(o)}},this.fetch_remote_config=function(o,u,y){var I=null,P=null,O=null;if(o&&(!y&&typeof o=="function"?O=o:Array.isArray(o)&&(I=o)),u&&(!y&&typeof u=="function"?O=u:Array.isArray(u)&&(P=u)),!O&&typeof y=="function"&&(O=y),this.useExplicitRcApi){l(r.INFO,"fetch_remote_config, Fetching remote config");var U=this.rcAutoOptinAb?1:0;gn(I,P,U,null,O);return}l(r.WARNING,"fetch_remote_config, Fetching remote config, with legacy API"),gn(I,P,null,"legacy",O)};function gn(o,u,y,I,P){l(r.INFO,"fetch_remote_config_explicit, Fetching sequence initiated");var O={method:"rc"};o&&(O.keys=JSON.stringify(o)),u&&(O.omit_keys=JSON.stringify(u));var U;I==="legacy"&&(O.method="fetch_remote_config"),y===0&&(O.oi=0),y===1&&(O.oi=1),typeof P=="function"&&(U=P),h.check_consent(t.SESSIONS)&&(O.metrics=JSON.stringify(ii())),h.check_consent(t.REMOTE_CONFIG)?(ei(O),dt("fetch_remote_config_explicit",h.url+Oe,O,function(R,j,H){if(R){l(r.ERROR,"fetch_remote_config_explicit, An error occurred: "+R);return}try{var ee=JSON.parse(H);if(O.keys||O.omit_keys)for(var ye in ee)Te[ye]=ee[ye];else Te=ee;se("cly_remote_configs",Te)}catch(ve){l(r.ERROR,"fetch_remote_config_explicit, Had an issue while parsing the response: "+ve)}U&&(l(r.INFO,"fetch_remote_config_explicit, Callback function is provided"),U(R,Te))},!0)):(l(r.ERROR,"fetch_remote_config_explicit, Remote config requires explicit consent"),U&&U(new Error("Remote config requires explicit consent"),Te))}this.enrollUserToAb=function(o){if(l(r.INFO,"enrollUserToAb, Providing AB test keys to opt in for"),!o||!Array.isArray(o)||o.length===0){l(r.ERROR,"enrollUserToAb, No keys provided");return}var u={method:"ab",keys:JSON.stringify(o)};ei(u),dt("enrollUserToAb",this.url+Oe,u,function(y,I,P){if(y){l(r.ERROR,"enrollUserToAb, An error occurred: "+y);return}try{var O=JSON.parse(P);l(r.DEBUG,"enrollUserToAb, Parsed the response's result: ["+O.result+"]")}catch(U){l(r.ERROR,"enrollUserToAb, Had an issue while parsing the response: "+U)}},!0)},this.get_remote_config=function(o){return l(r.INFO,"get_remote_config, Getting remote config from storage"),typeof o<"u"?Te[o]:Te},this.stop_time=function(){l(r.INFO,"stop_time, Stopping tracking duration"),bt&&(bt=!1,_t=A()-xe,vt=A()-Fe)},this.start_time=function(){l(r.INFO,"start_time, Starting tracking duration"),bt||(bt=!0,xe=A()-_t,Fe=A()-vt,vt=0,wn())},this.track_sessions=function(){l(r.INFO,"track_session, Starting tracking user session"),this.begin_session(),this.start_time(),ie(window,"beforeunload",function(){Bt(),h.end_session()});var o="hidden";function u(){document[o]||!document.hasFocus()?h.stop_time():h.start_time()}ie(window,"focus",u),ie(window,"blur",u),ie(window,"pageshow",u),ie(window,"pagehide",u),"onfocusin"in document&&(ie(window,"focusin",u),ie(window,"focusout",u)),o in document?document.addEventListener("visibilitychange",u):"mozHidden"in document?(o="mozHidden",document.addEventListener("mozvisibilitychange",u)):"webkitHidden"in document?(o="webkitHidden",document.addEventListener("webkitvisibilitychange",u)):"msHidden"in document&&(o="msHidden",document.addEventListener("msvisibilitychange",u));function y(){g>=f&&h.start_time(),g=0}ie(window,"mousemove",y),ie(window,"click",y),ie(window,"keydown",y),ie(window,"scroll",y),setInterval(function(){g++,g>=f&&h.stop_time()},6e4)},this.track_pageview=function(o,u,y){if(l(r.INFO,"track_pageview, Tracking page views"),l(r.VERBOSE,"track_pageview, last view is:["+We+"], current view ID is:["+ht+"], previous view ID is:["+jt+"]"),We&&Ni&&(l(r.DEBUG,"track_pageview, Scroll registry triggered"),Ci(),$t=!0,Vt=0),Li(),jt=ht,ht=L(),o=q(o,h.maxKeyLength,"track_pageview",l),o&&Array.isArray(o)&&(u=o,o=null),o||(o=this.getViewName()),o===void 0||o===""){l(r.ERROR,"track_pageview, No page name to track (it is either undefined or empty string). No page view can be tracked.");return}if(o===null){l(r.ERROR,"track_pageview, View name returned as null. Page view will be ignored.");return}if(u&&u.length)for(var I=0;I<u.length;I++)try{var P=new RegExp(u[I]);if(P.test(o)){l(r.INFO,"track_pageview, Ignoring the page: "+o);return}}catch(H){l(r.ERROR,"track_pageview, Problem with finding ignore list item: "+u[I]+", error: "+H)}We=o,Fe=A(),l(r.VERBOSE,"track_pageview, last view is assigned:["+We+"], current view ID is:["+ht+"], previous view ID is:["+jt+"]");var O={name:o,visit:1,view:h.getViewUrl()};if(O=x(O,h.maxKeyLength,h.maxValueSize,h.maxSegmentationValues,"track_pageview",l),this.track_domains&&(O.domain=window.location.hostname),fe)if(X)Dt&&(Dt=!1,O.start=1);else{var U=le("cly_session");(!U||parseInt(U)<=A())&&(Dt=!1,O.start=1)}else if(typeof document.referrer<"u"&&document.referrer.length){var R=D.exec(document.referrer);R&&R[11]&&R[11]!==window.location.hostname&&(O.start=1)}if(y){y=x(y,h.maxKeyLength,h.maxValueSize,h.maxSegmentationValues,"track_pageview",l);for(var j in y)typeof O[j]>"u"&&(O[j]=y[j])}this.check_consent(t.VIEWS)?Xe({key:n.VIEW,segmentation:O},ht):ft.track_pageview=arguments},this.track_view=function(o,u,y){l(r.INFO,"track_view, Initiating tracking page views"),this.track_pageview(o,u,y)},this.track_clicks=function(o){l(r.INFO,"track_clicks, Starting to track clicks"),o&&l(r.INFO,"track_clicks, Tracking the specified children:["+o+"]"),o=o||document;var u=!0;function y(I){if(u){if(u=!1,E(I),typeof I.pageX<"u"&&typeof I.pageY<"u"){var P=z(),O=Z();if(h.check_consent(t.CLICKS)){var U={type:"click",x:I.pageX,y:I.pageY,width:O,height:P,view:h.getViewUrl()};U=x(U,h.maxKeyLength,h.maxValueSize,h.maxSegmentationValues,"processClick",l),h.track_domains&&(U.domain=window.location.hostname),Xe({key:n.ACTION,segmentation:U})}}setTimeout(function(){u=!0},1e3)}}ie(o,"click",y)},this.track_scrolls=function(o){l(r.INFO,"track_scrolls, Starting to track scrolls"),o&&l(r.INFO,"track_scrolls, Tracking the specified children"),o=o||window,$t=!0,Ni=!0,ie(o,"scroll",En),ie(o,"beforeunload",Ci)},this.track_links=function(o){l(r.INFO,"track_links, Starting to track clicks to links"),o&&l(r.INFO,"track_links, Tracking the specified children"),o=o||document;function u(y){var I=Ge(ae(y),"a");I&&(E(y),h.check_consent(t.CLICKS)&&Xe({key:"linkClick",segmentation:{href:I.href,text:I.innerText,id:I.id,view:h.getViewUrl()}}))}ie(o,"click",u)},this.track_forms=function(o,u){l(r.INFO,"track_forms, Starting to track form submissions. DOM object provided:["+!!o+"] Tracking hidden inputs :["+!!u+"]"),o=o||document;function y(P){return P.name||P.id||P.type||P.nodeName}function I(P){var O=ae(P),U={id:O.attributes.id&&O.attributes.id.nodeValue,name:O.attributes.name&&O.attributes.name.nodeValue,action:O.attributes.action&&O.attributes.action.nodeValue,method:O.attributes.method&&O.attributes.method.nodeValue,view:h.getViewUrl()},R;if(typeof O.elements<"u"){for(var j=0;j<O.elements.length;j++)R=O.elements[j],R&&R.type!=="password"&&R.className.indexOf("cly_user_ignore")===-1&&(typeof U["input:"+y(R)]>"u"&&(U["input:"+y(R)]=[]),R.nodeName.toLowerCase()==="select"?typeof R.multiple<"u"?U["input:"+y(R)].push(N(R)):U["input:"+y(R)].push(R.options[R.selectedIndex].value):R.nodeName.toLowerCase()==="input"?typeof R.type<"u"?R.type.toLowerCase()==="checkbox"||R.type.toLowerCase()==="radio"?R.checked&&U["input:"+y(R)].push(R.value):(R.type.toLowerCase()!=="hidden"||u)&&U["input:"+y(R)].push(R.value):U["input:"+y(R)].push(R.value):(R.nodeName.toLowerCase()==="textarea"||typeof R.value<"u")&&U["input:"+y(R)].push(R.value));for(var H in U)U[H]&&typeof U[H].join=="function"&&(U[H]=U[H].join(", "))}h.check_consent(t.FORMS)&&Xe({key:"formSubmit",segmentation:U})}ie(o,"submit",I)},this.collect_from_forms=function(o,u){l(r.INFO,"collect_from_forms, Starting to collect possible user data. DOM object provided:["+!!o+"] Submitting custom user property:["+!!u+"]"),o=o||document;function y(I){var P=ae(I),O={},U=!1,R;if(typeof P.elements<"u"){var j={},H=o.getElementsByTagName("LABEL"),ee,ye;for(ee=0;ee<H.length;ee++)H[ee].htmlFor&&H[ee].htmlFor!==""&&(j[H[ee].htmlFor]=H[ee].innerText||H[ee].textContent||H[ee].innerHTML);for(ee=0;ee<P.elements.length;ee++)if(R=P.elements[ee],R&&R.type!=="password"&&R.className.indexOf("cly_user_ignore")===-1){var ve="";if(R.nodeName.toLowerCase()==="select"?typeof R.multiple<"u"?ve=N(R):ve=R.options[R.selectedIndex].value:R.nodeName.toLowerCase()==="input"?typeof R.type<"u"&&(R.type.toLowerCase()==="checkbox"||R.type.toLowerCase()==="radio")?R.checked&&(ve=R.value):ve=R.value:(R.nodeName.toLowerCase()==="textarea"||typeof R.value<"u")&&(ve=R.value),R.className&&R.className.indexOf("cly_user_")!==-1){var Qe=R.className.split(" ");for(ye=0;ye<Qe.length;ye++)if(Qe[ye].indexOf("cly_user_")===0){O[Qe[ye].replace("cly_user_","")]=ve,U=!0;break}}else R.type&&R.type.toLowerCase()==="email"||R.name&&R.name.toLowerCase().indexOf("email")!==-1||R.id&&R.id.toLowerCase().indexOf("email")!==-1||R.id&&j[R.id]&&j[R.id].toLowerCase().indexOf("email")!==-1||/[^@\s]+@[^@\s]+\.[^@\s]+/.test(ve)?(O.email||(O.email=ve),U=!0):R.name&&R.name.toLowerCase().indexOf("username")!==-1||R.id&&R.id.toLowerCase().indexOf("username")!==-1||R.id&&j[R.id]&&j[R.id].toLowerCase().indexOf("username")!==-1?(O.username||(O.username=ve),U=!0):R.name&&(R.name.toLowerCase().indexOf("tel")!==-1||R.name.toLowerCase().indexOf("phone")!==-1||R.name.toLowerCase().indexOf("number")!==-1)||R.id&&(R.id.toLowerCase().indexOf("tel")!==-1||R.id.toLowerCase().indexOf("phone")!==-1||R.id.toLowerCase().indexOf("number")!==-1)||R.id&&j[R.id]&&(j[R.id].toLowerCase().indexOf("tel")!==-1||j[R.id].toLowerCase().indexOf("phone")!==-1||j[R.id].toLowerCase().indexOf("number")!==-1)?(O.phone||(O.phone=ve),U=!0):R.name&&(R.name.toLowerCase().indexOf("org")!==-1||R.name.toLowerCase().indexOf("company")!==-1)||R.id&&(R.id.toLowerCase().indexOf("org")!==-1||R.id.toLowerCase().indexOf("company")!==-1)||R.id&&j[R.id]&&(j[R.id].toLowerCase().indexOf("org")!==-1||j[R.id].toLowerCase().indexOf("company")!==-1)?(O.organization||(O.organization=ve),U=!0):(R.name&&R.name.toLowerCase().indexOf("name")!==-1||R.id&&R.id.toLowerCase().indexOf("name")!==-1||R.id&&j[R.id]&&j[R.id].toLowerCase().indexOf("name")!==-1)&&(O.name||(O.name=""),O.name+=ve+" ",U=!0)}}U&&(l(r.INFO,"collect_from_forms, Gathered user data",O),u?h.user_details({custom:O}):h.user_details(O))}ie(o,"submit",y)},this.collect_from_facebook=function(o){if(typeof FB>"u"||!FB||!FB.api){l(r.ERROR,"collect_from_facebook, Facebook SDK is not available");return}l(r.INFO,"collect_from_facebook, Starting to collect possible user data"),FB.api("/me",function(u){var y={};if(u.name&&(y.name=u.name),u.email&&(y.email=u.email),u.gender==="male"?y.gender="M":u.gender==="female"&&(y.gender="F"),u.birthday){var I=u.birthday.split("/").pop();I&&I.length===4&&(y.byear=I)}if(u.work&&u.work[0]&&u.work[0].employer&&u.work[0].employer.name&&(y.organization=u.work[0].employer.name),o){y.custom={};for(var P in o){for(var O=o[P].split("."),U=u,R=0;R<O.length&&(U=U[O[R]],!(typeof U>"u"));R++);typeof U<"u"&&(y.custom[P]=U)}}h.user_details(y)})},this.opt_out=function(){l(r.INFO,"opt_out, Opting out the user"),this.ignore_visitor=!0,se("cly_ignore",!0)},this.opt_in=function(){l(r.INFO,"opt_in, Opting in the user"),se("cly_ignore",!1),this.ignore_visitor=!1,mn(),!this.ignore_visitor&&!pe&&ti()},this.report_feedback=function(o){l(r.WARNING,"report_feedback, Deprecated function call! Use 'recordRatingWidgetWithID' or 'reportFeedbackWidgetManually' in place of this call. Call will be redirected to 'recordRatingWidgetWithID' now!"),this.recordRatingWidgetWithID(o)},this.recordRatingWidgetWithID=function(o){if(l(r.INFO,"recordRatingWidgetWithID, Providing information about user with ID: [ "+o.widget_id+" ]"),!!this.check_consent(t.STAR_RATING)){if(!o.widget_id){l(r.ERROR,"recordRatingWidgetWithID, Rating Widget must contain widget_id property");return}if(!o.rating){l(r.ERROR,"recordRatingWidgetWithID, Rating Widget must contain rating property");return}var u=["widget_id","contactMe","platform","app_version","rating","email","comment"],y={key:n.STAR_RATING,count:1,segmentation:{}};y.segmentation=re(o,u),y.segmentation.app_version||(y.segmentation.app_version=this.metrics._app_version||this.app_version),y.segmentation.rating>5?(l(r.WARNING,"recordRatingWidgetWithID, You have entered a rating higher than 5. Changing it back to 5 now."),y.segmentation.rating=5):y.segmentation.rating<1&&(l(r.WARNING,"recordRatingWidgetWithID, You have entered a rating lower than 1. Changing it back to 1 now."),y.segmentation.rating=1),l(r.INFO,"recordRatingWidgetWithID, Reporting Rating Widget: ",y),Xe(y)}},this.reportFeedbackWidgetManually=function(o,u,y){if(this.check_consent(t.FEEDBACK)){if(!(o&&u)){l(r.ERROR,"reportFeedbackWidgetManually, Widget data and/or Widget object not provided. Aborting.");return}if(!o._id){l(r.ERROR,"reportFeedbackWidgetManually, Feedback Widgets must contain _id property");return}if(oe){l(r.ERROR,"reportFeedbackWidgetManually, Feedback Widgets can not be reported in offline mode");return}l(r.INFO,"reportFeedbackWidgetManually, Providing information about user with, provided result of the widget with  ID: [ "+o._id+" ] and type: ["+o.type+"]");var I=[],P=o.type,O;if(P==="nps"){if(y){if(!y.rating){l(r.ERROR,"reportFeedbackWidgetManually, Widget must contain rating property");return}y.rating=Math.round(y.rating),y.rating>10?(l(r.WARNING,"reportFeedbackWidgetManually, You have entered a rating higher than 10. Changing it back to 10 now."),y.rating=10):y.rating<0&&(l(r.WARNING,"reportFeedbackWidgetManually, You have entered a rating lower than 0. Changing it back to 0 now."),y.rating=0),I=["rating","comment"]}O=n.NPS}else if(P==="survey"){if(y){if(Object.keys(y).length<1){l(r.ERROR,"reportFeedbackWidgetManually, Widget should have answers to be reported");return}I=Object.keys(y)}O=n.SURVEY}else if(P==="rating"){if(y){if(!y.rating){l(r.ERROR,"reportFeedbackWidgetManually, Widget must contain rating property");return}y.rating=Math.round(y.rating),y.rating>5?(l(r.WARNING,"reportFeedbackWidgetManually, You have entered a rating higher than 5. Changing it back to 5 now."),y.rating=5):y.rating<1&&(l(r.WARNING,"reportFeedbackWidgetManually, You have entered a rating lower than 1. Changing it back to 1 now."),y.rating=1),I=["rating","comment","email","contactMe"]}O=n.STAR_RATING}else{l(r.ERROR,"reportFeedbackWidgetManually, Widget has an unacceptable type");return}var U={key:O,count:1,segmentation:{widget_id:o._id,platform:this.platform,app_version:this.metrics._app_version||this.app_version}};y===null?U.segmentation.closed=1:U.segmentation=Re(U.segmentation,y,I),l(r.INFO,"reportFeedbackWidgetManually, Reporting "+P+": ",U),Xe(U)}},this.show_feedback_popup=function(o){l(r.WARNING,"show_feedback_popup, Deprecated function call! Use 'presentRatingWidgetWithID' in place of this call. Call will be redirected now!"),this.presentRatingWidgetWithID(o)},this.presentRatingWidgetWithID=function(o){l(r.INFO,"presentRatingWidgetWithID, Showing rating widget popup for the widget with ID: [ "+o+" ]"),this.check_consent(t.STAR_RATING)&&(oe?l(r.ERROR,"presentRatingWidgetWithID, Cannot show ratingWidget popup in offline mode"):dt("presentRatingWidgetWithID",this.url+"/o/feedback/widget",{widget_id:o},function(u,y,I){if(u){l(r.ERROR,"presentRatingWidgetWithID, An error occurred: "+u);return}try{var P=JSON.parse(I);Bi(P,!1)}catch(O){l(r.ERROR,"presentRatingWidgetWithID, JSON parse failed: "+O)}},!0))},this.initialize_feedback_popups=function(o){l(r.WARNING,"initialize_feedback_popups, Deprecated function call! Use 'initializeRatingWidgets' in place of this call. Call will be redirected now!"),this.initializeRatingWidgets(o)},this.initializeRatingWidgets=function(o){if(l(r.INFO,"initializeRatingWidgets, Initializing rating widget with provided widget IDs:[ "+o+"]"),!!this.check_consent(t.STAR_RATING)){o||(o=le("cly_fb_widgets"));for(var u=document.getElementsByClassName("countly-feedback-sticker");u.length>0;)u[0].remove();dt("initializeRatingWidgets",this.url+"/o/feedback/multiple-widgets-by-id",{widgets:JSON.stringify(o)},function(y,I,P){if(y){l(r.ERROR,"initializeRatingWidgets, An error occurred: "+y);return}try{for(var O=JSON.parse(P),U=0;U<O.length;U++)if(O[U].is_active==="true"){var R=O[U].target_devices,j=Le();if(R[j])if(typeof O[U].hide_sticker=="string"&&(O[U].hide_sticker=O[U].hide_sticker==="true"),O[U].target_page==="all"&&!O[U].hide_sticker)Bi(O[U],!0);else for(var H=O[U].target_pages,ee=0;ee<H.length;ee++){var ye=H[ee].substr(0,H[ee].length-1)===window.location.pathname.substr(0,H[ee].length-1),ve=H[ee]===window.location.pathname,Qe=H[ee].includes("*");(Qe&&ye||ve)&&!O[U].hide_sticker&&Bi(O[U],!0)}}}catch(Ce){l(r.ERROR,"initializeRatingWidgets, JSON parse error: "+Ce)}},!0)}},this.enable_feedback=function(o){l(r.WARNING,"enable_feedback, Deprecated function call! Use 'enableRatingWidgets' in place of this call. Call will be redirected now!"),this.enableRatingWidgets(o)},this.enableRatingWidgets=function(o){if(l(r.INFO,"enableRatingWidgets, Enabling rating widget with params:",o),!!this.check_consent(t.STAR_RATING))if(oe)l(r.ERROR,"enableRatingWidgets, Cannot enable rating widgets in offline mode");else{se("cly_fb_widgets",o.popups||o.widgets),be(this.url+"/star-rating/stylesheets/countly-feedback-web.css");var u=o.popups||o.widgets;u.length>0?(document.body.insertAdjacentHTML("beforeend",'<div id="cfbg"></div>'),this.initializeRatingWidgets(u)):l(r.ERROR,"enableRatingWidgets, You should provide at least one widget id as param. Read documentation for more detail. https://resources.count.ly/plugins/feedback")}},this.get_available_feedback_widgets=function(o){if(l(r.INFO,"get_available_feedback_widgets, Getting the feedback list, callback function is provided:["+!!o+"]"),!this.check_consent(t.FEEDBACK)){o&&o(null,new Error("Consent for feedback not provided."));return}if(oe){l(r.ERROR,"get_available_feedback_widgets, Cannot enable feedback widgets in offline mode.");return}var u=this.url+Oe,y={method:t.FEEDBACK,device_id:this.device_id,app_key:this.app_key};dt("get_available_feedback_widgets",u,y,function(I,P,O){if(I){l(r.ERROR,"get_available_feedback_widgets, Error occurred while fetching feedbacks: "+I),o&&o(null,I);return}try{var U=JSON.parse(O),R=U.result||[];o&&o(R,null);return}catch(j){l(r.ERROR,"get_available_feedback_widgets, Error while parsing feedback widgets list: "+j),o&&o(null,j)}},!1)},this.getFeedbackWidgetData=function(o,u){if(!o.type){l(r.ERROR,"getFeedbackWidgetData, Expected the provided widget object to have a type but got: ["+JSON.stringify(o)+"], aborting.");return}if(l(r.INFO,"getFeedbackWidgetData, Retrieving data for: ["+JSON.stringify(o)+"], callback function is provided:["+!!u+"]"),!this.check_consent(t.FEEDBACK)){u&&u(null,new Error("Consent for feedback not provided."));return}if(oe){l(r.ERROR,"getFeedbackWidgetData, Cannot enable feedback widgets in offline mode.");return}var y=this.url,I={widget_id:o._id,shown:1,sdk_version:c,sdk_name:b,platform:this.platform,app_version:this.app_version};if(o.type==="nps")y+="/o/surveys/nps/widget";else if(o.type==="survey")y+="/o/surveys/survey/widget";else if(o.type==="rating")y+="/o/surveys/rating/widget";else{l(r.ERROR,"getFeedbackWidgetData, Unknown type info: ["+o.type+"]");return}dt("getFeedbackWidgetData",y,I,P,!0);function P(O,U,R){if(O){l(r.ERROR,"getFeedbackWidgetData, Error occurred while fetching feedbacks: "+O),u&&u(null,O);return}try{var j=JSON.parse(R);u&&u(j,null);return}catch(H){l(r.ERROR,"getFeedbackWidgetData, Error while parsing feedback widgets list: "+H),u&&u(null,H)}}},this.present_feedback_widget=function(o,u,y){if(l(r.INFO,"present_feedback_widget, Presenting the feedback widget by appending to the element with ID: [ "+u+" ] and className: [ "+y+" ]"),!this.check_consent(t.FEEDBACK))return;if(!o||typeof o!="object"||Array.isArray(o)){l(r.ERROR,"present_feedback_widget, Please provide at least one feedback widget object.");return}try{var I=this.url;if(o.type==="nps")l(r.DEBUG,"present_feedback_widget, Widget type: nps."),I+="/feedback/nps";else if(o.type==="survey")l(r.DEBUG,"present_feedback_widget, Widget type: survey."),I+="/feedback/survey";else if(o.type==="rating")l(r.DEBUG,"present_feedback_widget, Widget type: rating."),I+="/feedback/rating";else{l(r.ERROR,"present_feedback_widget, Feedback widget only accepts nps, rating and survey types.");return}var P=window.origin||window.location.origin,O;o.type==="rating"?(l(r.DEBUG,"present_feedback_widget, Loading css for rating widget."),O="ratings",be(this.url+"/star-rating/stylesheets/countly-feedback-web.css")):(l(r.DEBUG,"present_feedback_widget, Loading css for survey or nps."),be(this.url+"/surveys/stylesheets/countly-surveys.css"),O="surveys"),I+="?widget_id="+o._id,I+="&app_key="+this.app_key,I+="&device_id="+this.device_id,I+="&sdk_name="+b,I+="&platform="+this.platform,I+="&app_version="+this.app_version,I+="&sdk_version="+c,I+="&origin="+P,I+="&widget_v=web";var U=document.createElement("iframe");U.src=I,U.name="countly-"+O+"-iframe",U.id="countly-"+O+"-iframe";var R=!1;U.onload=function(){R&&(document.getElementById("countly-"+O+"-wrapper-"+o._id).style.display="none",document.getElementById("csbg").style.display="none"),R=!0,l(r.DEBUG,"present_feedback_widget, Loaded iframe.")};for(var j=document.getElementById("csbg");j;)j.remove(),j=document.getElementById("csbg"),l(r.DEBUG,"present_feedback_widget, Removing past overlay.");for(var H=document.getElementsByClassName("countly-"+O+"-wrapper"),ee=0;ee<H.length;ee++)H[ee].remove(),l(r.DEBUG,"present_feedback_widget, Removed a wrapper.");H=document.createElement("div"),H.className="countly-"+O+"-wrapper",H.id="countly-"+O+"-wrapper-"+o._id,o.type==="survey"&&(H.className=H.className+" "+o.appearance.position);var ye=document.body,ve=!1;if(u&&(document.getElementById(u)?(ye=document.getElementById(u),ve=!0):l(r.ERROR,"present_feedback_widget, Provided ID not found.")),ve||y&&(document.getElementsByClassName(y)[0]?ye=document.getElementsByClassName(y)[0]:l(r.ERROR,"present_feedback_widget, Provided class not found.")),ye.insertAdjacentHTML("beforeend",'<div id="csbg"></div>'),ye.appendChild(H),o.type==="rating"){var Qe=document.createElement("div");Qe.className="countly-ratings-overlay",Qe.id="countly-ratings-overlay-"+o._id,H.appendChild(Qe),l(r.DEBUG,"present_feedback_widget, appended the rating overlay to wrapper"),ie(document.getElementById("countly-ratings-overlay-"+o._id),"click",function(){document.getElementById("countly-ratings-wrapper-"+o._id).style.display="none"})}if(H.appendChild(U),l(r.DEBUG,"present_feedback_widget, Appended the iframe"),ie(window,"message",function(me){var qe={};try{qe=JSON.parse(me.data),l(r.DEBUG,"present_feedback_widget, Parsed response message "+qe)}catch(Ar){l(r.ERROR,"present_feedback_widget, Error while parsing message body "+Ar)}if(!qe.close){l(r.DEBUG,"present_feedback_widget, Closing signal not sent yet");return}document.getElementById("countly-"+O+"-wrapper-"+o._id).style.display="none",document.getElementById("csbg").style.display="none"}),o.type==="survey"){var Ce=!1;switch(o.showPolicy){case"afterPageLoad":document.readyState==="complete"?Ce||(Ce=!0,kt(o)):ie(document,"readystatechange",function(me){me.target.readyState==="complete"&&(Ce||(Ce=!0,kt(o)))});break;case"afterConstantDelay":setTimeout(function(){Ce||(Ce=!0,kt(o))},1e4);break;case"onAbandon":document.readyState==="complete"?ie(document,"mouseleave",function(){Ce||(Ce=!0,kt(o))}):ie(document,"readystatechange",function(me){me.target.readyState==="complete"&&ie(document,"mouseleave",function(){Ce||(Ce=!0,kt(o))})});break;case"onScrollHalfwayDown":ie(window,"scroll",function(){if(!Ce){var me=Math.max(window.scrollY,document.body.scrollTop,document.documentElement.scrollTop),qe=z();me>=qe/2&&(Ce=!0,kt(o))}});break;default:Ce||(Ce=!0,kt(o))}}else if(o.type==="nps")document.getElementById("countly-"+O+"-wrapper-"+o._id).style.display="block",document.getElementById("csbg").style.display="block";else if(o.type==="rating"){var ni=!1;document.readyState==="complete"?ni||(ni=!0,Rn(o)):ie(document,"readystatechange",function(me){me.target.readyState==="complete"&&(ni||(ni=!0,Rn(o)))})}}catch(me){l(r.ERROR,"present_feedback_widget, Something went wrong while presenting the widget: "+me)}function kt(me){document.getElementById("countly-surveys-wrapper-"+me._id).style.display="block",document.getElementById("csbg").style.display="block"}function Rn(me){if(!me.appearance.hideS){l(r.DEBUG,"present_feedback_widget, handling the sticker as it was not set to hidden");var qe=document.createElement("div");qe.innerText=me.appearance.text,qe.style.color=me.appearance.text_color.length<7?"#"+me.appearance.text_color:me.appearance.text_color,qe.style.backgroundColor=me.appearance.bg_color.length<7?"#"+me.appearance.bg_color:me.appearance.bg_color,qe.className="countly-feedback-sticker  "+me.appearance.position+"-"+me.appearance.size,qe.id="countly-feedback-sticker-"+me._id,document.body.appendChild(qe),ie(document.getElementById("countly-feedback-sticker-"+me._id),"click",function(){document.getElementById("countly-ratings-wrapper-"+me._id).style.display="flex",document.getElementById("csbg").style.display="block"})}ie(document.getElementById("countly-feedback-close-icon-"+me._id),"click",function(){document.getElementById("countly-ratings-wrapper-"+me._id).style.display="none",document.getElementById("csbg").style.display="none"})}},this.recordError=function(o,u,y){if(l(r.INFO,"recordError, Recording error"),this.check_consent(t.CRASHES)&&o){y=y||Nt;var I="";if(typeof o=="object"?typeof o.stack<"u"?I=o.stack:(typeof o.name<"u"&&(I+=o.name+":"),typeof o.message<"u"&&(I+=o.message+`
`),typeof o.fileName<"u"&&(I+="in "+o.fileName+`
`),typeof o.lineNumber<"u"&&(I+="on "+o.lineNumber),typeof o.columnNumber<"u"&&(I+=":"+o.columnNumber)):I=o+"",I.length>h.maxStackTraceLineLength*h.maxStackTraceLinesPerThread){l(r.DEBUG,"record_error, Error stack is too long will be truncated");var P=I.split(`
`);P.length>h.maxStackTraceLinesPerThread&&(P=P.splice(0,h.maxStackTraceLinesPerThread));for(var O=0,U=P.length;O<U;O++)P[O].length>h.maxStackTraceLineLength&&(P[O]=P[O].substring(0,h.maxStackTraceLineLength));I=P.join(`
`)}u=!!u;var R=ii(),j={_resolution:R._resolution,_error:I,_app_version:R._app_version,_run:A()-dn};j._not_os_specific=!0,j._javascript=!0;var H=navigator.battery||navigator.webkitBattery||navigator.mozBattery||navigator.msBattery;H&&(j._bat=Math.floor(H.level*100)),typeof navigator.onLine<"u"&&(j._online=!!navigator.onLine),j._background=!document.hasFocus(),ze.length>0&&(j._logs=ze.join(`
`)),ze=[],j._nonfatal=u,j._view=this.getViewName(),typeof y<"u"&&(y=x(y,h.maxKeyLength,h.maxValueSize,h.maxSegmentationValues,"record_error",l),j._custom=y);try{var ee=document.createElement("canvas"),ye=ee.getContext("experimental-webgl");j._opengl=ye.getParameter(ye.VERSION)}catch(Qe){l(r.ERROR,"Could not get the experimental-webgl context: "+Qe)}var ve={};ve.crash=JSON.stringify(j),ve.metrics=JSON.stringify({_ua:R._ua}),Me(ve)}};function mn(){h.ignore_prefetch&&typeof document.visibilityState<"u"&&document.visibilityState==="prerender"&&(h.ignore_visitor=!0),h.ignore_bots&&d()&&(h.ignore_visitor=!0)}function Bt(){Ie.length>0&&(l(r.DEBUG,"Flushing events"),Me({events:JSON.stringify(Ie)}),Ie=[],se("cly_event",Ie))}function Bi(o,u){var y=!!document.getElementById("countly-feedback-sticker-"+o._id);if(y){l(r.ERROR,"Widget with same ID exists");return}try{var I=document.createElement("div");I.className="countly-iframe-wrapper",I.id="countly-iframe-wrapper-"+o._id;var P=document.createElement("span");P.className="countly-feedback-close-icon",P.id="countly-feedback-close-icon-"+o._id,P.innerText="x";var O=document.createElement("iframe");if(O.name="countly-feedback-iframe",O.id="countly-feedback-iframe",O.src=h.url+"/feedback?widget_id="+o._id+"&app_key="+h.app_key+"&device_id="+h.device_id+"&sdk_version="+c,document.body.appendChild(I),I.appendChild(P),I.appendChild(O),ie(document.getElementById("countly-feedback-close-icon-"+o._id),"click",function(){document.getElementById("countly-iframe-wrapper-"+o._id).style.display="none",document.getElementById("cfbg").style.display="none"}),u){var U=document.createElementNS("http://www.w3.org/2000/svg","svg");U.id="feedback-sticker-svg",U.setAttribute("aria-hidden","true"),U.setAttribute("data-prefix","far"),U.setAttribute("data-icon","grin"),U.setAttribute("class","svg-inline--fa fa-grin fa-w-16"),U.setAttribute("role","img"),U.setAttribute("xmlns","http://www.w3.org/2000/svg"),U.setAttribute("viewBox","0 0 496 512");var R=document.createElementNS("http://www.w3.org/2000/svg","path");R.id="smileyPathInStickerSvg",R.setAttribute("fill","white"),R.setAttribute("d","M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 448c-110.3 0-200-89.7-200-200S137.7 56 248 56s200 89.7 200 200-89.7 200-200 200zm105.6-151.4c-25.9 8.3-64.4 13.1-105.6 13.1s-79.6-4.8-105.6-13.1c-9.9-3.1-19.4 5.4-17.7 15.3 7.9 47.1 71.3 80 123.3 80s115.3-32.9 123.3-80c1.6-9.8-7.7-18.4-17.7-15.3zM168 240c17.7 0 32-14.3 32-32s-14.3-32-32-32-32 14.3-32 32 14.3 32 32 32zm160 0c17.7 0 32-14.3 32-32s-14.3-32-32-32-32 14.3-32 32 14.3 32 32 32z");var j=document.createElement("span");j.innerText=o.trigger_button_text;var H=document.createElement("div");H.style.color=o.trigger_font_color.length<7?"#"+o.trigger_font_color:o.trigger_font_color,H.style.backgroundColor=o.trigger_bg_color.length<7?"#"+o.trigger_bg_color:o.trigger_bg_color,H.className="countly-feedback-sticker  "+o.trigger_position+"-"+o.trigger_size,H.id="countly-feedback-sticker-"+o._id,U.appendChild(R),H.appendChild(U),H.appendChild(j),document.body.appendChild(H);var ee=document.getElementById("smileyPathInStickerSvg");ee&&(ee.style.fill=o.trigger_font_color.length<7?"#"+o.trigger_font_color:o.trigger_font_color),ie(document.getElementById("countly-feedback-sticker-"+o._id),"click",function(){document.getElementById("countly-iframe-wrapper-"+o._id).style.display="block",document.getElementById("cfbg").style.display="block"})}else document.getElementById("countly-iframe-wrapper-"+o._id).style.display="block",document.getElementById("cfbg").style.display="block"}catch(ye){l(r.ERROR,"Somethings went wrong while element injecting process: "+ye)}}function yn(){var o;if(typeof h.onload<"u"&&h.onload.length>0){for(o=0;o<h.onload.length;o++)typeof h.onload[o]=="function"&&h.onload[o](h);h.onload=[]}}function Li(){if(We){var o={name:We};h.check_consent(t.VIEWS)&&(Xe({key:n.VIEW,dur:bt?A()-Fe:vt,segmentation:o},ht),We=null)}}function _r(){return We}function wn(){if(fe){var o=le("cly_session");(!o||parseInt(o)<=A())&&(X=!1,h.begin_session(!nt)),se("cly_session",A()+Se*60)}}function ei(o){o.app_key=h.app_key,o.device_id=h.device_id,o.sdk_name=b,o.sdk_version=c,o.t=Ee;var u=_n();if(!o.metrics)o.metrics=JSON.stringify({_ua:u});else{var y=JSON.parse(o.metrics);y._ua||(y._ua=u,o.metrics=JSON.stringify(y))}h.check_consent(t.LOCATION)?(h.country_code&&(o.country_code=h.country_code),h.city&&(o.city=h.city),h.ip_address!==null&&(o.ip_address=h.ip_address)):o.location="",o.timestamp=W();var I=new Date;o.hour=I.getHours(),o.dow=I.getDay()}function Me(o){if(h.ignore_visitor){l(r.WARNING,"User is opt_out will ignore the request: "+o);return}if(!h.app_key||!h.device_id){l(r.ERROR,"app_key or device_id is missing ",h.app_key,h.device_id);return}ei(o),de.length>Ne&&de.shift(),de.push(o),se("cly_queue",de,!0)}function ti(){if(yn(),h.ignore_visitor){pe=!1,l(r.WARNING,"User opt_out, no heartbeat");return}pe=!0;var o=0;if(J&&typeof e.q<"u"&&e.q.length>0){var u,y=e.q;for(e.q=[],o=0;o<y.length;o++)if(u=y[o],l(r.DEBUG,"Processing queued call",u),typeof u=="function")u();else if(Array.isArray(u)&&u.length>0){var I=h,P=0;if(e.i[u[P]]&&(I=e.i[u[P]],P++),typeof I[u[P]]=="function")I[u[P]].apply(I,u.slice(P+1));else if(u[P].indexOf("userData.")===0){var O=u[P].replace("userData.","");typeof I.userData[O]=="function"&&I.userData[O].apply(I,u.slice(P+1))}else typeof e[u[P]]=="function"&&e[u[P]].apply(e,u.slice(P+1))}}if(X&&nt&&bt){var U=A();U-xe>k&&(h.session_duration(U-xe),xe=U)}if(Ie.length>0&&!h.test_mode_eq){if(Ie.length<=T)Me({events:JSON.stringify(Ie)}),Ie=[];else{var R=Ie.splice(0,T);Me({events:JSON.stringify(R)})}se("cly_event",Ie)}if(!oe&&de.length>0&&ge&&A()>i){ge=!1;var j=de[0];l(r.DEBUG,"Processing request",j),se("cly_queue",de,!0),h.test_mode||dt("send_request_queue",h.url+we,j,function(H,ee){l(r.DEBUG,"Request Finished",ee,H),H?(i=A()+s,l(r.ERROR,"Request error: ",H)):de.shift(),se("cly_queue",de,!0),ge=!0},!1)}setTimeout(ti,Ue)}function Ui(){var o=le("cly_id");return o?(Ee=le("cly_id_type"),o):F()}function vr(o){return/[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-4[0-9a-fA-F]{3}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}/.test(o)}function _n(){return h.metrics._ua||Pe()}function ii(){var o=JSON.parse(JSON.stringify(h.metrics||{}));if(o._app_version=o._app_version||h.app_version,o._ua=o._ua||Pe(),screen.width){var u=screen.width?parseInt(screen.width):0,y=screen.height?parseInt(screen.height):0;if(u!==0&&y!==0){var I=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);if(I&&window.devicePixelRatio)u=Math.round(u*window.devicePixelRatio),y=Math.round(y*window.devicePixelRatio);else if(Math.abs(window.orientation)===90){var P=u;u=y,y=P}o._resolution=o._resolution||""+u+"x"+y}}window.devicePixelRatio&&(o._density=o._density||window.devicePixelRatio);var O=navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage;if(typeof O<"u"&&(o._locale=o._locale||O),typeof document.referrer<"u"&&document.referrer.length){var U=D.exec(document.referrer);if(U&&U[11]&&U[11]!==window.location.hostname){var R=!1;if(He&&He.length)for(var j=0;j<He.length;j++)try{var H=new RegExp(He[j]);if(H.test(document.referrer)){l(r.DEBUG,"Ignored: "+document.referrer),R=!0;break}}catch(ee){l(r.ERROR,"Problem with ignoring: "+He[j],", error: "+ee)}R||(o._store=o._store||document.referrer)}}return l(r.DEBUG,"Got metrics",o),o}function l(o,u){if(h.debug&&typeof console<"u"){arguments[2]&&typeof arguments[2]=="object"&&(arguments[2]=JSON.stringify(arguments[2])),J||(u="["+h.app_key+"] "+u),o||(o=r.DEBUG);for(var y="",I=2;I<arguments.length;I++)y+=arguments[I];var P=o+u+y;o===r.ERROR?console.error(P):o===r.WARNING?console.warn(P):o===r.INFO?console.info(P):o===r.VERBOSE?console.log(P):console.debug(P)}}function dt(o,u,y,I,P){P=P||!1;try{l(r.DEBUG,"Sending XML HTTP request");var O=null;window.XMLHttpRequest?O=new window.XMLHttpRequest:window.ActiveXObject&&(O=new window.ActiveXObject("Microsoft.XMLHTTP")),y=y||{};var U=$(y),R="GET";(h.force_post||U.length>=2e3)&&(R="POST"),R==="GET"?O.open("GET",u+"?"+U,!0):(O.open("POST",u,!0),O.setRequestHeader("Content-type","application/x-www-form-urlencoded"));for(var j in h.headers)O.setRequestHeader(j,h.headers[j]);O.onreadystatechange=function(){if(this.readyState===4){l(r.DEBUG,o+" HTTP request completed ["+this.status+"]["+this.responseText+"]");var H;P?H=bn(this.status,this.responseText):H=vn(this.status,this.responseText),H?typeof I=="function"&&I(!1,y,this.responseText):(l(r.ERROR,o+" Failed Server XML HTTP request, ",this.status),typeof I=="function"&&I(!0,y))}},R==="GET"?O.send():O.send(U)}catch(H){l(r.ERROR,o+" Failed XML HTTP request: "+H),typeof I=="function"&&I(!0,y)}}function vn(o,u){if(!(o>=200&&o<300))return l(r.ERROR,"Http response status code is not within the expected range:["+o+"]"),!1;try{var y=JSON.parse(u);return Object.prototype.toString.call(y)!=="[object Object]"?(l(r.ERROR,"Http response is not JSON Object"),!1):!!y.result}catch(I){return l(r.ERROR,"Http response is not JSON: "+I),!1}}function bn(o,u){if(!(o>=200&&o<300))return l(r.ERROR,"Http response status code is not within the expected range: "+o),!1;try{var y=JSON.parse(u);return Object.prototype.toString.call(y)!=="[object Object]"&&!Array.isArray(y)?(l(r.ERROR,"Http response is not JSON Object nor JSON Array"),!1):!0}catch(I){return l(r.ERROR,"Http response is not JSON: "+I),!1}}function En(){Vt=Math.max(Vt,window.scrollY,document.body.scrollTop,document.documentElement.scrollTop)}function Ci(){if($t){$t=!1;var o=z(),u=Z(),y=te();if(h.check_consent(t.SCROLLS)){var I={type:"scroll",y:Vt+y,width:u,height:o,view:h.getViewUrl()};I=x(I,h.maxKeyLength,h.maxValueSize,h.maxSegmentationValues,"processScrollView",l),h.track_domains&&(I.domain=window.location.hostname),Xe({key:n.ACTION,segmentation:I})}}}function br(){return Ee}function kn(o){se("cly_token",o)}function Er(){var o=le("cly_token");return ot("cly_token"),o}function kr(){return Ie}function Sr(){return de}function Rr(o){for(var u=o+"=",y=document.cookie.split(";"),I=0,P=y.length;I<P;I++){for(var O=y[I];O.charAt(0)===" ";)O=O.substring(1,O.length);if(O.indexOf(u)===0)return O.substring(u.length,O.length)}return null}function Sn(o,u,y){var I=new Date;I.setTime(I.getTime()+y*24*60*60*1e3);var P="; expires="+I.toGMTString();document.cookie=o+"="+u+P+"; path=/"}function le(o,u,y){if(h.storage==="none"){l(r.WARNING,"Storage is disabled. Value with key: "+o+" won't be retrieved");return}y||(o=h.app_key+"/"+o,h.namespace&&(o=ne(h.namespace)+"/"+o)),u===void 0&&(u=Et);var I;return u?I=localStorage.getItem(o):h.storage!=="localstorage"&&(I=Rr(o)),h.deserialize(I)}function se(o,u,y,I){if(h.storage==="none"){l(r.WARNING,"Storage is disabled. Value with key: "+o+" won't be stored");return}I||(o=h.app_key+"/"+o,h.namespace&&(o=ne(h.namespace)+"/"+o)),y===void 0&&(y=Et),typeof u<"u"&&u!==null&&(u=h.serialize(u),y?localStorage.setItem(o,u):h.storage!=="localstorage"&&Sn(o,u,30))}function ot(o,u,y){if(h.storage==="none"){l(r.WARNING,"Storage is disabled. Value with key: "+o+" won't be removed");return}y||(o=h.app_key+"/"+o,h.namespace&&(o=ne(h.namespace)+"/"+o)),u===void 0&&(u=Et),u?localStorage.removeItem(o):h.storage!=="localstorage"&&Sn(o,"",-1)}function Ir(){if(le(h.namespace+"cly_id",!1,!0)){se("cly_id",le(h.namespace+"cly_id",!1,!0)),se("cly_id_type",le(h.namespace+"cly_id_type",!1,!0)),se("cly_event",le(h.namespace+"cly_event",!1,!0)),se("cly_session",le(h.namespace+"cly_session",!1,!0));var o=le(h.namespace+"cly_queue",!1,!0);Array.isArray(o)&&(o=o.filter(function(u){return u.app_key===h.app_key}),se("cly_queue",o)),le(h.namespace+"cly_cmp_id",!1,!0)&&(se("cly_cmp_id",le(h.namespace+"cly_cmp_id",!1,!0)),se("cly_cmp_uid",le(h.namespace+"cly_cmp_uid",!1,!0))),le(h.namespace+"cly_ignore",!1,!0)&&se("cly_ignore",le(h.namespace+"cly_ignore",!1,!0)),ot("cly_id",!1,!0),ot("cly_id_type",!1,!0),ot("cly_event",!1,!0),ot("cly_session",!1,!0),ot("cly_queue",!1,!0),ot("cly_cmp_id",!1,!0),ot("cly_cmp_uid",!1,!0),ot("cly_ignore",!1,!0)}}this.onStorageChange=function(o,u){switch(l(r.INFO,"onStorageChange, Applying storage changes"),o){case"cly_queue":de=h.deserialize(u||"[]");break;case"cly_event":Ie=h.deserialize(u||"[]");break;case"cly_remote_configs":Te=h.deserialize(u||"{}");break;case"cly_ignore":h.ignore_visitor=h.deserialize(u);break;case"cly_id":h.device_id=h.deserialize(u);break;case"cly_id_type":Ee=h.deserialize(u);break;default:}},this._internals={store:se,getDocWidth:Z,getDocHeight:z,getViewportHeight:te,get_page_coord:E,get_event_target:ae,add_event:ie,createNewObjectFromProperties:re,truncateObject:x,truncateSingleValue:q,stripTrailingSlash:ne,prepareParams:$,sendXmlHttpRequest:dt,isResponseValid:vn,getInternalDeviceIdType:br,getMsTimestamp:W,getTimestamp:A,isResponseValidBroad:bn,secureRandom:L,log:l,getMetrics:ii,getUA:_n,prepareRequest:ei,generateUUID:F,sendEventsForced:Bt,isUUID:vr,getId:Ui,heartBeat:ti,toRequestQueue:Me,reportViewDuration:Li,loadJS:_e,loadCSS:be,getLastView:_r,setToken:kn,getToken:Er,showLoader:it,hideLoader:zt,setValueInStorage:se,getValueFromStorage:le,removeValueFromStorage:ot,add_cly_events:Xe,processScrollView:Ci,processScroll:En,currentUserAgentString:Pe,userAgentDeviceDetection:Le,userAgentSearchBotDetection:d,getRequestQueue:Sr,getEventQueue:kr,clearQueue:function(){de=[],se("cly_queue",[]),Ie=[],se("cly_event",[])}},this.initialize()};e.CountlyClass=w,e.init=function(m){m=m||{};var h=m.app_key||e.app_key;if(!e.i||!e.i[h]){var J=new e.CountlyClass(m);if(!e.i){e.i={};for(var X in J)e[X]=J[X]}e.i[h]=J}return e.i[h]};function N(m){var h=[];if(typeof m.options<"u")for(var J=0;J<m.options.length;J++)m.options[J].selected&&h.push(m.options[J].value);return h.join(", ")}function L(){var m="xxxxxxxx";m=S(m,"[x]");var h=Date.now().toString();return m+h}function F(){var m="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";return m=S(m,"[xy]"),m}function S(m,h){var J=new Date().getTime(),X=new RegExp(h,"g");return m.replace(X,function(we){var Oe=(J+Math.random()*16)%16|0;return(we==="x"?Oe:Oe&3|8).toString(16)})}function A(){return Math.floor(new Date().getTime()/1e3)}var G=0;function W(){var m=new Date().getTime();return G>=m?G++:G=m,G}function B(m,h,J){if(h&&Object.keys(h).length){if(typeof h[m]<"u")return h[m]}else if(typeof e[m]<"u")return e[m];return J}function Q(m,h,J){for(var X in e.i)e.i[X].tracking_crashes&&e.i[X].recordError(m,h,J)}function $(m){var h=[];for(var J in m)h.push(J+"="+encodeURIComponent(m[J]));return h.join("&")}function ne(m){return typeof m=="string"&&m.substring(m.length-1)==="/"?m.substring(0,m.length-1):m}function re(m,h){for(var J={},X,we=0,Oe=h.length;we<Oe;we++)X=h[we],typeof m[X]<"u"&&(J[X]=m[X]);return J}function Re(m,h,J){if(J){for(var X,we=0,Oe=J.length;we<Oe;we++)X=J[we],typeof h[X]<"u"&&(m[X]=h[X]);return m}}function x(m,h,J,X,we,Oe){var Ue={};if(m){if(Object.keys(m).length>X){var Ne={},de=0;for(var Ie in m)de<X&&(Ne[Ie]=m[Ie],de++);m=Ne}for(var Te in m){var ze=q(Te,h,we,Oe),$e=q(m[Te],J,we,Oe);Ue[ze]=$e}}return Ue}function q(m,h,J,X){var we=m;return typeof m=="number"&&(m=m.toString()),typeof m=="string"&&m.length>h&&(we=m.substring(0,h),X(r.DEBUG,J+", Key: [ "+m+" ] is longer than accepted length. It will be truncated.")),we}var Ge=function(m,h){for(h=h.toUpperCase();m;){if(m.nodeName.toUpperCase()===h)return m;m=m.parentElement}},ie=function(m,h,J){typeof m.addEventListener<"u"?m.addEventListener(h,J,!1):m.attachEvent("on"+h,J)},ae=function(m){return m?typeof m.target<"u"?m.target:m.srcElement:window.event.srcElement};function Pe(m){if(m)return m;var h=navigator.userAgent;return h||navigator.userAgentData&&(h=navigator.userAgentData.brands.map(function(J){return J.brand+":"+J.version}).join(),h+=navigator.userAgentData.mobile?" mobi ":" ",h+=navigator.userAgentData.platform),h}function Le(m){var h;if(m)h=m;else{if(navigator.userAgentData.mobile)return"phone";h=Pe()}h=h.toLowerCase();var J="desktop",X=/(ipad|tablet|(android(?!.*mobile))|(windows(?!.*phone)(.*touch))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/,we=/(mobi|ipod|phone|blackberry|opera mini|fennec|minimo|symbian|psp|nintendo ds|archos|skyfire|puffin|blazer|bolt|gobrowser|iris|maemo|semc|teashark|uzard)/;return X.test(h)?J="tablet":we.test(h)&&(J="phone"),J}function d(m){var h=/(CountlySiteBot|nuhk|Googlebot|GoogleSecurityScanner|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver|bingbot|Google Web Preview|Mediapartners-Google|AdsBot-Google|Baiduspider|Ezooms|YahooSeeker|AltaVista|AVSearch|Mercator|Scooter|InfoSeek|Ultraseek|Lycos|Wget|YandexBot|Yandex|YaDirectFetcher|SiteBot|Exabot|AhrefsBot|MJ12bot|TurnitinBot|magpie-crawler|Nutch Crawler|CMS Crawler|rogerbot|Domnutch|ssearch_bot|XoviBot|netseer|digincore|fr-crawler|wesee|AliasIO|contxbot|PingdomBot|BingPreview|HeadlessChrome)/;return h.test(m||Pe())}function E(m){return typeof m.pageY>"u"&&typeof m.clientX=="number"&&document.documentElement&&(m.pageX=m.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,m.pageY=m.clientY+document.body.scrollTop+document.documentElement.scrollTop),m}function z(){var m=document;return Math.max(Math.max(m.body.scrollHeight,m.documentElement.scrollHeight),Math.max(m.body.offsetHeight,m.documentElement.offsetHeight),Math.max(m.body.clientHeight,m.documentElement.clientHeight))}function Z(){var m=document;return Math.max(Math.max(m.body.scrollWidth,m.documentElement.scrollWidth),Math.max(m.body.offsetWidth,m.documentElement.offsetWidth),Math.max(m.body.clientWidth,m.documentElement.clientWidth))}function te(){var m=document;return Math.min(Math.min(m.body.clientHeight,m.documentElement.clientHeight),Math.min(m.body.offsetHeight,m.documentElement.offsetHeight),window.innerHeight)}function K(){return window.innerWidth>window.innerHeight?"landscape":"portrait"}window.addEventListener("storage",function(m){var h=(m.key+"").split("/"),J=h.pop(),X=h.pop();e.i&&e.i[X]&&e.i[X].onStorageChange(J,m.newValue)});function he(m,h,J,X,we,Oe){var Ue=document.createElement(m),Ne;Ue.setAttribute(h,J),Ue.setAttribute(X,we);var de=function(){Ne||Oe(),Ne=!0};Oe&&(Ue.onreadystatechange=de,Ue.onload=de),document.getElementsByTagName("head")[0].appendChild(Ue)}function _e(m,h){he("script","type","text/javascript","src",m,h)}function be(m,h){he("link","rel","stylesheet","href",m,h)}function it(){var m=document.getElementById("cly-loader");if(!m){var h="#cly-loader {height: 4px; width: 100%; position: absolute; z-index: 99999; overflow: hidden; background-color: #fff; top:0px; left:0px;}#cly-loader:before{display: block; position: absolute; content: ''; left: -200px; width: 200px; height: 4px; background-color: #2EB52B; animation: cly-loading 2s linear infinite;}@keyframes cly-loading { from {left: -200px; width: 30%;} 50% {width: 30%;} 70% {width: 70%;} 80% { left: 50%;} 95% {left: 120%;} to {left: 100%;}}",J=document.head||document.getElementsByTagName("head")[0],X=document.createElement("style");X.type="text/css",X.styleSheet?X.styleSheet.cssText=h:X.appendChild(document.createTextNode(h)),J.appendChild(X),m=document.createElement("div"),m.setAttribute("id","cly-loader"),document.body.onload=function(){if(!e.showLoaderProtection)try{document.body.appendChild(m)}catch{}}}m.style.display="block"}function zt(){e.showLoaderProtection=!0;var m=document.getElementById("cly-loader");m&&(m.style.display="none")}return e.serialize=function(m){return typeof m=="object"&&(m=JSON.stringify(m)),m},e.deserialize=function(m){try{m=JSON.parse(m)}catch{}return m},e.getViewName=function(){return window.location.pathname},e.getViewUrl=function(){return window.location.pathname},e.getSearchQuery=function(){return window.location.search},e.DeviceIdType={DEVELOPER_SUPPLIED:p.DEVELOPER_SUPPLIED,SDK_GENERATED:p.SDK_GENERATED,TEMPORARY_ID:p.TEMPORARY_ID},e})});try{self["workbox:window:7.0.0"]&&_()}catch{}function An(e,t){return new Promise(function(n){var a=new MessageChannel;a.port1.onmessage=function(r){n(r.data)},e.postMessage(t,[a.port2])})}function On(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function xn(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function Ur(e,t){var n;if(typeof Symbol>"u"||e[Symbol.iterator]==null){if(Array.isArray(e)||(n=function(r,p){if(r){if(typeof r=="string")return xn(r,p);var v=Object.prototype.toString.call(r).slice(8,-1);return v==="Object"&&r.constructor&&(v=r.constructor.name),v==="Map"||v==="Set"?Array.from(r):v==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(v)?xn(r,p):void 0}}(e))||t&&e&&typeof e.length=="number"){n&&(e=n);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}return(n=e[Symbol.iterator]()).next.bind(n)}try{self["workbox:core:7.0.0"]&&_()}catch{}var Fi=function(){var e=this;this.promise=new Promise(function(t,n){e.resolve=t,e.reject=n})};function Gi(e,t){var n=location.href;return new URL(e,n).href===new URL(t,n).href}var Ht=function(e,t){this.type=e,Object.assign(this,t)};function oi(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function Cr(){}var Pr={type:"SKIP_WAITING"};function Tn(e,t){if(!t)return e&&e.then?e.then(Cr):Promise.resolve()}var Nn=function(e){var t,n;function a(b,D){var w,N;return D===void 0&&(D={}),(w=e.call(this)||this).nn={},w.tn=0,w.rn=new Fi,w.en=new Fi,w.on=new Fi,w.un=0,w.an=new Set,w.cn=function(){var L=w.fn,F=L.installing;w.tn>0||!Gi(F.scriptURL,w.sn.toString())||performance.now()>w.un+6e4?(w.vn=F,L.removeEventListener("updatefound",w.cn)):(w.hn=F,w.an.add(F),w.rn.resolve(F)),++w.tn,F.addEventListener("statechange",w.ln)},w.ln=function(L){var F=w.fn,S=L.target,A=S.state,G=S===w.vn,W={sw:S,isExternal:G,originalEvent:L};!G&&w.mn&&(W.isUpdate=!0),w.dispatchEvent(new Ht(A,W)),A==="installed"?w.wn=self.setTimeout(function(){A==="installed"&&F.waiting===S&&w.dispatchEvent(new Ht("waiting",W))},200):A==="activating"&&(clearTimeout(w.wn),G||w.en.resolve(S))},w.dn=function(L){var F=w.hn,S=F!==navigator.serviceWorker.controller;w.dispatchEvent(new Ht("controlling",{isExternal:S,originalEvent:L,sw:F,isUpdate:w.mn})),S||w.on.resolve(F)},w.gn=(N=function(L){var F=L.data,S=L.ports,A=L.source;return oi(w.getSW(),function(){w.an.has(A)&&w.dispatchEvent(new Ht("message",{data:F,originalEvent:L,ports:S,sw:A}))})},function(){for(var L=[],F=0;F<arguments.length;F++)L[F]=arguments[F];try{return Promise.resolve(N.apply(this,L))}catch(S){return Promise.reject(S)}}),w.sn=b,w.nn=D,navigator.serviceWorker.addEventListener("message",w.gn),w}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,p,v,c=a.prototype;return c.register=function(b){var D=(b===void 0?{}:b).immediate,w=D!==void 0&&D;try{var N=this;return function(L,F){var S=L();return S&&S.then?S.then(F):F(S)}(function(){if(!w&&document.readyState!=="complete")return Tn(new Promise(function(L){return window.addEventListener("load",L)}))},function(){return N.mn=Boolean(navigator.serviceWorker.controller),N.yn=N.pn(),oi(N.bn(),function(L){N.fn=L,N.yn&&(N.hn=N.yn,N.en.resolve(N.yn),N.on.resolve(N.yn),N.yn.addEventListener("statechange",N.ln,{once:!0}));var F=N.fn.waiting;return F&&Gi(F.scriptURL,N.sn.toString())&&(N.hn=F,Promise.resolve().then(function(){N.dispatchEvent(new Ht("waiting",{sw:F,wasWaitingBeforeRegister:!0}))}).then(function(){})),N.hn&&(N.rn.resolve(N.hn),N.an.add(N.hn)),N.fn.addEventListener("updatefound",N.cn),navigator.serviceWorker.addEventListener("controllerchange",N.dn),N.fn})})}catch(L){return Promise.reject(L)}},c.update=function(){try{return this.fn?Tn(this.fn.update()):void 0}catch(b){return Promise.reject(b)}},c.getSW=function(){return this.hn!==void 0?Promise.resolve(this.hn):this.rn.promise},c.messageSW=function(b){try{return oi(this.getSW(),function(D){return An(D,b)})}catch(D){return Promise.reject(D)}},c.messageSkipWaiting=function(){this.fn&&this.fn.waiting&&An(this.fn.waiting,Pr)},c.pn=function(){var b=navigator.serviceWorker.controller;return b&&Gi(b.scriptURL,this.sn.toString())?b:void 0},c.bn=function(){try{var b=this;return function(D,w){try{var N=D()}catch(L){return w(L)}return N&&N.then?N.then(void 0,w):N}(function(){return oi(navigator.serviceWorker.register(b.sn,b.nn),function(D){return b.un=performance.now(),D})},function(D){throw D})}catch(D){return Promise.reject(D)}},r=a,(p=[{key:"active",get:function(){return this.en.promise}},{key:"controlling",get:function(){return this.on.promise}}])&&On(r.prototype,p),v&&On(r,v),a}(function(){function e(){this.Pn=new Map}var t=e.prototype;return t.addEventListener=function(n,a){this.Sn(n).add(a)},t.removeEventListener=function(n,a){this.Sn(n).delete(a)},t.dispatchEvent=function(n){n.target=this;for(var a,r=Ur(this.Sn(n.type));!(a=r()).done;)(0,a.value)(n)},t.Sn=function(n){return this.Pn.has(n)||this.Pn.set(n,new Set),this.Pn.get(n)},e}());function Mr(){var e=Object.create(null);e.ftp=21,e.file=0,e.gopher=70,e.http=80,e.https=443,e.ws=80,e.wss=443;var t=Object.create(null);t["%2e"]=".",t[".%2e"]="..",t["%2e."]="..",t["%2e%2e"]="..";function n(S){return e[S]!==void 0}function a(){N.call(this),this._isInvalid=!0}function r(S){return S==""&&a.call(this),S.toLowerCase()}function p(S){var A=S.charCodeAt(0);return A>32&&A<127&&[34,35,60,62,63,96].indexOf(A)==-1?S:encodeURIComponent(S)}function v(S){var A=S.charCodeAt(0);return A>32&&A<127&&[34,35,60,62,96].indexOf(A)==-1?S:encodeURIComponent(S)}var c=void 0,b=/[a-zA-Z]/,D=/[a-zA-Z0-9\+\-\.]/;function w(S,A,G){function W(E){Re.push(E)}var B=A||"scheme start",Q=0,$="",ne=!1,re=!1,Re=[];e:for(;(S[Q-1]!=c||Q==0)&&!this._isInvalid;){var x=S[Q];switch(B){case"scheme start":if(x&&b.test(x))$+=x.toLowerCase(),B="scheme";else if(A){W("Invalid scheme.");break e}else{$="",B="no scheme";continue}break;case"scheme":if(x&&D.test(x))$+=x.toLowerCase();else if(x==":"){if(this._scheme=$,$="",A)break e;n(this._scheme)&&(this._isRelative=!0),this._scheme=="file"?B="relative":this._isRelative&&G&&G._scheme==this._scheme?B="relative or authority":this._isRelative?B="authority first slash":B="scheme data"}else if(A){if(c==x)break e;W("Code point not allowed in scheme: "+x);break e}else{$="",Q=0,B="no scheme";continue}break;case"scheme data":x=="?"?(this._query="?",B="query"):x=="#"?(this._fragment="#",B="fragment"):c!=x&&x!="	"&&x!=`
`&&x!="\r"&&(this._schemeData+=p(x));break;case"no scheme":if(!G||!n(G._scheme))W("Missing scheme."),a.call(this);else{B="relative";continue}break;case"relative or authority":if(x=="/"&&S[Q+1]=="/")B="authority ignore slashes";else{W("Expected /, got: "+x),B="relative";continue}break;case"relative":if(this._isRelative=!0,this._scheme!="file"&&(this._scheme=G._scheme),c==x){this._host=G._host,this._port=G._port,this._path=G._path.slice(),this._query=G._query,this._username=G._username,this._password=G._password;break e}else if(x=="/"||x=="\\")x=="\\"&&W("\\ is an invalid code point."),B="relative slash";else if(x=="?")this._host=G._host,this._port=G._port,this._path=G._path.slice(),this._query="?",this._username=G._username,this._password=G._password,B="query";else if(x=="#")this._host=G._host,this._port=G._port,this._path=G._path.slice(),this._query=G._query,this._fragment="#",this._username=G._username,this._password=G._password,B="fragment";else{var q=S[Q+1],Ge=S[Q+2];(this._scheme!="file"||!b.test(x)||q!=":"&&q!="|"||c!=Ge&&Ge!="/"&&Ge!="\\"&&Ge!="?"&&Ge!="#")&&(this._host=G._host,this._port=G._port,this._username=G._username,this._password=G._password,this._path=G._path.slice(),this._path.pop()),B="relative path";continue}break;case"relative slash":if(x=="/"||x=="\\")x=="\\"&&W("\\ is an invalid code point."),this._scheme=="file"?B="file host":B="authority ignore slashes";else{this._scheme!="file"&&(this._host=G._host,this._port=G._port,this._username=G._username,this._password=G._password),B="relative path";continue}break;case"authority first slash":if(x=="/")B="authority second slash";else{W("Expected '/', got: "+x),B="authority ignore slashes";continue}break;case"authority second slash":if(B="authority ignore slashes",x!="/"){W("Expected '/', got: "+x);continue}break;case"authority ignore slashes":if(x!="/"&&x!="\\"){B="authority";continue}else W("Expected authority, got: "+x);break;case"authority":if(x=="@"){ne&&(W("@ already seen."),$+="%40"),ne=!0;for(var ie=0;ie<$.length;ie++){var ae=$[ie];if(ae=="	"||ae==`
`||ae=="\r"){W("Invalid whitespace in authority.");continue}if(ae==":"&&this._password===null){this._password="";continue}var Pe=p(ae);this._password!==null?this._password+=Pe:this._username+=Pe}$=""}else if(c==x||x=="/"||x=="\\"||x=="?"||x=="#"){Q-=$.length,$="",B="host";continue}else $+=x;break;case"file host":if(c==x||x=="/"||x=="\\"||x=="?"||x=="#"){$.length==2&&b.test($[0])&&($[1]==":"||$[1]=="|")?B="relative path":($.length==0||(this._host=r.call(this,$),$=""),B="relative path start");continue}else x=="	"||x==`
`||x=="\r"?W("Invalid whitespace in file host."):$+=x;break;case"host":case"hostname":if(x==":"&&!re){if(this._host=r.call(this,$),$="",B="port",A=="hostname")break e}else if(c==x||x=="/"||x=="\\"||x=="?"||x=="#"){if(this._host=r.call(this,$),$="",B="relative path start",A)break e;continue}else x!="	"&&x!=`
`&&x!="\r"?(x=="["?re=!0:x=="]"&&(re=!1),$+=x):W("Invalid code point in host/hostname: "+x);break;case"port":if(/[0-9]/.test(x))$+=x;else if(c==x||x=="/"||x=="\\"||x=="?"||x=="#"||A){if($!=""){var Le=parseInt($,10);Le!=e[this._scheme]&&(this._port=Le+""),$=""}if(A)break e;B="relative path start";continue}else x=="	"||x==`
`||x=="\r"?W("Invalid code point in port: "+x):a.call(this);break;case"relative path start":if(x=="\\"&&W("'\\' not allowed in path."),B="relative path",x!="/"&&x!="\\")continue;break;case"relative path":if(c==x||x=="/"||x=="\\"||!A&&(x=="?"||x=="#")){x=="\\"&&W("\\ not allowed in relative path.");var d;(d=t[$.toLowerCase()])&&($=d),$==".."?(this._path.pop(),x!="/"&&x!="\\"&&this._path.push("")):$=="."&&x!="/"&&x!="\\"?this._path.push(""):$!="."&&(this._scheme=="file"&&this._path.length==0&&$.length==2&&b.test($[0])&&$[1]=="|"&&($=$[0]+":"),this._path.push($)),$="",x=="?"?(this._query="?",B="query"):x=="#"&&(this._fragment="#",B="fragment")}else x!="	"&&x!=`
`&&x!="\r"&&($+=p(x));break;case"query":!A&&x=="#"?(this._fragment="#",B="fragment"):c!=x&&x!="	"&&x!=`
`&&x!="\r"&&(this._query+=v(x));break;case"fragment":c!=x&&x!="	"&&x!=`
`&&x!="\r"&&(this._fragment+=x);break}Q++}}function N(){this._scheme="",this._schemeData="",this._username="",this._password=null,this._host="",this._port="",this._path=[],this._query="",this._fragment="",this._isInvalid=!1,this._isRelative=!1}function L(S,A){A!==void 0&&!(A instanceof L)&&(A=new L(String(A))),S=String(S),this._url=S,N.call(this);var G=S.replace(/^[ \t\r\n\f]+|[ \t\r\n\f]+$/g,"");w.call(this,G,null,A)}L.prototype={toString:function(){return this.href},get href(){if(this._isInvalid)return this._url;var S="";return(this._username!=""||this._password!=null)&&(S=this._username+(this._password!=null?":"+this._password:"")+"@"),this.protocol+(this._isRelative?"//"+S+this.host:"")+this.pathname+this._query+this._fragment},set href(S){N.call(this),w.call(this,S)},get protocol(){return this._scheme+":"},set protocol(S){this._isInvalid||w.call(this,S+":","scheme start")},get host(){return this._isInvalid?"":this._port?this._host+":"+this._port:this._host},set host(S){this._isInvalid||!this._isRelative||w.call(this,S,"host")},get hostname(){return this._host},set hostname(S){this._isInvalid||!this._isRelative||w.call(this,S,"hostname")},get port(){return this._port},set port(S){this._isInvalid||!this._isRelative||w.call(this,S,"port")},get pathname(){return this._isInvalid?"":this._isRelative?"/"+this._path.join("/"):this._schemeData},set pathname(S){this._isInvalid||!this._isRelative||(this._path=[],w.call(this,S,"relative path start"))},get search(){return this._isInvalid||!this._query||this._query=="?"?"":this._query},set search(S){this._isInvalid||!this._isRelative||(this._query="?",S[0]=="?"&&(S=S.slice(1)),w.call(this,S,"query"))},get hash(){return this._isInvalid||!this._fragment||this._fragment=="#"?"":this._fragment},set hash(S){this._isInvalid||(this._fragment="#",S[0]=="#"&&(S=S.slice(1)),w.call(this,S,"fragment"))},get origin(){var S;if(this._isInvalid||!this._scheme)return"";switch(this._scheme){case"data":case"file":case"javascript":case"mailto":return"null"}return S=this.host,S?this._scheme+"://"+S:""}};var F=self.URL;return F&&(L.createObjectURL=function(S){return F.createObjectURL.apply(F,arguments)},L.revokeObjectURL=function(S){F.revokeObjectURL(S)}),L}var Ze=Mr();var Un=ri(si());var et=class{element;constructor(t="div",n=void 0,a="\u{1F551}"){let r=document.createElement(t);this.element=r,n!=null&&(this.className=n),this.textContent=a}static fromElement(t){let n=new et("div");return n.element=t,n}asterisk(){this.textContent="*"}lose(){this.textContent="\u274C"}win(t){if(t!=null){this.textContent="";let n=document.createElement("a");n.href=t,n.target="_blank",n.textContent="\u2705",this.element.title=t,this.element.appendChild(n)}else this.textContent="\u2705"}global(){this.textContent="\u{1F30D}"}err(){this.textContent="\u26A0\uFE0F"}empty(){this.textContent=""}get style(){return this.element.style}append(t){t instanceof et&&(t=t.element),this.element.append(t)}get classList(){return this.element.classList}set title(t){this.element.title=t}set className(t){this.element.className=t}set textContent(t){this.element.textContent=t}};var Ke=class{constructor(t,...n){this.parent=t;this.tag=new et(...n)}tag};var pt=class extends Ke{constructor(n,...a){super(n,...a);this.parent=n}_className="Not-set";_tagName="Not-set";get className(){return this._className}get tagName(){return this._tagName}check(){}checked(){}onerror(){this.tag.err()}};var Ae=class{constructor(t){this.namespace=t}log(t,...n){let[a,...r]=n,p=this.namespace!=null?`${this.namespace}.${t}: `:"";console[t](`${p}${a}`,...r)}debug(...t){this.log("debug",...t)}info(...t){this.log("info",...t)}warn(...t){this.log("warn",...t)}error(...t){this.log("error",...t)}};var Dn="Hello from IPFS Gateway Checker",lt="bafybeifx7yeb55armcsxwwitkymga5xf53dxiarykms3ygqic223w5sk3m",gt="bafybeibwzifw52ttrkqlikfzext5akxu7lz4xiwjgwzmqcpdzmp3n5vnbe",Bn="/ipns/en.wikipedia-on-ipfs.org/favicon.ico",$i=["raw","car"],Ln="https://ipfs.io";var{fetch:Fr}=(0,Un.default)(),Vi=new Ae("Cors"),ai=class extends pt{constructor(n){super(n,"div","Cors");this.parent=n}_className="Cors";_tagName="div";async check(){let n=Date.now(),r=`${this.parent.gateway.replace(":hash",lt)}?now=${n}#x-ipfs-companion-no-redirect`;try{let p=await Fr(r),{status:v}=p,c=await p.text();if(this.tag.title=`Response code: ${v}`,Dn===c.trim())this.tag.asterisk(),this.parent.tag.classList.add("cors");else throw Vi.debug("The response text did not match the expected string"),this.onerror(),new Error(`URL '${r} does not support CORS`)}catch(p){throw Vi.error(p),this.onerror(),p}}checked(){Vi.warn("Not implemented yet")}onerror(){this.tag.empty()}};var St=class{constructor({tokensPerInterval:t,interval:n,stopped:a}){if(this.tokensPerInterval=t,this._isStopped=a,typeof n=="string")switch(n){case"sec":case"second":{this.interval=1e3;break}case"min":case"minute":{this.interval=1e3*60;break}case"hr":case"hour":{this.interval=1e3*60*60;break}case"day":{this.interval=1e3*60*60*24;break}default:throw new Error("Invalid interval "+n)}else this.interval=n;this.tokensRemovedAt=[],this.awaitingRestart=new Set}dripTokens(){throw new Error("dripTokens() not implemented")}getDelayForTokens(){throw new Error("getDelayForTokens() not implemented")}getTokens(){return this.dripTokens(),Math.floor(this.tokens)}tryRemoveTokens(t){return this.dripTokens(),t>this.tokens?!1:(this.tokens-=t,this.tokensRemovedAt.push([Date.now(),t]),!0)}async awaitTokens(t=1){this._isStopped&&await new Promise(a=>this.awaitingRestart.add(a));let n=this.getDelayForTokens(t);return n===0?Math.floor(this.tokens):(await new Promise(a=>setTimeout(()=>a(),n)),this.awaitTokens(t))}reset(){this.awaitingRestart.forEach(t=>t())}stop(t=!0){this._isStopped=!0,t&&this.tryRemoveTokens(this.getTokens())}start(){this._isStopped=!1}get isStopped(){return this._isStopped}};var Lt=class extends St{constructor({bucketSize:t,tokensPerInterval:n,interval:a,stopped:r=!1}){super({tokensPerInterval:n,interval:a,stopped:r}),this.bucketSize=t,this.tokens=r?0:this.bucketSize,this.tokensRemovedAt=r?[0]:[Date.now()]}dripTokens(){if(this._isStopped)return;let t=Date.now(),n=this.tokensRemovedAt[0],a=Math.max(t-n,0);this.tokensRemovedAt=[t];let r=a*(this.tokensPerInterval/this.interval);return this.tokens=Math.min(this.tokens+r,this.bucketSize),Math.floor(this.tokens)}getDelayForTokens(t=1){if(t>this.bucketSize)throw new Error(`Cannot supply ${t} tokens at once (max is bucketSize = ${this.bucketSize}`);this.dripTokens();let n=t-this.tokens;if(n<=0)return 0;if(!this._isStopped)return Math.ceil(n*(this.interval/this.tokensPerInterval))}reset(){this._isStopped=!1,this.tokens=this.bucketSize,this.tokensRemovedAt=[Date.now()],super.reset()}};var Gr=Object.create,Vn=Object.defineProperty,zr=Object.getOwnPropertyDescriptor,$r=Object.getOwnPropertyNames,Vr=Object.getPrototypeOf,jr=Object.prototype.hasOwnProperty,Ut=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Hr=(e,t,n,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of $r(t))!jr.call(e,r)&&r!==n&&Vn(e,r,{get:()=>t[r],enumerable:!(a=zr(t,r))||a.enumerable});return e},jn=(e,t,n)=>(n=e!=null?Gr(Vr(e)):{},Hr(t||!e||!e.__esModule?Vn(n,"default",{value:e,enumerable:!0}):n,e)),Wr=Ut(e=>{"use strict";e.byteLength=b,e.toByteArray=w,e.fromByteArray=F;var t=[],n=[],a=typeof Uint8Array<"u"?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(p=0,v=r.length;p<v;++p)t[p]=r[p],n[r.charCodeAt(p)]=p;var p,v;n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63;function c(S){var A=S.length;if(A%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var G=S.indexOf("=");G===-1&&(G=A);var W=G===A?0:4-G%4;return[G,W]}function b(S){var A=c(S),G=A[0],W=A[1];return(G+W)*3/4-W}function D(S,A,G){return(A+G)*3/4-G}function w(S){var A,G=c(S),W=G[0],B=G[1],Q=new a(D(S,W,B)),$=0,ne=B>0?W-4:W,re;for(re=0;re<ne;re+=4)A=n[S.charCodeAt(re)]<<18|n[S.charCodeAt(re+1)]<<12|n[S.charCodeAt(re+2)]<<6|n[S.charCodeAt(re+3)],Q[$++]=A>>16&255,Q[$++]=A>>8&255,Q[$++]=A&255;return B===2&&(A=n[S.charCodeAt(re)]<<2|n[S.charCodeAt(re+1)]>>4,Q[$++]=A&255),B===1&&(A=n[S.charCodeAt(re)]<<10|n[S.charCodeAt(re+1)]<<4|n[S.charCodeAt(re+2)]>>2,Q[$++]=A>>8&255,Q[$++]=A&255),Q}function N(S){return t[S>>18&63]+t[S>>12&63]+t[S>>6&63]+t[S&63]}function L(S,A,G){for(var W,B=[],Q=A;Q<G;Q+=3)W=(S[Q]<<16&16711680)+(S[Q+1]<<8&65280)+(S[Q+2]&255),B.push(N(W));return B.join("")}function F(S){for(var A,G=S.length,W=G%3,B=[],Q=16383,$=0,ne=G-W;$<ne;$+=Q)B.push(L(S,$,$+Q>ne?ne:$+Q));return W===1?(A=S[G-1],B.push(t[A>>2]+t[A<<4&63]+"==")):W===2&&(A=(S[G-2]<<8)+S[G-1],B.push(t[A>>10]+t[A>>4&63]+t[A<<2&63]+"=")),B.join("")}}),qr=Ut(e=>{e.read=function(t,n,a,r,p){var v,c,b=p*8-r-1,D=(1<<b)-1,w=D>>1,N=-7,L=a?p-1:0,F=a?-1:1,S=t[n+L];for(L+=F,v=S&(1<<-N)-1,S>>=-N,N+=b;N>0;v=v*256+t[n+L],L+=F,N-=8);for(c=v&(1<<-N)-1,v>>=-N,N+=r;N>0;c=c*256+t[n+L],L+=F,N-=8);if(v===0)v=1-w;else{if(v===D)return c?NaN:(S?-1:1)*(1/0);c=c+Math.pow(2,r),v=v-w}return(S?-1:1)*c*Math.pow(2,v-r)},e.write=function(t,n,a,r,p,v){var c,b,D,w=v*8-p-1,N=(1<<w)-1,L=N>>1,F=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,S=r?0:v-1,A=r?1:-1,G=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(b=isNaN(n)?1:0,c=N):(c=Math.floor(Math.log(n)/Math.LN2),n*(D=Math.pow(2,-c))<1&&(c--,D*=2),c+L>=1?n+=F/D:n+=F*Math.pow(2,1-L),n*D>=2&&(c++,D/=2),c+L>=N?(b=0,c=N):c+L>=1?(b=(n*D-1)*Math.pow(2,p),c=c+L):(b=n*Math.pow(2,L-1)*Math.pow(2,p),c=0));p>=8;t[a+S]=b&255,S+=A,b/=256,p-=8);for(c=c<<p|b,w+=p;w>0;t[a+S]=c&255,S+=A,c/=256,w-=8);t[a+S-A]|=G*128}}),Kr=Ut(e=>{"use strict";var t=Wr(),n=qr(),a=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=c,e.SlowBuffer=B,e.INSPECT_MAX_BYTES=50;var r=2147483647;e.kMaxLength=r,c.TYPED_ARRAY_SUPPORT=p(),!c.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function p(){try{let i=new Uint8Array(1),s={foo:function(){return 42}};return Object.setPrototypeOf(s,Uint8Array.prototype),Object.setPrototypeOf(i,s),i.foo()===42}catch{return!1}}Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}});function v(i){if(i>r)throw new RangeError('The value "'+i+'" is invalid for option "size"');let s=new Uint8Array(i);return Object.setPrototypeOf(s,c.prototype),s}function c(i,s,f){if(typeof i=="number"){if(typeof s=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return N(i)}return b(i,s,f)}c.poolSize=8192;function b(i,s,f){if(typeof i=="string")return L(i,s);if(ArrayBuffer.isView(i))return S(i);if(i==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof i);if(xe(i,ArrayBuffer)||i&&xe(i.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(xe(i,SharedArrayBuffer)||i&&xe(i.buffer,SharedArrayBuffer)))return A(i,s,f);if(typeof i=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let g=i.valueOf&&i.valueOf();if(g!=null&&g!==i)return c.from(g,s,f);let k=G(i);if(k)return k;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof i[Symbol.toPrimitive]=="function")return c.from(i[Symbol.toPrimitive]("string"),s,f);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof i)}c.from=function(i,s,f){return b(i,s,f)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array);function D(i){if(typeof i!="number")throw new TypeError('"size" argument must be of type number');if(i<0)throw new RangeError('The value "'+i+'" is invalid for option "size"')}function w(i,s,f){return D(i),i<=0?v(i):s!==void 0?typeof f=="string"?v(i).fill(s,f):v(i).fill(s):v(i)}c.alloc=function(i,s,f){return w(i,s,f)};function N(i){return D(i),v(i<0?0:W(i)|0)}c.allocUnsafe=function(i){return N(i)},c.allocUnsafeSlow=function(i){return N(i)};function L(i,s){if((typeof s!="string"||s==="")&&(s="utf8"),!c.isEncoding(s))throw new TypeError("Unknown encoding: "+s);let f=Q(i,s)|0,g=v(f),k=g.write(i,s);return k!==f&&(g=g.slice(0,k)),g}function F(i){let s=i.length<0?0:W(i.length)|0,f=v(s);for(let g=0;g<s;g+=1)f[g]=i[g]&255;return f}function S(i){if(xe(i,Uint8Array)){let s=new Uint8Array(i);return A(s.buffer,s.byteOffset,s.byteLength)}return F(i)}function A(i,s,f){if(s<0||i.byteLength<s)throw new RangeError('"offset" is outside of buffer bounds');if(i.byteLength<s+(f||0))throw new RangeError('"length" is outside of buffer bounds');let g;return s===void 0&&f===void 0?g=new Uint8Array(i):f===void 0?g=new Uint8Array(i,s):g=new Uint8Array(i,s,f),Object.setPrototypeOf(g,c.prototype),g}function G(i){if(c.isBuffer(i)){let s=W(i.length)|0,f=v(s);return f.length===0||i.copy(f,0,0,s),f}if(i.length!==void 0)return typeof i.length!="number"||_t(i.length)?v(0):F(i);if(i.type==="Buffer"&&Array.isArray(i.data))return F(i.data)}function W(i){if(i>=r)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r.toString(16)+" bytes");return i|0}function B(i){return+i!=i&&(i=0),c.alloc(+i)}c.isBuffer=function(i){return i!=null&&i._isBuffer===!0&&i!==c.prototype},c.compare=function(i,s){if(xe(i,Uint8Array)&&(i=c.from(i,i.offset,i.byteLength)),xe(s,Uint8Array)&&(s=c.from(s,s.offset,s.byteLength)),!c.isBuffer(i)||!c.isBuffer(s))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(i===s)return 0;let f=i.length,g=s.length;for(let k=0,T=Math.min(f,g);k<T;++k)if(i[k]!==s[k]){f=i[k],g=s[k];break}return f<g?-1:g<f?1:0},c.isEncoding=function(i){switch(String(i).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(i,s){if(!Array.isArray(i))throw new TypeError('"list" argument must be an Array of Buffers');if(i.length===0)return c.alloc(0);let f;if(s===void 0)for(s=0,f=0;f<i.length;++f)s+=i[f].length;let g=c.allocUnsafe(s),k=0;for(f=0;f<i.length;++f){let T=i[f];if(xe(T,Uint8Array))k+T.length>g.length?(c.isBuffer(T)||(T=c.from(T)),T.copy(g,k)):Uint8Array.prototype.set.call(g,T,k);else if(c.isBuffer(T))T.copy(g,k);else throw new TypeError('"list" argument must be an Array of Buffers');k+=T.length}return g};function Q(i,s){if(c.isBuffer(i))return i.length;if(ArrayBuffer.isView(i)||xe(i,ArrayBuffer))return i.byteLength;if(typeof i!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof i);let f=i.length,g=arguments.length>2&&arguments[2]===!0;if(!g&&f===0)return 0;let k=!1;for(;;)switch(s){case"ascii":case"latin1":case"binary":return f;case"utf8":case"utf-8":return ze(i).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return f*2;case"hex":return f>>>1;case"base64":return Nt(i).length;default:if(k)return g?-1:ze(i).length;s=(""+s).toLowerCase(),k=!0}}c.byteLength=Q;function $(i,s,f){let g=!1;if((s===void 0||s<0)&&(s=0),s>this.length||((f===void 0||f>this.length)&&(f=this.length),f<=0)||(f>>>=0,s>>>=0,f<=s))return"";for(i||(i="utf8");;)switch(i){case"hex":return te(this,s,f);case"utf8":case"utf-8":return Le(this,s,f);case"ascii":return z(this,s,f);case"latin1":case"binary":return Z(this,s,f);case"base64":return Pe(this,s,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return K(this,s,f);default:if(g)throw new TypeError("Unknown encoding: "+i);i=(i+"").toLowerCase(),g=!0}}c.prototype._isBuffer=!0;function ne(i,s,f){let g=i[s];i[s]=i[f],i[f]=g}c.prototype.swap16=function(){let i=this.length;if(i%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let s=0;s<i;s+=2)ne(this,s,s+1);return this},c.prototype.swap32=function(){let i=this.length;if(i%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let s=0;s<i;s+=4)ne(this,s,s+3),ne(this,s+1,s+2);return this},c.prototype.swap64=function(){let i=this.length;if(i%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let s=0;s<i;s+=8)ne(this,s,s+7),ne(this,s+1,s+6),ne(this,s+2,s+5),ne(this,s+3,s+4);return this},c.prototype.toString=function(){let i=this.length;return i===0?"":arguments.length===0?Le(this,0,i):$.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(i){if(!c.isBuffer(i))throw new TypeError("Argument must be a Buffer");return this===i?!0:c.compare(this,i)===0},c.prototype.inspect=function(){let i="",s=e.INSPECT_MAX_BYTES;return i=this.toString("hex",0,s).replace(/(.{2})/g,"$1 ").trim(),this.length>s&&(i+=" ... "),"<Buffer "+i+">"},a&&(c.prototype[a]=c.prototype.inspect),c.prototype.compare=function(i,s,f,g,k){if(xe(i,Uint8Array)&&(i=c.from(i,i.offset,i.byteLength)),!c.isBuffer(i))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof i);if(s===void 0&&(s=0),f===void 0&&(f=i?i.length:0),g===void 0&&(g=0),k===void 0&&(k=this.length),s<0||f>i.length||g<0||k>this.length)throw new RangeError("out of range index");if(g>=k&&s>=f)return 0;if(g>=k)return-1;if(s>=f)return 1;if(s>>>=0,f>>>=0,g>>>=0,k>>>=0,this===i)return 0;let T=k-g,M=f-s,fe=Math.min(T,M),Se=this.slice(g,k),ge=i.slice(s,f);for(let pe=0;pe<fe;++pe)if(Se[pe]!==ge[pe]){T=Se[pe],M=ge[pe];break}return T<M?-1:M<T?1:0};function re(i,s,f,g,k){if(i.length===0)return-1;if(typeof f=="string"?(g=f,f=0):f>2147483647?f=2147483647:f<-2147483648&&(f=-2147483648),f=+f,_t(f)&&(f=k?0:i.length-1),f<0&&(f=i.length+f),f>=i.length){if(k)return-1;f=i.length-1}else if(f<0)if(k)f=0;else return-1;if(typeof s=="string"&&(s=c.from(s,g)),c.isBuffer(s))return s.length===0?-1:Re(i,s,f,g,k);if(typeof s=="number")return s=s&255,typeof Uint8Array.prototype.indexOf=="function"?k?Uint8Array.prototype.indexOf.call(i,s,f):Uint8Array.prototype.lastIndexOf.call(i,s,f):Re(i,[s],f,g,k);throw new TypeError("val must be string, number or Buffer")}function Re(i,s,f,g,k){let T=1,M=i.length,fe=s.length;if(g!==void 0&&(g=String(g).toLowerCase(),g==="ucs2"||g==="ucs-2"||g==="utf16le"||g==="utf-16le")){if(i.length<2||s.length<2)return-1;T=2,M/=2,fe/=2,f/=2}function Se(pe,oe){return T===1?pe[oe]:pe.readUInt16BE(oe*T)}let ge;if(k){let pe=-1;for(ge=f;ge<M;ge++)if(Se(i,ge)===Se(s,pe===-1?0:ge-pe)){if(pe===-1&&(pe=ge),ge-pe+1===fe)return pe*T}else pe!==-1&&(ge-=ge-pe),pe=-1}else for(f+fe>M&&(f=M-fe),ge=f;ge>=0;ge--){let pe=!0;for(let oe=0;oe<fe;oe++)if(Se(i,ge+oe)!==Se(s,oe)){pe=!1;break}if(pe)return ge}return-1}c.prototype.includes=function(i,s,f){return this.indexOf(i,s,f)!==-1},c.prototype.indexOf=function(i,s,f){return re(this,i,s,f,!0)},c.prototype.lastIndexOf=function(i,s,f){return re(this,i,s,f,!1)};function x(i,s,f,g){f=Number(f)||0;let k=i.length-f;g?(g=Number(g),g>k&&(g=k)):g=k;let T=s.length;g>T/2&&(g=T/2);let M;for(M=0;M<g;++M){let fe=parseInt(s.substr(M*2,2),16);if(_t(fe))return M;i[f+M]=fe}return M}function q(i,s,f,g){return nt(ze(s,i.length-f),i,f,g)}function Ge(i,s,f,g){return nt($e(s),i,f,g)}function ie(i,s,f,g){return nt(Nt(s),i,f,g)}function ae(i,s,f,g){return nt(He(s,i.length-f),i,f,g)}c.prototype.write=function(i,s,f,g){if(s===void 0)g="utf8",f=this.length,s=0;else if(f===void 0&&typeof s=="string")g=s,f=this.length,s=0;else if(isFinite(s))s=s>>>0,isFinite(f)?(f=f>>>0,g===void 0&&(g="utf8")):(g=f,f=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let k=this.length-s;if((f===void 0||f>k)&&(f=k),i.length>0&&(f<0||s<0)||s>this.length)throw new RangeError("Attempt to write outside buffer bounds");g||(g="utf8");let T=!1;for(;;)switch(g){case"hex":return x(this,i,s,f);case"utf8":case"utf-8":return q(this,i,s,f);case"ascii":case"latin1":case"binary":return Ge(this,i,s,f);case"base64":return ie(this,i,s,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ae(this,i,s,f);default:if(T)throw new TypeError("Unknown encoding: "+g);g=(""+g).toLowerCase(),T=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Pe(i,s,f){return s===0&&f===i.length?t.fromByteArray(i):t.fromByteArray(i.slice(s,f))}function Le(i,s,f){f=Math.min(i.length,f);let g=[],k=s;for(;k<f;){let T=i[k],M=null,fe=T>239?4:T>223?3:T>191?2:1;if(k+fe<=f){let Se,ge,pe,oe;switch(fe){case 1:T<128&&(M=T);break;case 2:Se=i[k+1],(Se&192)===128&&(oe=(T&31)<<6|Se&63,oe>127&&(M=oe));break;case 3:Se=i[k+1],ge=i[k+2],(Se&192)===128&&(ge&192)===128&&(oe=(T&15)<<12|(Se&63)<<6|ge&63,oe>2047&&(oe<55296||oe>57343)&&(M=oe));break;case 4:Se=i[k+1],ge=i[k+2],pe=i[k+3],(Se&192)===128&&(ge&192)===128&&(pe&192)===128&&(oe=(T&15)<<18|(Se&63)<<12|(ge&63)<<6|pe&63,oe>65535&&oe<1114112&&(M=oe))}}M===null?(M=65533,fe=1):M>65535&&(M-=65536,g.push(M>>>10&1023|55296),M=56320|M&1023),g.push(M),k+=fe}return E(g)}var d=4096;function E(i){let s=i.length;if(s<=d)return String.fromCharCode.apply(String,i);let f="",g=0;for(;g<s;)f+=String.fromCharCode.apply(String,i.slice(g,g+=d));return f}function z(i,s,f){let g="";f=Math.min(i.length,f);for(let k=s;k<f;++k)g+=String.fromCharCode(i[k]&127);return g}function Z(i,s,f){let g="";f=Math.min(i.length,f);for(let k=s;k<f;++k)g+=String.fromCharCode(i[k]);return g}function te(i,s,f){let g=i.length;(!s||s<0)&&(s=0),(!f||f<0||f>g)&&(f=g);let k="";for(let T=s;T<f;++T)k+=We[i[T]];return k}function K(i,s,f){let g=i.slice(s,f),k="";for(let T=0;T<g.length-1;T+=2)k+=String.fromCharCode(g[T]+g[T+1]*256);return k}c.prototype.slice=function(i,s){let f=this.length;i=~~i,s=s===void 0?f:~~s,i<0?(i+=f,i<0&&(i=0)):i>f&&(i=f),s<0?(s+=f,s<0&&(s=0)):s>f&&(s=f),s<i&&(s=i);let g=this.subarray(i,s);return Object.setPrototypeOf(g,c.prototype),g};function he(i,s,f){if(i%1!==0||i<0)throw new RangeError("offset is not uint");if(i+s>f)throw new RangeError("Trying to access beyond buffer length")}c.prototype.readUintLE=c.prototype.readUIntLE=function(i,s,f){i=i>>>0,s=s>>>0,f||he(i,s,this.length);let g=this[i],k=1,T=0;for(;++T<s&&(k*=256);)g+=this[i+T]*k;return g},c.prototype.readUintBE=c.prototype.readUIntBE=function(i,s,f){i=i>>>0,s=s>>>0,f||he(i,s,this.length);let g=this[i+--s],k=1;for(;s>0&&(k*=256);)g+=this[i+--s]*k;return g},c.prototype.readUint8=c.prototype.readUInt8=function(i,s){return i=i>>>0,s||he(i,1,this.length),this[i]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(i,s){return i=i>>>0,s||he(i,2,this.length),this[i]|this[i+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(i,s){return i=i>>>0,s||he(i,2,this.length),this[i]<<8|this[i+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(i,s){return i=i>>>0,s||he(i,4,this.length),(this[i]|this[i+1]<<8|this[i+2]<<16)+this[i+3]*16777216},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(i,s){return i=i>>>0,s||he(i,4,this.length),this[i]*16777216+(this[i+1]<<16|this[i+2]<<8|this[i+3])},c.prototype.readBigUInt64LE=Fe(function(i){i=i>>>0,Ne(i,"offset");let s=this[i],f=this[i+7];(s===void 0||f===void 0)&&de(i,this.length-8);let g=s+this[++i]*2**8+this[++i]*2**16+this[++i]*2**24,k=this[++i]+this[++i]*2**8+this[++i]*2**16+f*2**24;return BigInt(g)+(BigInt(k)<<BigInt(32))}),c.prototype.readBigUInt64BE=Fe(function(i){i=i>>>0,Ne(i,"offset");let s=this[i],f=this[i+7];(s===void 0||f===void 0)&&de(i,this.length-8);let g=s*2**24+this[++i]*2**16+this[++i]*2**8+this[++i],k=this[++i]*2**24+this[++i]*2**16+this[++i]*2**8+f;return(BigInt(g)<<BigInt(32))+BigInt(k)}),c.prototype.readIntLE=function(i,s,f){i=i>>>0,s=s>>>0,f||he(i,s,this.length);let g=this[i],k=1,T=0;for(;++T<s&&(k*=256);)g+=this[i+T]*k;return k*=128,g>=k&&(g-=Math.pow(2,8*s)),g},c.prototype.readIntBE=function(i,s,f){i=i>>>0,s=s>>>0,f||he(i,s,this.length);let g=s,k=1,T=this[i+--g];for(;g>0&&(k*=256);)T+=this[i+--g]*k;return k*=128,T>=k&&(T-=Math.pow(2,8*s)),T},c.prototype.readInt8=function(i,s){return i=i>>>0,s||he(i,1,this.length),this[i]&128?(255-this[i]+1)*-1:this[i]},c.prototype.readInt16LE=function(i,s){i=i>>>0,s||he(i,2,this.length);let f=this[i]|this[i+1]<<8;return f&32768?f|4294901760:f},c.prototype.readInt16BE=function(i,s){i=i>>>0,s||he(i,2,this.length);let f=this[i+1]|this[i]<<8;return f&32768?f|4294901760:f},c.prototype.readInt32LE=function(i,s){return i=i>>>0,s||he(i,4,this.length),this[i]|this[i+1]<<8|this[i+2]<<16|this[i+3]<<24},c.prototype.readInt32BE=function(i,s){return i=i>>>0,s||he(i,4,this.length),this[i]<<24|this[i+1]<<16|this[i+2]<<8|this[i+3]},c.prototype.readBigInt64LE=Fe(function(i){i=i>>>0,Ne(i,"offset");let s=this[i],f=this[i+7];(s===void 0||f===void 0)&&de(i,this.length-8);let g=this[i+4]+this[i+5]*2**8+this[i+6]*2**16+(f<<24);return(BigInt(g)<<BigInt(32))+BigInt(s+this[++i]*2**8+this[++i]*2**16+this[++i]*2**24)}),c.prototype.readBigInt64BE=Fe(function(i){i=i>>>0,Ne(i,"offset");let s=this[i],f=this[i+7];(s===void 0||f===void 0)&&de(i,this.length-8);let g=(s<<24)+this[++i]*2**16+this[++i]*2**8+this[++i];return(BigInt(g)<<BigInt(32))+BigInt(this[++i]*2**24+this[++i]*2**16+this[++i]*2**8+f)}),c.prototype.readFloatLE=function(i,s){return i=i>>>0,s||he(i,4,this.length),n.read(this,i,!0,23,4)},c.prototype.readFloatBE=function(i,s){return i=i>>>0,s||he(i,4,this.length),n.read(this,i,!1,23,4)},c.prototype.readDoubleLE=function(i,s){return i=i>>>0,s||he(i,8,this.length),n.read(this,i,!0,52,8)},c.prototype.readDoubleBE=function(i,s){return i=i>>>0,s||he(i,8,this.length),n.read(this,i,!1,52,8)};function _e(i,s,f,g,k,T){if(!c.isBuffer(i))throw new TypeError('"buffer" argument must be a Buffer instance');if(s>k||s<T)throw new RangeError('"value" argument is out of bounds');if(f+g>i.length)throw new RangeError("Index out of range")}c.prototype.writeUintLE=c.prototype.writeUIntLE=function(i,s,f,g){if(i=+i,s=s>>>0,f=f>>>0,!g){let M=Math.pow(2,8*f)-1;_e(this,i,s,f,M,0)}let k=1,T=0;for(this[s]=i&255;++T<f&&(k*=256);)this[s+T]=i/k&255;return s+f},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(i,s,f,g){if(i=+i,s=s>>>0,f=f>>>0,!g){let M=Math.pow(2,8*f)-1;_e(this,i,s,f,M,0)}let k=f-1,T=1;for(this[s+k]=i&255;--k>=0&&(T*=256);)this[s+k]=i/T&255;return s+f},c.prototype.writeUint8=c.prototype.writeUInt8=function(i,s,f){return i=+i,s=s>>>0,f||_e(this,i,s,1,255,0),this[s]=i&255,s+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(i,s,f){return i=+i,s=s>>>0,f||_e(this,i,s,2,65535,0),this[s]=i&255,this[s+1]=i>>>8,s+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(i,s,f){return i=+i,s=s>>>0,f||_e(this,i,s,2,65535,0),this[s]=i>>>8,this[s+1]=i&255,s+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(i,s,f){return i=+i,s=s>>>0,f||_e(this,i,s,4,4294967295,0),this[s+3]=i>>>24,this[s+2]=i>>>16,this[s+1]=i>>>8,this[s]=i&255,s+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(i,s,f){return i=+i,s=s>>>0,f||_e(this,i,s,4,4294967295,0),this[s]=i>>>24,this[s+1]=i>>>16,this[s+2]=i>>>8,this[s+3]=i&255,s+4};function be(i,s,f,g,k){Ue(s,g,k,i,f,7);let T=Number(s&BigInt(4294967295));i[f++]=T,T=T>>8,i[f++]=T,T=T>>8,i[f++]=T,T=T>>8,i[f++]=T;let M=Number(s>>BigInt(32)&BigInt(4294967295));return i[f++]=M,M=M>>8,i[f++]=M,M=M>>8,i[f++]=M,M=M>>8,i[f++]=M,f}function it(i,s,f,g,k){Ue(s,g,k,i,f,7);let T=Number(s&BigInt(4294967295));i[f+7]=T,T=T>>8,i[f+6]=T,T=T>>8,i[f+5]=T,T=T>>8,i[f+4]=T;let M=Number(s>>BigInt(32)&BigInt(4294967295));return i[f+3]=M,M=M>>8,i[f+2]=M,M=M>>8,i[f+1]=M,M=M>>8,i[f]=M,f+8}c.prototype.writeBigUInt64LE=Fe(function(i,s=0){return be(this,i,s,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeBigUInt64BE=Fe(function(i,s=0){return it(this,i,s,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeIntLE=function(i,s,f,g){if(i=+i,s=s>>>0,!g){let fe=Math.pow(2,8*f-1);_e(this,i,s,f,fe-1,-fe)}let k=0,T=1,M=0;for(this[s]=i&255;++k<f&&(T*=256);)i<0&&M===0&&this[s+k-1]!==0&&(M=1),this[s+k]=(i/T>>0)-M&255;return s+f},c.prototype.writeIntBE=function(i,s,f,g){if(i=+i,s=s>>>0,!g){let fe=Math.pow(2,8*f-1);_e(this,i,s,f,fe-1,-fe)}let k=f-1,T=1,M=0;for(this[s+k]=i&255;--k>=0&&(T*=256);)i<0&&M===0&&this[s+k+1]!==0&&(M=1),this[s+k]=(i/T>>0)-M&255;return s+f},c.prototype.writeInt8=function(i,s,f){return i=+i,s=s>>>0,f||_e(this,i,s,1,127,-128),i<0&&(i=255+i+1),this[s]=i&255,s+1},c.prototype.writeInt16LE=function(i,s,f){return i=+i,s=s>>>0,f||_e(this,i,s,2,32767,-32768),this[s]=i&255,this[s+1]=i>>>8,s+2},c.prototype.writeInt16BE=function(i,s,f){return i=+i,s=s>>>0,f||_e(this,i,s,2,32767,-32768),this[s]=i>>>8,this[s+1]=i&255,s+2},c.prototype.writeInt32LE=function(i,s,f){return i=+i,s=s>>>0,f||_e(this,i,s,4,2147483647,-2147483648),this[s]=i&255,this[s+1]=i>>>8,this[s+2]=i>>>16,this[s+3]=i>>>24,s+4},c.prototype.writeInt32BE=function(i,s,f){return i=+i,s=s>>>0,f||_e(this,i,s,4,2147483647,-2147483648),i<0&&(i=4294967295+i+1),this[s]=i>>>24,this[s+1]=i>>>16,this[s+2]=i>>>8,this[s+3]=i&255,s+4},c.prototype.writeBigInt64LE=Fe(function(i,s=0){return be(this,i,s,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),c.prototype.writeBigInt64BE=Fe(function(i,s=0){return it(this,i,s,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function zt(i,s,f,g,k,T){if(f+g>i.length)throw new RangeError("Index out of range");if(f<0)throw new RangeError("Index out of range")}function m(i,s,f,g,k){return s=+s,f=f>>>0,k||zt(i,s,f,4,34028234663852886e22,-34028234663852886e22),n.write(i,s,f,g,23,4),f+4}c.prototype.writeFloatLE=function(i,s,f){return m(this,i,s,!0,f)},c.prototype.writeFloatBE=function(i,s,f){return m(this,i,s,!1,f)};function h(i,s,f,g,k){return s=+s,f=f>>>0,k||zt(i,s,f,8,17976931348623157e292,-17976931348623157e292),n.write(i,s,f,g,52,8),f+8}c.prototype.writeDoubleLE=function(i,s,f){return h(this,i,s,!0,f)},c.prototype.writeDoubleBE=function(i,s,f){return h(this,i,s,!1,f)},c.prototype.copy=function(i,s,f,g){if(!c.isBuffer(i))throw new TypeError("argument should be a Buffer");if(f||(f=0),!g&&g!==0&&(g=this.length),s>=i.length&&(s=i.length),s||(s=0),g>0&&g<f&&(g=f),g===f||i.length===0||this.length===0)return 0;if(s<0)throw new RangeError("targetStart out of bounds");if(f<0||f>=this.length)throw new RangeError("Index out of range");if(g<0)throw new RangeError("sourceEnd out of bounds");g>this.length&&(g=this.length),i.length-s<g-f&&(g=i.length-s+f);let k=g-f;return this===i&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(s,f,g):Uint8Array.prototype.set.call(i,this.subarray(f,g),s),k},c.prototype.fill=function(i,s,f,g){if(typeof i=="string"){if(typeof s=="string"?(g=s,s=0,f=this.length):typeof f=="string"&&(g=f,f=this.length),g!==void 0&&typeof g!="string")throw new TypeError("encoding must be a string");if(typeof g=="string"&&!c.isEncoding(g))throw new TypeError("Unknown encoding: "+g);if(i.length===1){let T=i.charCodeAt(0);(g==="utf8"&&T<128||g==="latin1")&&(i=T)}}else typeof i=="number"?i=i&255:typeof i=="boolean"&&(i=Number(i));if(s<0||this.length<s||this.length<f)throw new RangeError("Out of range index");if(f<=s)return this;s=s>>>0,f=f===void 0?this.length:f>>>0,i||(i=0);let k;if(typeof i=="number")for(k=s;k<f;++k)this[k]=i;else{let T=c.isBuffer(i)?i:c.from(i,g),M=T.length;if(M===0)throw new TypeError('The value "'+i+'" is invalid for argument "value"');for(k=0;k<f-s;++k)this[k+s]=T[k%M]}return this};var J={};function X(i,s,f){J[i]=class extends f{constructor(){super(),Object.defineProperty(this,"message",{value:s.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${i}]`,this.stack,delete this.name}get code(){return i}set code(g){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:g,writable:!0})}toString(){return`${this.name} [${i}]: ${this.message}`}}}X("ERR_BUFFER_OUT_OF_BOUNDS",function(i){return i?`${i} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),X("ERR_INVALID_ARG_TYPE",function(i,s){return`The "${i}" argument must be of type number. Received type ${typeof s}`},TypeError),X("ERR_OUT_OF_RANGE",function(i,s,f){let g=`The value of "${i}" is out of range.`,k=f;return Number.isInteger(f)&&Math.abs(f)>2**32?k=we(String(f)):typeof f=="bigint"&&(k=String(f),(f>BigInt(2)**BigInt(32)||f<-(BigInt(2)**BigInt(32)))&&(k=we(k)),k+="n"),g+=` It must be ${s}. Received ${k}`,g},RangeError);function we(i){let s="",f=i.length,g=i[0]==="-"?1:0;for(;f>=g+4;f-=3)s=`_${i.slice(f-3,f)}${s}`;return`${i.slice(0,f)}${s}`}function Oe(i,s,f){Ne(s,"offset"),(i[s]===void 0||i[s+f]===void 0)&&de(s,i.length-(f+1))}function Ue(i,s,f,g,k,T){if(i>f||i<s){let M=typeof s=="bigint"?"n":"",fe;throw T>3?s===0||s===BigInt(0)?fe=`>= 0${M} and < 2${M} ** ${(T+1)*8}${M}`:fe=`>= -(2${M} ** ${(T+1)*8-1}${M}) and < 2 ** ${(T+1)*8-1}${M}`:fe=`>= ${s}${M} and <= ${f}${M}`,new J.ERR_OUT_OF_RANGE("value",fe,i)}Oe(g,k,T)}function Ne(i,s){if(typeof i!="number")throw new J.ERR_INVALID_ARG_TYPE(s,"number",i)}function de(i,s,f){throw Math.floor(i)!==i?(Ne(i,f),new J.ERR_OUT_OF_RANGE(f||"offset","an integer",i)):s<0?new J.ERR_BUFFER_OUT_OF_BOUNDS:new J.ERR_OUT_OF_RANGE(f||"offset",`>= ${f?1:0} and <= ${s}`,i)}var Ie=/[^+/0-9A-Za-z-_]/g;function Te(i){if(i=i.split("=")[0],i=i.trim().replace(Ie,""),i.length<2)return"";for(;i.length%4!==0;)i=i+"=";return i}function ze(i,s){s=s||1/0;let f,g=i.length,k=null,T=[];for(let M=0;M<g;++M){if(f=i.charCodeAt(M),f>55295&&f<57344){if(!k){if(f>56319){(s-=3)>-1&&T.push(239,191,189);continue}else if(M+1===g){(s-=3)>-1&&T.push(239,191,189);continue}k=f;continue}if(f<56320){(s-=3)>-1&&T.push(239,191,189),k=f;continue}f=(k-55296<<10|f-56320)+65536}else k&&(s-=3)>-1&&T.push(239,191,189);if(k=null,f<128){if((s-=1)<0)break;T.push(f)}else if(f<2048){if((s-=2)<0)break;T.push(f>>6|192,f&63|128)}else if(f<65536){if((s-=3)<0)break;T.push(f>>12|224,f>>6&63|128,f&63|128)}else if(f<1114112){if((s-=4)<0)break;T.push(f>>18|240,f>>12&63|128,f>>6&63|128,f&63|128)}else throw new Error("Invalid code point")}return T}function $e(i){let s=[];for(let f=0;f<i.length;++f)s.push(i.charCodeAt(f)&255);return s}function He(i,s){let f,g,k,T=[];for(let M=0;M<i.length&&!((s-=2)<0);++M)f=i.charCodeAt(M),g=f>>8,k=f%256,T.push(k),T.push(g);return T}function Nt(i){return t.toByteArray(Te(i))}function nt(i,s,f,g){let k;for(k=0;k<g&&!(k+f>=s.length||k>=i.length);++k)s[k+f]=i[k];return k}function xe(i,s){return i instanceof s||i!=null&&i.constructor!=null&&i.constructor.name!=null&&i.constructor.name===s.name}function _t(i){return i!==i}var We=function(){let i="0123456789abcdef",s=new Array(256);for(let f=0;f<16;++f){let g=f*16;for(let k=0;k<16;++k)s[g+k]=i[f]+i[k]}return s}();function Fe(i){return typeof BigInt>"u"?vt:i}function vt(){throw new Error("BigInt not supported")}}),Jr=Ut(()=>{}),Yr=Ut(e=>{var t=e,{Buffer:n}=Kr(),a=Jr();t.toBuffer=function(c,b,D){D=~~D;let w;if(this.isV4Format(c))w=b||n.alloc(D+4),c.split(/\./g).map(N=>{w[D++]=parseInt(N,10)&255});else if(this.isV6Format(c)){let N=c.split(":",8),L;for(L=0;L<N.length;L++){let F=this.isV4Format(N[L]),S;F&&(S=this.toBuffer(N[L]),N[L]=S.slice(0,2).toString("hex")),S&&++L<8&&N.splice(L,0,S.slice(2,4).toString("hex"))}if(N[0]==="")for(;N.length<8;)N.unshift("0");else if(N[N.length-1]==="")for(;N.length<8;)N.push("0");else if(N.length<8){for(L=0;L<N.length&&N[L]!=="";L++);let F=[L,1];for(L=9-N.length;L>0;L--)F.push("0");N.splice(...F)}for(w=b||n.alloc(D+16),L=0;L<N.length;L++){let F=parseInt(N[L],16);w[D++]=F>>8&255,w[D++]=F&255}}if(!w)throw Error(`Invalid ip address: ${c}`);return w},t.toString=function(c,b,D){b=~~b,D=D||c.length-b;let w=[];if(D===4){for(let N=0;N<D;N++)w.push(c[b+N]);w=w.join(".")}else if(D===16){for(let N=0;N<D;N+=2)w.push(c.readUInt16BE(b+N).toString(16));w=w.join(":"),w=w.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),w=w.replace(/:{3,4}/,"::")}return w};var r=/^(\d{1,3}\.){3,3}\d{1,3}$/,p=/^(::)?(((\d{1,3}\.){3}(\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i;t.isV4Format=function(c){return r.test(c)},t.isV6Format=function(c){return p.test(c)};function v(c){return c===4?"ipv4":c===6?"ipv6":c?c.toLowerCase():"ipv4"}t.fromPrefixLen=function(c,b){c>32?b="ipv6":b=v(b);let D=4;b==="ipv6"&&(D=16);let w=n.alloc(D);for(let N=0,L=w.length;N<L;++N){let F=8;c<8&&(F=c),c-=F,w[N]=~(255>>F)&255}return t.toString(w)},t.mask=function(c,b){c=t.toBuffer(c),b=t.toBuffer(b);let D=n.alloc(Math.max(c.length,b.length)),w;if(c.length===b.length)for(w=0;w<c.length;w++)D[w]=c[w]&b[w];else if(b.length===4)for(w=0;w<b.length;w++)D[w]=c[c.length-4+w]&b[w];else{for(w=0;w<D.length-6;w++)D[w]=0;for(D[10]=255,D[11]=255,w=0;w<c.length;w++)D[w+12]=c[w]&b[w+12];w+=12}for(;w<D.length;w++)D[w]=0;return t.toString(D)},t.cidr=function(c){let b=c.split("/"),D=b[0];if(b.length!==2)throw new Error(`invalid CIDR subnet: ${D}`);let w=t.fromPrefixLen(parseInt(b[1],10));return t.mask(D,w)},t.subnet=function(c,b){let D=t.toLong(t.mask(c,b)),w=t.toBuffer(b),N=0;for(let F=0;F<w.length;F++)if(w[F]===255)N+=8;else{let S=w[F]&255;for(;S;)S=S<<1&255,N++}let L=2**(32-N);return{networkAddress:t.fromLong(D),firstAddress:L<=2?t.fromLong(D):t.fromLong(D+1),lastAddress:L<=2?t.fromLong(D+L-1):t.fromLong(D+L-2),broadcastAddress:t.fromLong(D+L-1),subnetMask:b,subnetMaskLength:N,numHosts:L<=2?L:L-2,length:L,contains(F){return D===t.toLong(t.mask(F,b))}}},t.cidrSubnet=function(c){let b=c.split("/"),D=b[0];if(b.length!==2)throw new Error(`invalid CIDR subnet: ${D}`);let w=t.fromPrefixLen(parseInt(b[1],10));return t.subnet(D,w)},t.not=function(c){let b=t.toBuffer(c);for(let D=0;D<b.length;D++)b[D]=255^b[D];return t.toString(b)},t.or=function(c,b){if(c=t.toBuffer(c),b=t.toBuffer(b),c.length===b.length){for(let L=0;L<c.length;++L)c[L]|=b[L];return t.toString(c)}let D=c,w=b;b.length>c.length&&(D=b,w=c);let N=D.length-w.length;for(let L=N;L<D.length;++L)D[L]|=w[L-N];return t.toString(D)},t.isEqual=function(c,b){if(c=t.toBuffer(c),b=t.toBuffer(b),c.length===b.length){for(let w=0;w<c.length;w++)if(c[w]!==b[w])return!1;return!0}if(b.length===4){let w=b;b=c,c=w}for(let w=0;w<10;w++)if(b[w]!==0)return!1;let D=b.readUInt16BE(10);if(D!==0&&D!==65535)return!1;for(let w=0;w<4;w++)if(c[w]!==b[w+12])return!1;return!0},t.isPrivate=function(c){return/^(::f{4}:)?10\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(c)||/^(::f{4}:)?192\.168\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(c)||/^(::f{4}:)?172\.(1[6-9]|2\d|30|31)\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(c)||/^(::f{4}:)?127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(c)||/^(::f{4}:)?169\.254\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(c)||/^f[cd][0-9a-f]{2}:/i.test(c)||/^fe80:/i.test(c)||/^::1$/.test(c)||/^::$/.test(c)},t.isPublic=function(c){return!t.isPrivate(c)},t.isLoopback=function(c){return/^(::f{4}:)?127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})/.test(c)||/^fe80::1$/.test(c)||/^::1$/.test(c)||/^::$/.test(c)},t.loopback=function(c){if(c=v(c),c!=="ipv4"&&c!=="ipv6")throw new Error("family must be ipv4 or ipv6");return c==="ipv4"?"127.0.0.1":"fe80::1"},t.address=function(c,b){let D=a.networkInterfaces();if(b=v(b),c&&c!=="private"&&c!=="public"){let N=D[c].filter(L=>v(L.family)===b);return N.length===0?void 0:N[0].address}let w=Object.keys(D).map(N=>{let L=D[N].filter(F=>(F.family=v(F.family),F.family!==b||t.isLoopback(F.address)?!1:c?c==="public"?t.isPrivate(F.address):t.isPublic(F.address):!0));return L.length?L[0].address:void 0}).filter(Boolean);return w.length?w[0]:t.loopback(b)},t.toLong=function(c){let b=0;return c.split(".").forEach(D=>{b<<=8,b+=parseInt(D)}),b>>>0},t.fromLong=function(c){return`${c>>>24}.${c>>16&255}.${c>>8&255}.${c&255}`}}),Xr=Ut((e,t)=>{var n=typeof self<"u"?self:e,a=function(){function p(){this.fetch=!1,this.DOMException=n.DOMException}return p.prototype=n,new p}();(function(p){var v=function(c){var b={searchParams:"URLSearchParams"in p,iterable:"Symbol"in p&&"iterator"in Symbol,blob:"FileReader"in p&&"Blob"in p&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in p,arrayBuffer:"ArrayBuffer"in p};function D(d){return d&&DataView.prototype.isPrototypeOf(d)}if(b.arrayBuffer)var w=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],N=ArrayBuffer.isView||function(d){return d&&w.indexOf(Object.prototype.toString.call(d))>-1};function L(d){if(typeof d!="string"&&(d=String(d)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(d))throw new TypeError("Invalid character in header field name");return d.toLowerCase()}function F(d){return typeof d!="string"&&(d=String(d)),d}function S(d){var E={next:function(){var z=d.shift();return{done:z===void 0,value:z}}};return b.iterable&&(E[Symbol.iterator]=function(){return E}),E}function A(d){this.map={},d instanceof A?d.forEach(function(E,z){this.append(z,E)},this):Array.isArray(d)?d.forEach(function(E){this.append(E[0],E[1])},this):d&&Object.getOwnPropertyNames(d).forEach(function(E){this.append(E,d[E])},this)}A.prototype.append=function(d,E){d=L(d),E=F(E);var z=this.map[d];this.map[d]=z?z+", "+E:E},A.prototype.delete=function(d){delete this.map[L(d)]},A.prototype.get=function(d){return d=L(d),this.has(d)?this.map[d]:null},A.prototype.has=function(d){return this.map.hasOwnProperty(L(d))},A.prototype.set=function(d,E){this.map[L(d)]=F(E)},A.prototype.forEach=function(d,E){for(var z in this.map)this.map.hasOwnProperty(z)&&d.call(E,this.map[z],z,this)},A.prototype.keys=function(){var d=[];return this.forEach(function(E,z){d.push(z)}),S(d)},A.prototype.values=function(){var d=[];return this.forEach(function(E){d.push(E)}),S(d)},A.prototype.entries=function(){var d=[];return this.forEach(function(E,z){d.push([z,E])}),S(d)},b.iterable&&(A.prototype[Symbol.iterator]=A.prototype.entries);function G(d){if(d.bodyUsed)return Promise.reject(new TypeError("Already read"));d.bodyUsed=!0}function W(d){return new Promise(function(E,z){d.onload=function(){E(d.result)},d.onerror=function(){z(d.error)}})}function B(d){var E=new FileReader,z=W(E);return E.readAsArrayBuffer(d),z}function Q(d){var E=new FileReader,z=W(E);return E.readAsText(d),z}function $(d){for(var E=new Uint8Array(d),z=new Array(E.length),Z=0;Z<E.length;Z++)z[Z]=String.fromCharCode(E[Z]);return z.join("")}function ne(d){if(d.slice)return d.slice(0);var E=new Uint8Array(d.byteLength);return E.set(new Uint8Array(d)),E.buffer}function re(){return this.bodyUsed=!1,this._initBody=function(d){this._bodyInit=d,d?typeof d=="string"?this._bodyText=d:b.blob&&Blob.prototype.isPrototypeOf(d)?this._bodyBlob=d:b.formData&&FormData.prototype.isPrototypeOf(d)?this._bodyFormData=d:b.searchParams&&URLSearchParams.prototype.isPrototypeOf(d)?this._bodyText=d.toString():b.arrayBuffer&&b.blob&&D(d)?(this._bodyArrayBuffer=ne(d.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):b.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(d)||N(d))?this._bodyArrayBuffer=ne(d):this._bodyText=d=Object.prototype.toString.call(d):this._bodyText="",this.headers.get("content-type")||(typeof d=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):b.searchParams&&URLSearchParams.prototype.isPrototypeOf(d)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},b.blob&&(this.blob=function(){var d=G(this);if(d)return d;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?G(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(B)}),this.text=function(){var d=G(this);if(d)return d;if(this._bodyBlob)return Q(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve($(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},b.formData&&(this.formData=function(){return this.text().then(Ge)}),this.json=function(){return this.text().then(JSON.parse)},this}var Re=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function x(d){var E=d.toUpperCase();return Re.indexOf(E)>-1?E:d}function q(d,E){E=E||{};var z=E.body;if(d instanceof q){if(d.bodyUsed)throw new TypeError("Already read");this.url=d.url,this.credentials=d.credentials,E.headers||(this.headers=new A(d.headers)),this.method=d.method,this.mode=d.mode,this.signal=d.signal,!z&&d._bodyInit!=null&&(z=d._bodyInit,d.bodyUsed=!0)}else this.url=String(d);if(this.credentials=E.credentials||this.credentials||"same-origin",(E.headers||!this.headers)&&(this.headers=new A(E.headers)),this.method=x(E.method||this.method||"GET"),this.mode=E.mode||this.mode||null,this.signal=E.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&z)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(z)}q.prototype.clone=function(){return new q(this,{body:this._bodyInit})};function Ge(d){var E=new FormData;return d.trim().split("&").forEach(function(z){if(z){var Z=z.split("="),te=Z.shift().replace(/\+/g," "),K=Z.join("=").replace(/\+/g," ");E.append(decodeURIComponent(te),decodeURIComponent(K))}}),E}function ie(d){var E=new A,z=d.replace(/\r?\n[\t ]+/g," ");return z.split(/\r?\n/).forEach(function(Z){var te=Z.split(":"),K=te.shift().trim();if(K){var he=te.join(":").trim();E.append(K,he)}}),E}re.call(q.prototype);function ae(d,E){E||(E={}),this.type="default",this.status=E.status===void 0?200:E.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in E?E.statusText:"OK",this.headers=new A(E.headers),this.url=E.url||"",this._initBody(d)}re.call(ae.prototype),ae.prototype.clone=function(){return new ae(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new A(this.headers),url:this.url})},ae.error=function(){var d=new ae(null,{status:0,statusText:""});return d.type="error",d};var Pe=[301,302,303,307,308];ae.redirect=function(d,E){if(Pe.indexOf(E)===-1)throw new RangeError("Invalid status code");return new ae(null,{status:E,headers:{location:d}})},c.DOMException=p.DOMException;try{new c.DOMException}catch{c.DOMException=function(d,E){this.message=d,this.name=E;var z=Error(d);this.stack=z.stack},c.DOMException.prototype=Object.create(Error.prototype),c.DOMException.prototype.constructor=c.DOMException}function Le(d,E){return new Promise(function(z,Z){var te=new q(d,E);if(te.signal&&te.signal.aborted)return Z(new c.DOMException("Aborted","AbortError"));var K=new XMLHttpRequest;function he(){K.abort()}K.onload=function(){var _e={status:K.status,statusText:K.statusText,headers:ie(K.getAllResponseHeaders()||"")};_e.url="responseURL"in K?K.responseURL:_e.headers.get("X-Request-URL");var be="response"in K?K.response:K.responseText;z(new ae(be,_e))},K.onerror=function(){Z(new TypeError("Network request failed"))},K.ontimeout=function(){Z(new TypeError("Network request failed"))},K.onabort=function(){Z(new c.DOMException("Aborted","AbortError"))},K.open(te.method,te.url,!0),te.credentials==="include"?K.withCredentials=!0:te.credentials==="omit"&&(K.withCredentials=!1),"responseType"in K&&b.blob&&(K.responseType="blob"),te.headers.forEach(function(_e,be){K.setRequestHeader(be,_e)}),te.signal&&(te.signal.addEventListener("abort",he),K.onreadystatechange=function(){K.readyState===4&&te.signal.removeEventListener("abort",he)}),K.send(typeof te._bodyInit>"u"?null:te._bodyInit)})}return Le.polyfill=!0,p.fetch||(p.fetch=Le,p.Headers=A,p.Request=q,p.Response=ae),c.Headers=A,c.Request=q,c.Response=ae,c.fetch=Le,Object.defineProperty(c,"__esModule",{value:!0}),c}({})})(a),a.fetch.ponyfill=!0,delete a.fetch.polyfill;var r=a;e=r.fetch,e.default=r.fetch,e.fetch=r.fetch,e.Headers=r.Headers,e.Request=r.Request,e.Response=r.Response,t.exports=e}),Qr=(e,t,n,a)=>{if(n==="length"||n==="prototype"||n==="arguments"||n==="caller")return;let r=Object.getOwnPropertyDescriptor(e,n),p=Object.getOwnPropertyDescriptor(t,n);!Zr(r,p)&&a||Object.defineProperty(e,n,p)},Zr=function(e,t){return e===void 0||e.configurable||e.writable===t.writable&&e.enumerable===t.enumerable&&e.configurable===t.configurable&&(e.writable||e.value===t.value)},eo=(e,t)=>{let n=Object.getPrototypeOf(t);n!==Object.getPrototypeOf(e)&&Object.setPrototypeOf(e,n)},to=(e,t)=>`/* Wrapped ${e}*/
${t}`,io=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),no=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name"),ro=(e,t,n)=>{let a=n===""?"":`with ${n.trim()}() `,r=to.bind(null,a,t.toString());Object.defineProperty(r,"name",no),Object.defineProperty(e,"toString",{...io,value:r})};function oo(e,t,{ignoreNonConfigurable:n=!1}={}){let{name:a}=e;for(let r of Reflect.ownKeys(t))Qr(e,t,r,n);return eo(e,t),ro(e,t,a),e}var so=new WeakMap;function ao(e,{cacheKey:t=([a])=>a,cache:n=new Map}={}){let a=new Map,r=function(...p){let v=t(p);if(a.has(v))return a.get(v);let c=(async()=>{try{if(n&&await n.has(v))return await n.get(v);let b=await e.apply(this,p);try{return b}finally{n&&await n.set(v,b)}}finally{a.delete(v)}})();return a.set(v,c),c};return oo(r,e,{ignoreNonConfigurable:!0}),so.set(r,n),r}var fo=jn(Yr(),1),co=["string","number","bigint","symbol"],lo=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function uo(e){if(e===null)return"null";if(e===void 0)return"undefined";if(e===!0||e===!1)return"boolean";let t=typeof e;return co.includes(t)?t:t==="function"?"Function":Array.isArray(e)?"Array":ho(e)?"Buffer":po(e)||"Object"}function ho(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}function po(e){let t=Object.prototype.toString.call(e).slice(8,-1);if(lo.includes(t))return t}var C=class{constructor(e,t,n){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=n}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}};C.uint=new C(0,"uint",!0);C.negint=new C(1,"negint",!0);C.bytes=new C(2,"bytes",!0);C.string=new C(3,"string",!0);C.array=new C(4,"array",!1);C.map=new C(5,"map",!1);C.tag=new C(6,"tag",!1);C.float=new C(7,"float",!0);C.false=new C(7,"false",!0);C.true=new C(7,"true",!0);C.null=new C(7,"null",!0);C.undefined=new C(7,"undefined",!0);C.break=new C(7,"break",!0);var Y=class{constructor(e,t,n){this.type=e,this.value=t,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}},Ct=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",go=new TextDecoder,mo=new TextEncoder;function ui(e){return Ct&&globalThis.Buffer.isBuffer(e)}function yo(e){return e instanceof Uint8Array?ui(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}var wo=Ct?(e,t,n)=>n-t>64?globalThis.Buffer.from(e.subarray(t,n)).toString("utf8"):Pn(e,t,n):(e,t,n)=>n-t>64?go.decode(e.subarray(t,n)):Pn(e,t,n),_o=Ct?e=>e.length>64?globalThis.Buffer.from(e):Cn(e):e=>e.length>64?mo.encode(e):Cn(e),Ki=Ct?(e,t,n)=>ui(e)?new Uint8Array(e.subarray(t,n)):e.slice(t,n):(e,t,n)=>e.slice(t,n),vo=Ct?(e,t)=>(e=e.map(n=>n instanceof Uint8Array?n:globalThis.Buffer.from(n)),yo(globalThis.Buffer.concat(e,t))):(e,t)=>{let n=new Uint8Array(t),a=0;for(let r of e)a+r.length>n.length&&(r=r.subarray(0,n.length-a)),n.set(r,a),a+=r.length;return n},bo=Ct?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function Eo(e,t){if(ui(e)&&ui(t))return e.compare(t);for(let n=0;n<e.length;n++)if(e[n]!==t[n])return e[n]<t[n]?-1:1;return 0}function Cn(e,t=1/0){let n,a=e.length,r=null,p=[];for(let v=0;v<a;++v){if(n=e.charCodeAt(v),n>55295&&n<57344){if(!r){if(n>56319){(t-=3)>-1&&p.push(239,191,189);continue}else if(v+1===a){(t-=3)>-1&&p.push(239,191,189);continue}r=n;continue}if(n<56320){(t-=3)>-1&&p.push(239,191,189),r=n;continue}n=(r-55296<<10|n-56320)+65536}else r&&(t-=3)>-1&&p.push(239,191,189);if(r=null,n<128){if((t-=1)<0)break;p.push(n)}else if(n<2048){if((t-=2)<0)break;p.push(n>>6|192,n&63|128)}else if(n<65536){if((t-=3)<0)break;p.push(n>>12|224,n>>6&63|128,n&63|128)}else if(n<1114112){if((t-=4)<0)break;p.push(n>>18|240,n>>12&63|128,n>>6&63|128,n&63|128)}else throw new Error("Invalid code point")}return p}function Pn(e,t,n){let a=[];for(;t<n;){let r=e[t],p=null,v=r>239?4:r>223?3:r>191?2:1;if(t+v<=n){let c,b,D,w;switch(v){case 1:r<128&&(p=r);break;case 2:c=e[t+1],(c&192)===128&&(w=(r&31)<<6|c&63,w>127&&(p=w));break;case 3:c=e[t+1],b=e[t+2],(c&192)===128&&(b&192)===128&&(w=(r&15)<<12|(c&63)<<6|b&63,w>2047&&(w<55296||w>57343)&&(p=w));break;case 4:c=e[t+1],b=e[t+2],D=e[t+3],(c&192)===128&&(b&192)===128&&(D&192)===128&&(w=(r&15)<<18|(c&63)<<12|(b&63)<<6|D&63,w>65535&&w<1114112&&(p=w))}}p===null?(p=65533,v=1):p>65535&&(p-=65536,a.push(p>>>10&1023|55296),p=56320|p&1023),a.push(p),t+=v}return ko(a)}var Mn=4096;function ko(e){let t=e.length;if(t<=Mn)return String.fromCharCode.apply(String,e);let n="",a=0;for(;a<t;)n+=String.fromCharCode.apply(String,e.slice(a,a+=Mn));return n}var So=256,Ro=class{constructor(e=So){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){let n=t.length-(this.maxCursor-this.cursor)-1;t.set(e,n)}else{if(t){let n=t.length-(this.maxCursor-this.cursor)-1;n<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,n),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=bo(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,this._initReuseChunk===null&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(this.chunks.length===1){let n=this.chunks[0];e&&this.cursor>n.length/2?(t=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=Ki(n,0,this.cursor)}else t=vo(this.chunks,this.cursor);return e&&this.reset(),t}},ce="CBOR decode error:",Hn="CBOR encode error:",Yt=[];Yt[23]=1;Yt[24]=2;Yt[25]=3;Yt[26]=5;Yt[27]=9;function Pt(e,t,n){if(e.length-t<n)throw new Error(`${ce} not enough data for type`)}var Be=[24,256,65536,4294967296,BigInt("18446744073709551616")];function Rt(e,t,n){Pt(e,t,1);let a=e[t];if(n.strict===!0&&a<Be[0])throw new Error(`${ce} integer encoded in more bytes than necessary (strict decode)`);return a}function It(e,t,n){Pt(e,t,2);let a=e[t]<<8|e[t+1];if(n.strict===!0&&a<Be[1])throw new Error(`${ce} integer encoded in more bytes than necessary (strict decode)`);return a}function At(e,t,n){Pt(e,t,4);let a=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(n.strict===!0&&a<Be[2])throw new Error(`${ce} integer encoded in more bytes than necessary (strict decode)`);return a}function Ot(e,t,n){Pt(e,t,8);let a=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],r=e[t+4]*16777216+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],p=(BigInt(a)<<BigInt(32))+BigInt(r);if(n.strict===!0&&p<Be[3])throw new Error(`${ce} integer encoded in more bytes than necessary (strict decode)`);if(p<=Number.MAX_SAFE_INTEGER)return Number(p);if(n.allowBigInt===!0)return p;throw new Error(`${ce} integers outside of the safe integer range are not supported`)}function Io(e,t,n,a){return new Y(C.uint,Rt(e,t+1,a),2)}function Ao(e,t,n,a){return new Y(C.uint,It(e,t+1,a),3)}function Oo(e,t,n,a){return new Y(C.uint,At(e,t+1,a),5)}function xo(e,t,n,a){return new Y(C.uint,Ot(e,t+1,a),9)}function xt(e,t){return Ye(e,0,t.value)}function Ye(e,t,n){if(n<Be[0]){let a=Number(n);e.push([t|a])}else if(n<Be[1]){let a=Number(n);e.push([t|24,a])}else if(n<Be[2]){let a=Number(n);e.push([t|25,a>>>8,a&255])}else if(n<Be[3]){let a=Number(n);e.push([t|26,a>>>24&255,a>>>16&255,a>>>8&255,a&255])}else{let a=BigInt(n);if(a<Be[4]){let r=[t|27,0,0,0,0,0,0,0],p=Number(a&BigInt(4294967295)),v=Number(a>>BigInt(32)&BigInt(4294967295));r[8]=p&255,p=p>>8,r[7]=p&255,p=p>>8,r[6]=p&255,p=p>>8,r[5]=p&255,r[4]=v&255,v=v>>8,r[3]=v&255,v=v>>8,r[2]=v&255,v=v>>8,r[1]=v&255,e.push(r)}else throw new Error(`${ce} encountered BigInt larger than allowable range`)}}xt.encodedSize=function(e){return Ye.encodedSize(e.value)};Ye.encodedSize=function(e){return e<Be[0]?1:e<Be[1]?2:e<Be[2]?3:e<Be[3]?5:9};xt.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};function To(e,t,n,a){return new Y(C.negint,-1-Rt(e,t+1,a),2)}function No(e,t,n,a){return new Y(C.negint,-1-It(e,t+1,a),3)}function Do(e,t,n,a){return new Y(C.negint,-1-At(e,t+1,a),5)}var Ji=BigInt(-1),Wn=BigInt(1);function Bo(e,t,n,a){let r=Ot(e,t+1,a);if(typeof r!="bigint"){let p=-1-r;if(p>=Number.MIN_SAFE_INTEGER)return new Y(C.negint,p,9)}if(a.allowBigInt!==!0)throw new Error(`${ce} integers outside of the safe integer range are not supported`);return new Y(C.negint,Ji-BigInt(r),9)}function Yi(e,t){let n=t.value,a=typeof n=="bigint"?n*Ji-Wn:n*-1-1;Ye(e,t.type.majorEncoded,a)}Yi.encodedSize=function(e){let t=e.value,n=typeof t=="bigint"?t*Ji-Wn:t*-1-1;return n<Be[0]?1:n<Be[1]?2:n<Be[2]?3:n<Be[3]?5:9};Yi.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0};function Xt(e,t,n,a){Pt(e,t,n+a);let r=Ki(e,t+n,t+n+a);return new Y(C.bytes,r,n+a)}function Lo(e,t,n,a){return Xt(e,t,1,n)}function Uo(e,t,n,a){return Xt(e,t,2,Rt(e,t+1,a))}function Co(e,t,n,a){return Xt(e,t,3,It(e,t+1,a))}function Po(e,t,n,a){return Xt(e,t,5,At(e,t+1,a))}function Mo(e,t,n,a){let r=Ot(e,t+1,a);if(typeof r=="bigint")throw new Error(`${ce} 64-bit integer bytes lengths not supported`);return Xt(e,t,9,r)}function hi(e){return e.encodedBytes===void 0&&(e.encodedBytes=e.type===C.string?_o(e.value):e.value),e.encodedBytes}function mi(e,t){let n=hi(t);Ye(e,t.type.majorEncoded,n.length),e.push(n)}mi.encodedSize=function(e){let t=hi(e);return Ye.encodedSize(t.length)+t.length};mi.compareTokens=function(e,t){return Fo(hi(e),hi(t))};function Fo(e,t){return e.length<t.length?-1:e.length>t.length?1:Eo(e,t)}function Qt(e,t,n,a,r){let p=n+a;Pt(e,t,p);let v=new Y(C.string,wo(e,t+n,t+p),p);return r.retainStringBytes===!0&&(v.byteValue=Ki(e,t+n,t+p)),v}function Go(e,t,n,a){return Qt(e,t,1,n,a)}function zo(e,t,n,a){return Qt(e,t,2,Rt(e,t+1,a),a)}function $o(e,t,n,a){return Qt(e,t,3,It(e,t+1,a),a)}function Vo(e,t,n,a){return Qt(e,t,5,At(e,t+1,a),a)}function jo(e,t,n,a){let r=Ot(e,t+1,a);if(typeof r=="bigint")throw new Error(`${ce} 64-bit integer string lengths not supported`);return Qt(e,t,9,r,a)}var Ho=mi;function Mt(e,t,n,a){return new Y(C.array,a,n)}function Wo(e,t,n,a){return Mt(e,t,1,n)}function qo(e,t,n,a){return Mt(e,t,2,Rt(e,t+1,a))}function Ko(e,t,n,a){return Mt(e,t,3,It(e,t+1,a))}function Jo(e,t,n,a){return Mt(e,t,5,At(e,t+1,a))}function Yo(e,t,n,a){let r=Ot(e,t+1,a);if(typeof r=="bigint")throw new Error(`${ce} 64-bit integer array lengths not supported`);return Mt(e,t,9,r)}function Xo(e,t,n,a){if(a.allowIndefinite===!1)throw new Error(`${ce} indefinite length items not allowed`);return Mt(e,t,1,1/0)}function Xi(e,t){Ye(e,C.array.majorEncoded,t.value)}Xi.compareTokens=xt.compareTokens;Xi.encodedSize=function(e){return Ye.encodedSize(e.value)};function Ft(e,t,n,a){return new Y(C.map,a,n)}function Qo(e,t,n,a){return Ft(e,t,1,n)}function Zo(e,t,n,a){return Ft(e,t,2,Rt(e,t+1,a))}function es(e,t,n,a){return Ft(e,t,3,It(e,t+1,a))}function ts(e,t,n,a){return Ft(e,t,5,At(e,t+1,a))}function is(e,t,n,a){let r=Ot(e,t+1,a);if(typeof r=="bigint")throw new Error(`${ce} 64-bit integer map lengths not supported`);return Ft(e,t,9,r)}function ns(e,t,n,a){if(a.allowIndefinite===!1)throw new Error(`${ce} indefinite length items not allowed`);return Ft(e,t,1,1/0)}function Qi(e,t){Ye(e,C.map.majorEncoded,t.value)}Qi.compareTokens=xt.compareTokens;Qi.encodedSize=function(e){return Ye.encodedSize(e.value)};function rs(e,t,n,a){return new Y(C.tag,n,1)}function os(e,t,n,a){return new Y(C.tag,Rt(e,t+1,a),2)}function ss(e,t,n,a){return new Y(C.tag,It(e,t+1,a),3)}function as(e,t,n,a){return new Y(C.tag,At(e,t+1,a),5)}function fs(e,t,n,a){return new Y(C.tag,Ot(e,t+1,a),9)}function Zi(e,t){Ye(e,C.tag.majorEncoded,t.value)}Zi.compareTokens=xt.compareTokens;Zi.encodedSize=function(e){return Ye.encodedSize(e.value)};var cs=20,ls=21,us=22,hs=23;function ds(e,t,n,a){if(a.allowUndefined===!1)throw new Error(`${ce} undefined values are not supported`);return a.coerceUndefinedToNull===!0?new Y(C.null,null,1):new Y(C.undefined,void 0,1)}function ps(e,t,n,a){if(a.allowIndefinite===!1)throw new Error(`${ce} indefinite length items not allowed`);return new Y(C.break,void 0,1)}function en(e,t,n){if(n){if(n.allowNaN===!1&&Number.isNaN(e))throw new Error(`${ce} NaN values are not supported`);if(n.allowInfinity===!1&&(e===1/0||e===-1/0))throw new Error(`${ce} Infinity values are not supported`)}return new Y(C.float,e,t)}function gs(e,t,n,a){return en(nn(e,t+1),3,a)}function ms(e,t,n,a){return en(rn(e,t+1),5,a)}function ys(e,t,n,a){return en(Yn(e,t+1),9,a)}function tn(e,t,n){let a=t.value;if(a===!1)e.push([C.float.majorEncoded|cs]);else if(a===!0)e.push([C.float.majorEncoded|ls]);else if(a===null)e.push([C.float.majorEncoded|us]);else if(a===void 0)e.push([C.float.majorEncoded|hs]);else{let r,p=!1;(!n||n.float64!==!0)&&(Kn(a),r=nn(tt,1),a===r||Number.isNaN(a)?(tt[0]=249,e.push(tt.slice(0,3)),p=!0):(Jn(a),r=rn(tt,1),a===r&&(tt[0]=250,e.push(tt.slice(0,5)),p=!0))),p||(ws(a),r=Yn(tt,1),tt[0]=251,e.push(tt.slice(0,9)))}}tn.encodedSize=function(e,t){let n=e.value;if(n===!1||n===!0||n===null||n===void 0)return 1;if(!t||t.float64!==!0){Kn(n);let a=nn(tt,1);if(n===a||Number.isNaN(n))return 3;if(Jn(n),a=rn(tt,1),n===a)return 5}return 9};var qn=new ArrayBuffer(9),Je=new DataView(qn,1),tt=new Uint8Array(qn,0);function Kn(e){if(e===1/0)Je.setUint16(0,31744,!1);else if(e===-1/0)Je.setUint16(0,64512,!1);else if(Number.isNaN(e))Je.setUint16(0,32256,!1);else{Je.setFloat32(0,e);let t=Je.getUint32(0),n=(t&2139095040)>>23,a=t&8388607;if(n===255)Je.setUint16(0,31744,!1);else if(n===0)Je.setUint16(0,(e&2147483648)>>16|a>>13,!1);else{let r=n-127;r<-24?Je.setUint16(0,0):r<-14?Je.setUint16(0,(t&2147483648)>>16|1<<24+r,!1):Je.setUint16(0,(t&2147483648)>>16|r+15<<10|a>>13,!1)}}}function nn(e,t){if(e.length-t<2)throw new Error(`${ce} not enough data for float16`);let n=(e[t]<<8)+e[t+1];if(n===31744)return 1/0;if(n===64512)return-1/0;if(n===32256)return NaN;let a=n>>10&31,r=n&1023,p;return a===0?p=r*2**-24:a!==31?p=(r+1024)*2**(a-25):p=r===0?1/0:NaN,n&32768?-p:p}function Jn(e){Je.setFloat32(0,e,!1)}function rn(e,t){if(e.length-t<4)throw new Error(`${ce} not enough data for float32`);let n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,4).getFloat32(0,!1)}function ws(e){Je.setFloat64(0,e,!1)}function Yn(e,t){if(e.length-t<8)throw new Error(`${ce} not enough data for float64`);let n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,8).getFloat64(0,!1)}tn.compareTokens=xt.compareTokens;function ue(e,t,n){throw new Error(`${ce} encountered invalid minor (${n}) for major ${e[t]>>>5}`)}function yi(e){return()=>{throw new Error(`${ce} ${e}`)}}var V=[];for(let e=0;e<=23;e++)V[e]=ue;V[24]=Io;V[25]=Ao;V[26]=Oo;V[27]=xo;V[28]=ue;V[29]=ue;V[30]=ue;V[31]=ue;for(let e=32;e<=55;e++)V[e]=ue;V[56]=To;V[57]=No;V[58]=Do;V[59]=Bo;V[60]=ue;V[61]=ue;V[62]=ue;V[63]=ue;for(let e=64;e<=87;e++)V[e]=Lo;V[88]=Uo;V[89]=Co;V[90]=Po;V[91]=Mo;V[92]=ue;V[93]=ue;V[94]=ue;V[95]=yi("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)V[e]=Go;V[120]=zo;V[121]=$o;V[122]=Vo;V[123]=jo;V[124]=ue;V[125]=ue;V[126]=ue;V[127]=yi("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)V[e]=Wo;V[152]=qo;V[153]=Ko;V[154]=Jo;V[155]=Yo;V[156]=ue;V[157]=ue;V[158]=ue;V[159]=Xo;for(let e=160;e<=183;e++)V[e]=Qo;V[184]=Zo;V[185]=es;V[186]=ts;V[187]=is;V[188]=ue;V[189]=ue;V[190]=ue;V[191]=ns;for(let e=192;e<=215;e++)V[e]=rs;V[216]=os;V[217]=ss;V[218]=as;V[219]=fs;V[220]=ue;V[221]=ue;V[222]=ue;V[223]=ue;for(let e=224;e<=243;e++)V[e]=yi("simple values are not supported");V[244]=ue;V[245]=ue;V[246]=ue;V[247]=ds;V[248]=yi("simple values are not supported");V[249]=gs;V[250]=ms;V[251]=ys;V[252]=ue;V[253]=ue;V[254]=ue;V[255]=ps;var st=[];for(let e=0;e<24;e++)st[e]=new Y(C.uint,e,1);for(let e=-1;e>=-24;e--)st[31-e]=new Y(C.negint,e,1);st[64]=new Y(C.bytes,new Uint8Array(0),1);st[96]=new Y(C.string,"",1);st[128]=new Y(C.array,0,1);st[160]=new Y(C.map,0,1);st[244]=new Y(C.false,!1,1);st[245]=new Y(C.true,!0,1);st[246]=new Y(C.null,null,1);function _s(){let e=[];return e[C.uint.major]=xt,e[C.negint.major]=Yi,e[C.bytes.major]=mi,e[C.string.major]=Ho,e[C.array.major]=Xi,e[C.map.major]=Qi,e[C.tag.major]=Zi,e[C.float.major]=tn,e}var hf=_s(),df=new Ro,Hi=class{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do if(t.obj===e)return!0;while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(`${Hn} object contains circular references`);return new Hi(t,e)}},mt={null:new Y(C.null,null),undefined:new Y(C.undefined,void 0),true:new Y(C.true,!0),false:new Y(C.false,!1),emptyArray:new Y(C.array,0),emptyMap:new Y(C.map,0)},wt={number(e,t,n,a){return!Number.isInteger(e)||!Number.isSafeInteger(e)?new Y(C.float,e):e>=0?new Y(C.uint,e):new Y(C.negint,e)},bigint(e,t,n,a){return e>=BigInt(0)?new Y(C.uint,e):new Y(C.negint,e)},Uint8Array(e,t,n,a){return new Y(C.bytes,e)},string(e,t,n,a){return new Y(C.string,e)},boolean(e,t,n,a){return e?mt.true:mt.false},null(e,t,n,a){return mt.null},undefined(e,t,n,a){return mt.undefined},ArrayBuffer(e,t,n,a){return new Y(C.bytes,new Uint8Array(e))},DataView(e,t,n,a){return new Y(C.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength))},Array(e,t,n,a){if(!e.length)return n.addBreakTokens===!0?[mt.emptyArray,new Y(C.break)]:mt.emptyArray;a=Hi.createCheck(a,e);let r=[],p=0;for(let v of e)r[p++]=ji(v,n,a);return n.addBreakTokens?[new Y(C.array,e.length),r,new Y(C.break)]:[new Y(C.array,e.length),r]},Object(e,t,n,a){let r=t!=="Object",p=r?e.keys():Object.keys(e),v=r?e.size:p.length;if(!v)return n.addBreakTokens===!0?[mt.emptyMap,new Y(C.break)]:mt.emptyMap;a=Hi.createCheck(a,e);let c=[],b=0;for(let D of p)c[b++]=[ji(D,n,a),ji(r?e.get(D):e[D],n,a)];return vs(c,n),n.addBreakTokens?[new Y(C.map,v),c,new Y(C.break)]:[new Y(C.map,v),c]}};wt.Map=wt.Object;wt.Buffer=wt.Uint8Array;for(let e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))wt[`${e}Array`]=wt.DataView;function ji(e,t={},n){let a=uo(e),r=t&&t.typeEncoders&&t.typeEncoders[a]||wt[a];if(typeof r=="function"){let v=r(e,a,t,n);if(v!=null)return v}let p=wt[a];if(!p)throw new Error(`${Hn} unsupported type: ${a}`);return p(e,a,t,n)}function vs(e,t){t.mapSorter&&e.sort(t.mapSorter)}var bs={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},Es=class{constructor(e,t={}){this.pos=0,this.data=e,this.options=t}done(){return this.pos>=this.data.length}next(){let e=this.data[this.pos],t=st[e];if(t===void 0){let n=V[e];if(!n)throw new Error(`${ce} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);let a=e&31;t=n(this.data,this.pos,a,this.options)}return this.pos+=t.encodedLength,t}},Kt=Symbol.for("DONE"),wi=Symbol.for("BREAK");function ks(e,t,n){let a=[];for(let r=0;r<e.value;r++){let p=Jt(t,n);if(p===wi){if(e.value===1/0)break;throw new Error(`${ce} got unexpected break to lengthed array`)}if(p===Kt)throw new Error(`${ce} found array but not enough entries (got ${r}, expected ${e.value})`);a[r]=p}return a}function Ss(e,t,n){let a=n.useMaps===!0,r=a?void 0:{},p=a?new Map:void 0;for(let v=0;v<e.value;v++){let c=Jt(t,n);if(c===wi){if(e.value===1/0)break;throw new Error(`${ce} got unexpected break to lengthed map`)}if(c===Kt)throw new Error(`${ce} found map but not enough entries (got ${v} [no key], expected ${e.value})`);if(a!==!0&&typeof c!="string")throw new Error(`${ce} non-string keys not supported (got ${typeof c})`);let b=Jt(t,n);if(b===Kt)throw new Error(`${ce} found map but not enough entries (got ${v} [no value], expected ${e.value})`);a?p.set(c,b):r[c]=b}return a?p:r}function Jt(e,t){if(e.done())return Kt;let n=e.next();if(n.type===C.break)return wi;if(n.type.terminal)return n.value;if(n.type===C.array)return ks(n,e,t);if(n.type===C.map)return Ss(n,e,t);if(n.type===C.tag){if(t.tags&&typeof t.tags[n.value]=="function"){let a=Jt(e,t);return t.tags[n.value](a)}throw new Error(`${ce} tag not supported (${n.value})`)}throw new Error("unsupported")}function Rs(e,t){if(!(e instanceof Uint8Array))throw new Error(`${ce} data to decode must be a Uint8Array`);t=Object.assign({},bs,t);let n=t.tokenizer||new Es(e,t),a=Jt(n,t);if(a===Kt)throw new Error(`${ce} did not find any content to decode`);if(a===wi)throw new Error(`${ce} got unexpected break`);if(!n.done())throw new Error(`${ce} too many terminals, data makes no sense`);return a}var Is=Xn,Fn=128,As=127,Os=~As,xs=Math.pow(2,31);function Xn(e,t,n){t=t||[],n=n||0;for(var a=n;e>=xs;)t[n++]=e&255|Fn,e/=128;for(;e&Os;)t[n++]=e&255|Fn,e>>>=7;return t[n]=e|0,Xn.bytes=n-a+1,t}var Ts=Wi,Ns=128,Gn=127;function Wi(e,a){var n=0,a=a||0,r=0,p=a,v,c=e.length;do{if(p>=c)throw Wi.bytes=0,new RangeError("Could not decode varint");v=e[p++],n+=r<28?(v&Gn)<<r:(v&Gn)*Math.pow(2,r),r+=7}while(v>=Ns);return Wi.bytes=p-a,n}var Ds=Math.pow(2,7),Bs=Math.pow(2,14),Ls=Math.pow(2,21),Us=Math.pow(2,28),Cs=Math.pow(2,35),Ps=Math.pow(2,42),Ms=Math.pow(2,49),Fs=Math.pow(2,56),Gs=Math.pow(2,63),zs=function(e){return e<Ds?1:e<Bs?2:e<Ls?3:e<Us?4:e<Cs?5:e<Ps?6:e<Ms?7:e<Fs?8:e<Gs?9:10},$s={encode:Is,decode:Ts,encodingLength:zs},Vs=$s,di=Vs,qi=(e,t=0)=>[di.decode(e,t),di.decode.bytes],pi=(e,t,n=0)=>(di.encode(e,t,n),t),gi=e=>di.encodingLength(e),pf=new Uint8Array(0),js=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0},on=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},Hs=(e,t)=>{let n=t.byteLength,a=gi(e),r=a+gi(n),p=new Uint8Array(r+n);return pi(e,p,0),pi(n,p,a),p.set(t,r),new sn(e,n,t,p)},Ws=e=>{let t=on(e),[n,a]=qi(t),[r,p]=qi(t.subarray(a)),v=t.subarray(a+p);if(v.byteLength!==r)throw new Error("Incorrect length");return new sn(n,r,v,t)},qs=(e,t)=>e===t?!0:e.code===t.code&&e.size===t.size&&js(e.bytes,t.bytes),sn=class{constructor(e,t,n,a){this.code=e,this.size=t,this.digest=n,this.bytes=a}};function Ks(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),a=0;a<n.length;a++)n[a]=255;for(var r=0;r<e.length;r++){var p=e.charAt(r),v=p.charCodeAt(0);if(n[v]!==255)throw new TypeError(p+" is ambiguous");n[v]=r}var c=e.length,b=e.charAt(0),D=Math.log(c)/Math.log(256),w=Math.log(256)/Math.log(c);function N(S){if(S instanceof Uint8Array||(ArrayBuffer.isView(S)?S=new Uint8Array(S.buffer,S.byteOffset,S.byteLength):Array.isArray(S)&&(S=Uint8Array.from(S))),!(S instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(S.length===0)return"";for(var A=0,G=0,W=0,B=S.length;W!==B&&S[W]===0;)W++,A++;for(var Q=(B-W)*w+1>>>0,$=new Uint8Array(Q);W!==B;){for(var ne=S[W],re=0,Re=Q-1;(ne!==0||re<G)&&Re!==-1;Re--,re++)ne+=256*$[Re]>>>0,$[Re]=ne%c>>>0,ne=ne/c>>>0;if(ne!==0)throw new Error("Non-zero carry");G=re,W++}for(var x=Q-G;x!==Q&&$[x]===0;)x++;for(var q=b.repeat(A);x<Q;++x)q+=e.charAt($[x]);return q}function L(S){if(typeof S!="string")throw new TypeError("Expected String");if(S.length===0)return new Uint8Array;var A=0;if(S[A]!==" "){for(var G=0,W=0;S[A]===b;)G++,A++;for(var B=(S.length-A)*D+1>>>0,Q=new Uint8Array(B);S[A];){var $=n[S.charCodeAt(A)];if($===255)return;for(var ne=0,re=B-1;($!==0||ne<W)&&re!==-1;re--,ne++)$+=c*Q[re]>>>0,Q[re]=$%256>>>0,$=$/256>>>0;if($!==0)throw new Error("Non-zero carry");W=ne,A++}if(S[A]!==" "){for(var Re=B-W;Re!==B&&Q[Re]===0;)Re++;for(var x=new Uint8Array(G+(B-Re)),q=G;Re!==B;)x[q++]=Q[Re++];return x}}}function F(S){var A=L(S);if(A)return A;throw new Error(`Non-${t} character`)}return{encode:N,decodeUnsafe:L,decode:F}}var Js=Ks,Ys=Js,Xs=Ys,Qs=class{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Zs=class{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Qn(this,e)}},ea=class{constructor(e){this.decoders=e}or(e){return Qn(this,e)}decode(e){let t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Qn=(e,t)=>new ea({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}}),ta=class{constructor(e,t,n,a){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=a,this.encoder=new Qs(e,t,n),this.decoder=new Zs(e,t,a)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},Zn=({name:e,prefix:t,encode:n,decode:a})=>new ta(e,t,n,a),er=({prefix:e,name:t,alphabet:n})=>{let{encode:a,decode:r}=Xs(n,t);return Zn({prefix:e,name:t,encode:a,decode:p=>on(r(p))})},ia=(e,t,n,a)=>{let r={};for(let w=0;w<t.length;++w)r[t[w]]=w;let p=e.length;for(;e[p-1]==="=";)--p;let v=new Uint8Array(p*n/8|0),c=0,b=0,D=0;for(let w=0;w<p;++w){let N=r[e[w]];if(N===void 0)throw new SyntaxError(`Non-${a} character`);b=b<<n|N,c+=n,c>=8&&(c-=8,v[D++]=255&b>>c)}if(c>=n||255&b<<8-c)throw new SyntaxError("Unexpected end of data");return v},na=(e,t,n)=>{let a=t[t.length-1]==="=",r=(1<<n)-1,p="",v=0,c=0;for(let b=0;b<e.length;++b)for(c=c<<8|e[b],v+=8;v>n;)v-=n,p+=t[r&c>>v];if(v&&(p+=t[r&c<<n-v]),a)for(;p.length*n&7;)p+="=";return p},ut=({name:e,prefix:t,bitsPerChar:n,alphabet:a})=>Zn({prefix:t,name:e,encode(r){return na(r,a,n)},decode(r){return ia(r,a,n,e)}}),yt=er({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),gf=er({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),li=ut({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),mf=ut({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),yf=ut({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),wf=ut({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),_f=ut({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),vf=ut({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),bf=ut({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Ef=ut({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),kf=ut({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),De=class{constructor(e,t,n,a){this.code=t,this.version=e,this.multihash=n,this.bytes=a,this.byteOffset=a.byteOffset,this.byteLength=a.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:ci,byteLength:ci,code:fi,version:fi,multihash:fi,bytes:fi,_baseCache:ci,asCID:ci})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:t}=this;if(e!==qt)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==aa)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return De.createV0(t)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:t}=this.multihash,n=Hs(e,t);return De.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&qs(this.multihash,e.multihash)}toString(e){let{bytes:t,version:n,_baseCache:a}=this;switch(n){case 0:return oa(t,a,e||yt.encoder);default:return sa(t,a,e||li.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return ca(/^0\.0/,la),!!(e&&(e[$n]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof De)return e;if(e!=null&&e.asCID===e){let{version:t,code:n,multihash:a,bytes:r}=e;return new De(t,n,a,r||zn(t,n,a.bytes))}else if(e!=null&&e[$n]===!0){let{version:t,multihash:n,code:a}=e,r=Ws(n);return De.create(t,a,r)}else return null}static create(e,t,n){if(typeof t!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(t!==qt)throw new Error(`Version 0 CID must use dag-pb (code: ${qt}) block encoding`);return new De(e,t,n,n.bytes)}case 1:{let a=zn(e,t,n.bytes);return new De(e,t,n,a)}default:throw new Error("Invalid version")}}static createV0(e){return De.create(0,qt,e)}static createV1(e,t){return De.create(1,e,t)}static decode(e){let[t,n]=De.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){let t=De.inspectBytes(e),n=t.size-t.multihashSize,a=on(e.subarray(n,n+t.multihashSize));if(a.byteLength!==t.multihashSize)throw new Error("Incorrect length");let r=a.subarray(t.multihashSize-t.digestSize),p=new sn(t.multihashCode,t.digestSize,r,a);return[t.version===0?De.createV0(p):De.createV1(t.codec,p),e.subarray(t.size)]}static inspectBytes(e){let t=0,n=()=>{let[w,N]=qi(e.subarray(t));return t+=N,w},a=n(),r=qt;if(a===18?(a=0,t=0):a===1&&(r=n()),a!==0&&a!==1)throw new RangeError(`Invalid CID version ${a}`);let p=t,v=n(),c=n(),b=t+c,D=b-p;return{version:a,codec:r,multihashCode:v,digestSize:c,multihashSize:D,size:b}}static parse(e,t){let[n,a]=ra(e,t),r=De.decode(a);return r._baseCache.set(n,e),r}},ra=(e,t)=>{switch(e[0]){case"Q":{let n=t||yt;return[yt.prefix,n.decode(`${yt.prefix}${e}`)]}case yt.prefix:{let n=t||yt;return[yt.prefix,n.decode(e)]}case li.prefix:{let n=t||li;return[li.prefix,n.decode(e)]}default:{if(t==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}},oa=(e,t,n)=>{let{prefix:a}=n;if(a!==yt.prefix)throw Error(`Cannot string encode V0 in ${n.name} encoding`);let r=t.get(a);if(r==null){let p=n.encode(e).slice(1);return t.set(a,p),p}else return r},sa=(e,t,n)=>{let{prefix:a}=n,r=t.get(a);if(r==null){let p=n.encode(e);return t.set(a,p),p}else return r},qt=112,aa=18,zn=(e,t,n)=>{let a=gi(e),r=a+gi(t),p=new Uint8Array(r+n.byteLength);return pi(e,p,0),pi(t,p,a),p.set(n,r),p},$n=Symbol.for("@ipld/js-cid/CID"),fi={writable:!1,configurable:!1,enumerable:!0},ci={writable:!1,enumerable:!1,configurable:!1},fa="0.0.0-dev",ca=(e,t)=>{if(e.test(fa))console.warn(t);else throw new Error(t)},la=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`,ua=42;function ha(e){if(e[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return De.decode(e.subarray(1))}var tr={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};tr.tags[ua]=ha;var da=e=>Rs(e,tr),pa=jn(Xr(),1),ga="Earth";function ma(e){return{country_name:e[0],country_code:e[1],region_code:e[2],city:e[3],postal_code:e[4],latitude:e[5],longitude:e[6],planet:ga}}var ya=De.parse("bafyreihnpl7ami7esahkfdnemm6idx4r2n6u3apmtcrxlqwuapgjsciihy"),wa=["https://ipfs.io","https://dweb.link"];async function _a(e,t){if(typeof e=="function")return e(t);if(typeof e?.block?.get=="function")return e.block.get(t);let n=Array.isArray(e)?e:[e];for(let a of n){let r=new URL(a);r.pathname=`/ipfs/${t.toString()}`,r.search="?format=raw";try{let p=await(0,pa.default)(r,{headers:{Accept:"application/vnd.ipld.raw"},cache:"force-cache"});if(!p.ok)throw p;return new Uint8Array(await p.arrayBuffer())}catch(p){throw new Error(`unable to fetch raw block for CID ${t}`,{cause:p})}}}async function ir(e,t,n=1){try{let a=await _a(e,t);return{obj:await da(a),block:a}}catch(a){if(n<3)return await ir(e,t,n+1);throw a}}async function va(e,t,n){let a,r;try{({obj:a,block:r}=await ir(e,t))}catch(v){throw(process?.env?.DEBUG||process?.env?.TEST)&&console.error(r?`[ipfs-geoip] failed to parse DAG-CBOR behind CID '${t}'`:`[ipfs-geoip] failed to get raw block for CID '${t}'`,v),v}let p=0;if("data"in a){if("data"in a){for(;a.data[p]&&a.data[p].min<=n;)p++;let v=a.data[p-1];if(!v)throw new Error("Failed to lookup leaf node");if(!v.data)throw new Error("Unmapped range");return ma(v.data)}}else{for(;a.mins[p]&&a.mins[p]<=n;)p++;let v=a.links[p-1];if(!v)throw new Error("Failed to lookup node");let c=ba(v);if(!c)throw new Error("Failed to lookup node");return nr(e,c,n)}}var nr=ao(va,{cachePromiseRejection:!1,cacheKey:e=>{let[,t,n]=e;return`${t}.${n}`}});function rr(e=wa,t){return nr(e,ya,fo.default.toLong(t))}function ba(e){return e?De.asCID(e):null}var Tt=new Ae("Flag"),at=class extends Ke{constructor(n,a){super(n,"div","Flag");this.parent=n;this.hostname=a}async check(){let n=!0;try{let a=localStorage.getItem(this.hostname);if(a!=null){let r=JSON.parse(a),p=Date.now(),v=r.time,c=p-v,b=7*24*60*60*1e3;c<b&&(n=!1,this.onResponse(r))}}catch(a){throw Tt.error(`error while getting savedSTR for ${this.hostname}`,a),this.onError(),a}if(n){this.startLimiters();let a=await this.waitForAvailableEndpoint();await this.dnsRequest(a)}}startLimiters(){at.googleLimiter.isStopped===!0&&at.googleLimiter.start(),at.cloudFlareLimiter.isStopped===!0&&at.cloudFlareLimiter.start()}async waitForAvailableEndpoint(){let n=await Promise.race([at.googleLimiter.awaitTokens(1).then(()=>at.googleLimiter.tryRemoveTokens(1)).then(a=>{if(a)return`https://dns.google/resolve?name=${this.hostname}&type=A`}),at.cloudFlareLimiter.awaitTokens(1).then(()=>at.cloudFlareLimiter.tryRemoveTokens(1)).then(a=>{if(a)return`https://cloudflare-dns.com/dns-query?name=${this.hostname}&type=A`})]);return n??(Tt.info("we awaited tokens, but could not retrieve any.. restarting dnsRequest"),this.waitForAvailableEndpoint())}async dnsRequest(n){try{let r=await(await fetch(n,{method:"GET",headers:{Accept:"application/dns-json"}})).json();await this.handleDnsQueryResponse(r)}catch(a){Tt.error("problem submitting DNS request",n,a),this.onError()}}async handleDnsQueryResponse(n){if(n.Answer==null){Tt.error('Response does not contain the "Answer" property:',n),this.onError();return}let a=null;for(let r=0;r<n.Answer.length&&a==null;r++){let p=n.Answer[r];p.type===1&&(a=p.data)}if(a!=null)try{let r=await rr(Ln,a);if(r?.country_code!=null){this.onResponse(r),r.time=Date.now();let p=JSON.stringify(r);localStorage.setItem(this.hostname,p)}else Tt.error("geoipResponse.country_code is null")}catch(r){Tt.error(`error while getting DNS A record for ${this.hostname}`,r),this.onError()}else Tt.error("IP is still null",n)}onError(){this.tag.empty()}onResponse(n){this.tag.style.setProperty("background-image",`url('https://ipfs.io/ipfs/QmaYjj5BHGAWfopTdE8ESzypbuthsZqTeqz9rEuh3EJZi6/${n.country_code.toLowerCase()}.svg')`),this.tag.title=n.country_name,this.tag.empty()}},Gt=at;Mi(Gt,"googleLimiter",new Lt({bucketSize:1,tokensPerInterval:1,interval:1e3*2,stopped:!0})),Mi(Gt,"cloudFlareLimiter",new Lt({bucketSize:1,tokensPerInterval:1,interval:1e3*2,stopped:!0}));var or=ri(si());var{fetch:Ea}=(0,or.default)(),an=new Ae("Ipns"),_i=class extends pt{constructor(n){super(n,"div","Ipns");this.parent=n}_className="Ipns";_tagName="div";async check(){let n=Date.now(),a=new URL(this.parent.gateway);a.pathname=Bn;let r=`${a.href}?now=${n}#x-ipfs-companion-no-redirect`;try{if((await Ea(r)).status===200)this.tag.win();else throw an.debug(`${this.parent.gateway} does not support IPNS`),new Error(`URL '${r} is not reachable`)}catch(p){throw an.error(p),this.onerror(),p}}checked(){an.warn("Not implemented yet")}onerror(){this.tag.err()}};async function vi(e){await new Promise((n,a)=>{let r=new Image,p=setTimeout(()=>{a(new Error(`Timeout when attempting to load img from '${r.src}`))},15e3),v=(c,b,D,w,N)=>{clearTimeout(p),N==null?a(new Error(`Unknown Error when attempting to load img from '${r.src}`)):a(N)};r.onerror=v,r.onload=()=>{clearTimeout(p),n()},r.src=e.toString()})}var bi=new Ae("expectSubdomainRedirect");async function sr(e){let{redirected:t,url:n}=await fetch(e.toString());bi.debug("redirected: ",t),bi.debug("responseUrl: ",n),t&&bi.debug("definitely redirected");let{hostname:a}=new Ze(n);if(!a.startsWith(gt)){let r=`Expected ${e.toString()} to redirect to subdomain '${gt}' but instead received '${n}'`;throw bi.debug(r),new Error(r)}}var ka=new Ae("Origin"),Ei=class{constructor(t){this.parent=t;this.tag=new et("div","Origin")}tag;async check(){let t=new Ze(this.parent.gateway),n=new Ze(`${t.protocol}//${gt}.ipfs.${t.hostname}/?now=${Date.now()}&filename=1x1.png#x-ipfs-companion-no-redirect`),a=new Ze(`${t.protocol}//${t.hostname}/ipfs/${gt}?now=${Date.now()}&filename=1x1.png#x-ipfs-companion-no-redirect`);await vi(n).then(async()=>sr(a)).then(()=>{this.tag.win(n.toString()),this.parent.tag.classList.add("origin")}).catch(r=>{this.onerror(r)})}onerror(t){throw ka.error(t),this.tag.err(),t}};var Sa=new Ae("Status"),ki=class extends Ke{constructor(n){super(n,"div","Status");this.parent=n}_up=!1;_down=!1;async check(){let n=new Ze(this.parent.gateway),a=new Ze(`${n.protocol}//${n.hostname}/ipfs/${gt}?now=${Date.now()}&filename=1x1.png#x-ipfs-companion-no-redirect`);await vi(a).catch(r=>{throw r!=null&&Sa.error(this.parent.gateway,r),r})}get down(){return this._down}set down(n){!this.up&&!this.down&&(this._down=!0,this.tag.lose())}get up(){return this._up}set up(n){!this.up&&!this.down&&(this._up=!0,this.tag.global(),this.parent.tag.classList.add("online"))}onerror(){throw new Error("Not implemented")}};var ar=ri(si());var{fetch:Ra}=(0,ar.default)(),fn=new Ae("Trustless"),Si=class extends pt{constructor(n){super(n,"div","Trustless");this.parent=n}_className="Trustless";_tagName="div";async check(){let n=Date.now(),a=this.parent.gateway.replace(":hash",lt);this.parent.tag.classList.add("trustless");try{let r=await Promise.all($i.map(async v=>{let c=`${a}?format=${v}&now=${n}#x-ipfs-companion-no-redirect`,b=await Ra(c);return Boolean(b.headers.get("Content-Type")?.includes(`application/vnd.ipld.${v}`))})),p=$i.filter((v,c)=>!r[c]);if(p.length===0)this.tag.win();else{let v=`URL '${a} does not support the following Trustless response types: [${p.join(", ")}]`;throw fn.debug(v),new Error(v)}}catch(r){throw fn.error(r),this.onerror(),r}}checked(){fn.warn("Not implemented yet")}onerror(){this.tag.err()}};function cn(e){let t=e.toString();return e?.hostname!=null&&(t=e.hostname.toString()),t.replace(`${lt}.ipfs.`,"").replace(`${lt}.`,"")}var Ve=new Ae("GatewayNode"),Ri=class extends Ke{constructor(n,a,r){super(n,"div","Node");this.parent=n;this.tag.empty(),this.tag.style.order=Date.now().toString(),this.status=new ki(this),this.tag.append(this.status.tag),this.cors=new ai(this),this.tag.append(this.cors.tag),this.ipns=new _i(this),this.tag.append(this.ipns.tag),this.origin=new Ei(this),this.tag.append(this.origin.tag),this.trustless=new Si(this),this.tag.append(this.trustless.tag),this.link=document.createElement("div");let p=a.replace(":hash",lt);this.link.url=new Ze(p),this.link.textContent=cn(this.link.url),this.link.className="Link",this.flag=new Gt(this,this.link.textContent),this.tag.append(this.flag.tag),this.tag.append(this.link),this.took=document.createElement("div"),this.took.className="Took",this.tag.append(this.took),this.gateway=a,this.index=r,this.checkingTime=0}status;cors;ipns;origin;trustless;link;flag;took;gateway;index;checkingTime;atLeastOneSuccess=!1;async check(){this.checkingTime=Date.now(),this.flag.check().then(()=>{Ve.debug(this.gateway,"Flag success")});let n=[this.status.check().then(()=>{Ve.debug(this.gateway,"Status success")}).then(this.onSuccessfulCheck.bind(this)),this.cors.check().then(()=>{Ve.debug(this.gateway,"CORS success")}).then(this.onSuccessfulCheck.bind(this)),this.ipns.check().then(()=>{Ve.debug(this.gateway,"IPNS success")}).then(this.onSuccessfulCheck.bind(this)),this.origin.check().then(()=>{Ve.debug(this.gateway,"Origin success")}).then(this.onSuccessfulCheck.bind(this)),this.trustless.check().then(()=>{Ve.debug(this.gateway,"Trustless success")}).then(this.onSuccessfulCheck.bind(this))];await Promise.allSettled(n).then(a=>a.map(r=>r.status)).then(a=>{a.includes("fulfilled")?(Ve.debug(`For gateway '${this.gateway}', at least one promise was successfully fulfilled`),Ve.debug(this.gateway,"this.status.up: ",this.status.up),Ve.debug(this.gateway,"this.status.down: ",this.status.down),this.status.up=!0,Ve.debug(this.gateway,"this.status.up: ",this.status.up),Ve.debug(this.gateway,"this.status.down: ",this.status.down)):(this.status.down=!0,Ve.debug(`For gateway '${this.gateway}', all promises were rejected`))})}onSuccessfulCheck(){if(!this.atLeastOneSuccess){Ve.info(`For gateway '${this.gateway}', at least one check was successful`),this.atLeastOneSuccess=!0,this.status.up=!0;let n=this.link.url;if(n!=null){let p=cn(n);this.link.innerHTML=`<a title="${p}" href="${n.toString()}#x-ipfs-companion-no-redirect" target="_blank">${p}</a>`}let a=Date.now()-this.checkingTime;this.tag.style.order=a.toString();let r=(a/1e3).toFixed(2);this.took.textContent=`${r}s`}}onerror(){this.tag.err()}};var Ii=class{constructor(t){this.parent=t;let n=document.getElementById("checker.results");if(n==null)throw new Error('Element with Id "checker.results" not found.');this.element=n}append(t){this.element.append(t.element)}element};var Ai=class extends Ke{constructor(n){super(n);this.parent=n;let a=document.getElementById("checker.stats");if(a==null)throw new Error('Could not find element with Id "checker.stats"');this.tag=et.fromElement(a),this.gateways=document.createElement("div"),this.gateways.textContent="0/0 tested",this.gateways.className="Gateways",this.tag.append(this.gateways),this.totals=document.createElement("div"),this.totals.textContent="0 online",this.totals.className="Totals",this.tag.append(this.totals)}gateways;totals;update(){let n=0,a=0;for(let r of this.parent.nodes)r.status.up?n+=1:r.status.down&&(a+=1);this.gateways.textContent=`${n+a}/${this.parent.nodes.length} tested`,this.totals.textContent=`${n} online`}};var Ia=new Ae("Checker"),Oi=class{element;nodes=[];stats;results;constructor(){let t=document.getElementById("checker");if(t==null)throw new Error('Element with Id "checker" not found.');this.element=t,this.stats=new Ai(this),this.results=new Ii(this),this.updateStats=this.updateStats.bind(this)}updateStats(){this.stats.update()}async checkGateways(t){let n=[];for(let a of t){let r=new Ri(this.results,a,this.nodes.length);this.nodes.push(r),this.results.append(r.tag),setTimeout(()=>{n.push(r.check().catch(p=>{Ia.error(p)}).finally(this.updateStats))},100*this.nodes.length)}}};var fr=["https://ipfs.io/ipfs/:hash","https://dweb.link/ipfs/:hash","https://gateway.ipfs.io/ipfs/:hash","https://ninetailed.ninja/ipfs/:hash","https://via0.com/ipfs/:hash","https://ipfs.eternum.io/ipfs/:hash","https://hardbin.com/ipfs/:hash","https://cloudflare-ipfs.com/ipfs/:hash","https://astyanax.io/ipfs/:hash","https://cf-ipfs.com/ipfs/:hash","https://gateway.originprotocol.com/ipfs/:hash","https://gateway.pinata.cloud/ipfs/:hash","https://ipfs.sloppyta.co/ipfs/:hash","https://ipfs.busy.org/ipfs/:hash","https://ipfs.greyh.at/ipfs/:hash","https://gateway.serph.network/ipfs/:hash","https://gw3.io/ipfs/:hash","https://jorropo.net/ipfs/:hash","https://ipfs.fooock.com/ipfs/:hash","https://cdn.cwinfo.net/ipfs/:hash","https://aragon.ventures/ipfs/:hash","https://permaweb.io/ipfs/:hash","https://ipfs.best-practice.se/ipfs/:hash","https://storjipfs-gateway.com/ipfs/:hash","https://ipfs.runfission.com/ipfs/:hash","https://ipfs.trusti.id/ipfs/:hash","https://ipfs.overpi.com/ipfs/:hash","https://ipfs.ink/ipfs/:hash","https://ipfsgateway.makersplace.com/ipfs/:hash","https://ipfs.funnychain.co/ipfs/:hash","https://ipfs.telos.miami/ipfs/:hash","https://ipfs.mttk.net/ipfs/:hash","https://ipfs.fleek.co/ipfs/:hash","https://ipfs.jbb.one/ipfs/:hash","https://ipfs.yt/ipfs/:hash","https://hashnews.k1ic.com/ipfs/:hash","https://ipfs.drink.cafe/ipfs/:hash","https://ipfs.kavin.rocks/ipfs/:hash","https://ipfs.denarius.io/ipfs/:hash","https://crustwebsites.net/ipfs/:hash","https://ipfs0.sjc.cloudsigma.com/ipfs/:hash","http://ipfs.genenetwork.org/ipfs/:hash","https://ipfs.eth.aragon.network/ipfs/:hash","https://ipfs.smartholdem.io/ipfs/:hash","https://ipfs.xoqq.ch/ipfs/:hash","http://natoboram.mynetgear.com:8080/ipfs/:hash","https://video.oneloveipfs.com/ipfs/:hash","https://ipfs.scalaproject.io/ipfs/:hash","https://search.ipfsgate.com/ipfs/:hash","https://ipfs.decoo.io/ipfs/:hash","https://alexdav.id/ipfs/:hash","https://ipfs.uploads.nu/ipfs/:hash","https://hub.textile.io/ipfs/:hash","https://ipfs1.pixura.io/ipfs/:hash","https://ravencoinipfs-gateway.com/ipfs/:hash","https://konubinix.eu/ipfs/:hash","https://ipfs.tubby.cloud/ipfs/:hash","https://ipfs.lain.la/ipfs/:hash","https://ipfs.kaleido.art/ipfs/:hash","https://ipfs.slang.cx/ipfs/:hash","https://ipfs.arching-kaos.com/ipfs/:hash","https://storry.tv/ipfs/:hash","https://ipfs.1-2.dev/ipfs/:hash","https://dweb.eu.org/ipfs/:hash","https://permaweb.eu.org/ipfs/:hash","https://ipfs.namebase.io/ipfs/:hash","https://ipfs.tribecap.co/ipfs/:hash","https://ipfs.kinematiks.com/ipfs/:hash","https://nftstorage.link/ipfs/:hash","https://gravity.jup.io/ipfs/:hash","http://fzdqwfb5ml56oadins5jpuhe6ki6bk33umri35p5kt2tue4fpws5efid.onion/ipfs/:hash","https://tth-ipfs.com/ipfs/:hash","https://ipfs.chisdealhd.co.uk/ipfs/:hash","https://ipfs.alloyxuast.tk/ipfs/:hash","https://4everland.io/ipfs/:hash","https://ipfs-gateway.cloud/ipfs/:hash","https://w3s.link/ipfs/:hash","https://cthd.icu/ipfs/:hash","https://ipfs.tayfundogdas.me/ipfs/:hash","https://ipfs.jpu.jp/ipfs/:hash","https://ipfs.soul-network.com/ipfs/:hash"];var je=ri(lr()),ur=localStorage.getItem("metrics_consent"),un=document.querySelector(".js-metrics-notification-modal"),hn=document.querySelector(".js-metrics-agreement"),gr=document.querySelector(".js-metrics-preferences"),Aa=document.querySelector(".js-modal-close"),hr=document.querySelector(".js-metrics-notification-confirm"),dr=document.querySelector(".js-metrics-notification-preferences-save"),pr=document.querySelector(".js-metrics-notification-manage"),ln=document.querySelector(".js-necessary-toggle"),Oa=document.querySelector(".js-metrics-modal-toggle");function Ti(e){je.default.add_consent(e),Array.isArray(e)?localStorage.setItem("metrics_consent",JSON.stringify(e)):localStorage.setItem("metrics_consent",JSON.stringify([e]))}function xa(){un?.classList.add("hidden"),Ti(["minimal"])}function Ta(){ln.checked?Ti(["minimal"]):(je.default.remove_consent(["minimal"]),localStorage.setItem("metrics_consent",JSON.stringify([])))}function Na(){un?.classList.remove("hidden"),hr?.classList.remove("hidden"),pr?.classList.remove("hidden"),hn?.classList.remove("hidden"),Aa?.addEventListener("click",mr),hr?.addEventListener("click",xa),pr?.addEventListener("click",Da)}function mr(){un?.classList.add("hidden"),gr?.classList.add("hidden"),hn?.classList.remove("hidden")}function Da(){let e=localStorage.getItem("metrics_consent");e!=null&&(ln.checked=JSON.parse(e)[0]==="minimal"),hn?.classList.add("hidden"),dr?.classList.remove("hidden"),gr?.classList.remove("hidden"),ln.addEventListener("click",Ta),dr?.addEventListener("click",mr)}function Ba(){Na()}function yr(){Oa?.addEventListener("click",Ba),je.default.init({app_key:"3c2c0819434074fc4d339ddd8e112a1e741ecb72",url:"https://countly.ipfs.io",require_consent:!0});let e=["sessions","views","events"],t=["crashes","apm"],n=["scrolls","clicks","forms"],a=["star-rating","feedback"],r=["location"];je.default.group_features({all:[...e,...t,...n,...a,...r],minimal:e,performance:t,ux:n,feedback:a,location:r}),je.default.track_clicks(),je.default.track_errors(),je.default.track_forms(),je.default.track_links(),je.default.track_pageview(),je.default.track_scrolls(),je.default.track_sessions(),je.default.track_view(),ur!=null?Ti(JSON.parse(ur)):Ti(["minimal"])}var La=new Nn("/sw.js");La.register();yr();var wr=new Ae("App index");window.checker=new Oi;window.checker.checkGateways(fr).catch(e=>{wr.error("Unexpected error"),wr.error(e)});})();
/*! Bundled license information:

ipfs-geoip/dist/index.min.js:
  (*!
   * The buffer module from node.js, for the browser.
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   *)
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)
*/
return IpfsPublicGatewayChecker}));
